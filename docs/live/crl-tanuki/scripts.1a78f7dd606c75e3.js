(function(k,b){"function"==typeof define&&define.amd?define("eve",function(){return b()}):"object"==typeof exports?module.exports=b():k.eve=b()})(this,function(){var k,b,Et="hasOwnProperty",Vt=/[\.\/]/,Nt=function(){},Gt=function(g,T){return g-T},zt={n:{}},p=function(g,T){g=String(g);var _,A=b,Z=Array.prototype.slice.call(arguments,2),$=p.listeners(g),R=0,dt=[],vt={},mt=[],at=k;k=g,b=0;for(var ft=0,It=$.length;It>ft;ft++)"zIndex"in $[ft]&&(dt.push($[ft].zIndex),$[ft].zIndex<0&&(vt[$[ft].zIndex]=$[ft]));for(dt.sort(Gt);dt[R]<0;)if(_=vt[dt[R++]],mt.push(_.apply(T,Z)),b)return b=A,mt;for(ft=0;It>ft;ft++)if("zIndex"in(_=$[ft]))if(_.zIndex==dt[R]){if(mt.push(_.apply(T,Z)),b)break;do{if((_=vt[dt[++R]])&&mt.push(_.apply(T,Z)),b)break}while(_)}else vt[_.zIndex]=_;else if(mt.push(_.apply(T,Z)),b)break;return b=A,k=at,mt.length?mt:null};return p._events=zt,p.listeners=function(g){var T,_,A,Z,$,R,dt,vt,mt=g.split(Vt),at=zt,ft=[at],It=[];for(Z=0,$=mt.length;$>Z;Z++){for(vt=[],R=0,dt=ft.length;dt>R;R++)for(_=[(at=ft[R].n)[mt[Z]],at["*"]],A=2;A--;)(T=_[A])&&(vt.push(T),It=It.concat(T.f||[]));ft=vt}return It},p.on=function(g,T){if(g=String(g),"function"!=typeof T)return function(){};for(var _=g.split(Vt),A=zt,Z=0,$=_.length;$>Z;Z++)A=(A=A.n).hasOwnProperty(_[Z])&&A[_[Z]]||(A[_[Z]]={n:{}});for(A.f=A.f||[],Z=0,$=A.f.length;$>Z;Z++)if(A.f[Z]==T)return Nt;return A.f.push(T),function(R){+R==+R&&(T.zIndex=+R)}},p.f=function(g){var T=[].slice.call(arguments,1);return function(){p.apply(null,[g,null].concat(T).concat([].slice.call(arguments,0)))}},p.stop=function(){b=1},p.nt=function(g){return g?new RegExp("(?:\\.|\\/|^)"+g+"(?:\\.|\\/|$)").test(k):k},p.nts=function(){return k.split(Vt)},p.off=p.unbind=function(g,T){if(g){var _,A,Z,$,R,dt,vt,mt=g.split(Vt),at=[zt];for($=0,R=mt.length;R>$;$++)for(dt=0;dt<at.length;dt+=Z.length-2){if(Z=[dt,1],_=at[dt].n,"*"!=mt[$])_[mt[$]]&&Z.push(_[mt[$]]);else for(A in _)_[Et](A)&&Z.push(_[A]);at.splice.apply(at,Z)}for($=0,R=at.length;R>$;$++)for(_=at[$];_.n;){if(T){if(_.f){for(dt=0,vt=_.f.length;vt>dt;dt++)if(_.f[dt]==T){_.f.splice(dt,1);break}!_.f.length&&delete _.f}for(A in _.n)if(_.n[Et](A)&&_.n[A].f){var ft=_.n[A].f;for(dt=0,vt=ft.length;vt>dt;dt++)if(ft[dt]==T){ft.splice(dt,1);break}!ft.length&&delete _.n[A].f}}else for(A in delete _.f,_.n)_.n[Et](A)&&_.n[A].f&&delete _.n[A].f;_=_.n}}else p._events=zt={n:{}}},p.once=function(g,T){var _=function(){return p.unbind(g,_),T.apply(this,arguments)};return p.on(g,_)},p.version="0.4.2",p.toString=function(){return"You are running Eve 0.4.2"},p}),function(k,b){"function"==typeof define&&define.amd?define("raphael.core",["eve"],function(Ct){return b(Ct)}):"object"==typeof exports?module.exports=b(require("eve")):k.Raphael=b(k.eve)}(this,function(k){function b(s){if(b.is(s,"function"))return mt?s():k.on("raphael.DOMload",s);if(b.is(s,_t))return b._engine.create[gt](b,s.splice(0,3+b.is(s[0],St))).add(s);var l=Array.prototype.slice.call(arguments,0);if(b.is(l[l.length-1],"function")){var f=l.pop();return mt?f.call(b._engine.create[gt](b,l)):k.on("raphael.DOMload",function(){f.call(b._engine.create[gt](b,l))})}return b._engine.create[gt](b,arguments)}function Ct(s){if("function"==typeof s||Object(s)!==s)return s;var l=new s.constructor;for(var f in s)s[Wt](f)&&(l[f]=Ct(s[f]));return l}function Et(s,l){for(var f=0,h=s.length;h>f;f++)if(s[f]===l)return s.push(s.splice(f,1)[0])}function Vt(s,l,f){return function h(){var v=Array.prototype.slice.call(arguments,0),w=v.join("\u2400"),m=h.cache=h.cache||{},S=h.count=h.count||[];return m[Wt](w)?(Et(S,w),f?f(m[w]):m[w]):(S.length>=1e3&&delete m[S.shift()],S.push(w),m[w]=s[gt](l,v),f?f(m[w]):m[w])}}function Jt(){return this.hex}function Nt(s,l){for(var f=[],h=0,v=s.length;v-2*!l>h;h+=2){var w=[{x:+s[h-2],y:+s[h-1]},{x:+s[h],y:+s[h+1]},{x:+s[h+2],y:+s[h+3]},{x:+s[h+4],y:+s[h+5]}];l?h?v-4==h?w[3]={x:+s[0],y:+s[1]}:v-2==h&&(w[2]={x:+s[0],y:+s[1]},w[3]={x:+s[2],y:+s[3]}):w[0]={x:+s[v-2],y:+s[v-1]}:v-4==h?w[3]=w[2]:h||(w[0]={x:+s[h],y:+s[h+1]}),f.push(["C",(6*w[1].x-w[0].x+w[2].x)/6,(6*w[1].y-w[0].y+w[2].y)/6,(w[1].x+6*w[2].x-w[3].x)/6,(w[1].y+6*w[2].y-w[3].y)/6,w[2].x,w[2].y])}return f}function Gt(s,l,f,h,v){return s*(s*(-3*l+9*f-9*h+3*v)+6*l-12*f+6*h)-3*l+3*f}function zt(s,l,f,h,v,w,m,S,L){null==L&&(L=1);for(var F=(L=L>1?1:0>L?0:L)/2,nt=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],j=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],K=0,J=0;12>J;J++){var et=F*nt[J]+F,rt=Gt(et,s,f,v,m),z=Gt(et,l,h,w,S);K+=j[J]*H.sqrt(rt*rt+z*z)}return F*K}function g(s,l,f,h,v,w,m,S){if(!(G(s,f)<X(v,m)||X(s,f)>G(v,m)||G(l,h)<X(w,S)||X(l,h)>G(w,S))){var Q=(s-f)*(w-S)-(l-h)*(v-m);if(Q){var nt=((s*h-l*f)*(v-m)-(s-f)*(v*S-w*m))/Q,j=((s*h-l*f)*(w-S)-(l-h)*(v*S-w*m))/Q,K=+nt.toFixed(2),J=+j.toFixed(2);if(!(K<+X(s,f).toFixed(2)||K>+G(s,f).toFixed(2)||K<+X(v,m).toFixed(2)||K>+G(v,m).toFixed(2)||J<+X(l,h).toFixed(2)||J>+G(l,h).toFixed(2)||J<+X(w,S).toFixed(2)||J>+G(w,S).toFixed(2)))return{x:nt,y:j}}}}function T(s,l,f){var h=b.bezierBBox(s),v=b.bezierBBox(l);if(!b.isBBoxIntersect(h,v))return f?0:[];for(var w=zt.apply(0,s),m=zt.apply(0,l),S=G(~~(w/5),1),L=G(~~(m/5),1),F=[],Q=[],nt={},j=f?0:[],K=0;S+1>K;K++){var J=b.findDotsAtSegment.apply(b,s.concat(K/S));F.push({x:J.x,y:J.y,t:K/S})}for(K=0;L+1>K;K++)J=b.findDotsAtSegment.apply(b,l.concat(K/L)),Q.push({x:J.x,y:J.y,t:K/L});for(K=0;S>K;K++)for(var et=0;L>et;et++){var rt=F[K],z=F[K+1],bt=Q[et],tt=Q[et+1],ut=E(z.x-rt.x)<.001?"y":"x",it=E(tt.x-bt.x)<.001?"y":"x",Ht=g(rt.x,rt.y,z.x,z.y,bt.x,bt.y,tt.x,tt.y);if(Ht){if(nt[Ht.x.toFixed(4)]==Ht.y.toFixed(4))continue;nt[Ht.x.toFixed(4)]=Ht.y.toFixed(4);var Ft=rt.t+E((Ht[ut]-rt[ut])/(z[ut]-rt[ut]))*(z.t-rt.t),Pt=bt.t+E((Ht[it]-bt[it])/(tt[it]-bt[it]))*(tt.t-bt.t);Ft>=0&&1.001>=Ft&&Pt>=0&&1.001>=Pt&&(f?j++:j.push({x:Ht.x,y:Ht.y,t1:X(Ft,1),t2:X(Pt,1)}))}}return j}function _(s,l,f){s=b._path2curve(s),l=b._path2curve(l);for(var h,v,w,m,S,L,F,Q,nt,j,K=f?0:[],J=0,et=s.length;et>J;J++){var rt=s[J];if("M"==rt[0])h=S=rt[1],v=L=rt[2];else{"C"==rt[0]?(nt=[h,v].concat(rt.slice(1)),h=nt[6],v=nt[7]):(nt=[h,v,h,v,S,L,S,L],h=S,v=L);for(var z=0,bt=l.length;bt>z;z++){var tt=l[z];if("M"==tt[0])w=F=tt[1],m=Q=tt[2];else{"C"==tt[0]?(j=[w,m].concat(tt.slice(1)),w=j[6],m=j[7]):(j=[w,m,w,m,F,Q,F,Q],w=F,m=Q);var ut=T(nt,j,f);if(f)K+=ut;else{for(var it=0,Ht=ut.length;Ht>it;it++)ut[it].segment1=J,ut[it].segment2=z,ut[it].bez1=nt,ut[it].bez2=j;K=K.concat(ut)}}}}}return K}function A(s,l,f,h,v,w){null!=s?(this.a=+s,this.b=+l,this.c=+f,this.d=+h,this.e=+v,this.f=+w):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function Z(){return this.x+P+this.y+P+this.width+" \xd7 "+this.height}function R(s,l){var f=[],h={};if(this.ms=l,this.times=1,s){for(var v in s)s[Wt](v)&&(h[Qt(v)]=s[v],f.push(Qt(v)));f.sort(Qe)}this.anim=h,this.top=f[f.length-1],this.percents=f}function dt(s,l,f,h,v,w){f=Qt(f);var m,S,L,F,Q,nt,j=s.ms,K={},J={},et={};if(h)for(z=0,bt=pt.length;bt>z;z++){var rt=pt[z];if(rt.el.id==l.id&&rt.anim==s){rt.percent!=f?(pt.splice(z,1),L=1):S=rt,l.attr(rt.totalOrigin);break}}else h=+J;for(var z=0,bt=s.percents.length;bt>z;z++){if(s.percents[z]==f||s.percents[z]>h*s.top){j=j/s.top*((f=s.percents[z])-(Q=s.percents[z-1]||0)),F=s.percents[z+1],m=s.anim[f];break}h&&l.attr(s.anim[s.percents[z]])}if(m){if(S)S.initstatus=h,S.start=new Date-S.ms*h;else{for(var tt in m)if(m[Wt](tt)&&(se[Wt](tt)||l.paper.customAttributes[Wt](tt)))switch(K[tt]=l.attr(tt),null==K[tt]&&(K[tt]=Re[tt]),J[tt]=m[tt],se[tt]){case St:et[tt]=(J[tt]-K[tt])/j;break;case"colour":K[tt]=b.getRGB(K[tt]);var ut=b.getRGB(J[tt]);et[tt]={r:(ut.r-K[tt].r)/j,g:(ut.g-K[tt].g)/j,b:(ut.b-K[tt].b)/j};break;case"path":var it=zr(K[tt],J[tt]),Ht=it[1];for(K[tt]=it[0],et[tt]=[],z=0,bt=K[tt].length;bt>z;z++){et[tt][z]=[0];for(var Ft=1,Pt=K[tt][z].length;Pt>Ft;Ft++)et[tt][z][Ft]=(Ht[z][Ft]-K[tt][z][Ft])/j}break;case"transform":var lr=l._,gr=kr(lr[tt],J[tt]);if(gr)for(K[tt]=gr.from,J[tt]=gr.to,et[tt]=[],et[tt].real=!0,z=0,bt=K[tt].length;bt>z;z++)for(et[tt][z]=[K[tt][z][0]],Ft=1,Pt=K[tt][z].length;Pt>Ft;Ft++)et[tt][z][Ft]=(J[tt][z][Ft]-K[tt][z][Ft])/j;else{var ke=l.matrix||new A,Je={_:{transform:lr.transform},getBBox:function(){return l.getBBox(1)}};K[tt]=[ke.a,ke.b,ke.c,ke.d,ke.e,ke.f],mn(Je,J[tt]),J[tt]=Je._.transform,et[tt]=[(Je.matrix.a-ke.a)/j,(Je.matrix.b-ke.b)/j,(Je.matrix.c-ke.c)/j,(Je.matrix.d-ke.d)/j,(Je.matrix.e-ke.e)/j,(Je.matrix.f-ke.f)/j]}break;case"csv":var yr=U(m[tt])[M](ft),mr=U(K[tt])[M](ft);if("clip-rect"==tt)for(K[tt]=mr,et[tt]=[],z=mr.length;z--;)et[tt][z]=(yr[z]-K[tt][z])/j;J[tt]=yr;break;default:for(yr=[][Rt](m[tt]),mr=[][Rt](K[tt]),et[tt]=[],z=l.paper.customAttributes[tt].length;z--;)et[tt][z]=((yr[z]||0)-(mr[z]||0))/j}var xr=m.easing,Ie=b.easing_formulas[xr];if(!Ie)if((Ie=U(xr).match(jt))&&5==Ie.length){var $e=Ie;Ie=function(Kr){return function $(s,l,f,h,v,w){function m(et){return((nt*et+Q)*et+F)*et}var F=3*l,Q=3*(h-l)-F,nt=1-F-Q,j=3*f,K=3*(v-f)-j,J=1-j-K;return function S(et,rt){var z=function L(et,rt){var z,bt,tt,ut,it,Ht;for(tt=et,Ht=0;8>Ht;Ht++){if(ut=m(tt)-et,E(ut)<rt)return tt;if(E(it=(3*nt*tt+2*Q)*tt+F)<1e-6)break;tt-=ut/it}if((z=0)>(tt=et))return z;if(tt>(bt=1))return bt;for(;bt>z;){if(ut=m(tt),E(ut-et)<rt)return tt;et>ut?z=tt:bt=tt,tt=(bt-z)/2+z}return tt}(et,rt);return((J*z+K)*z+j)*z}(s,1/(200*w))}(Kr,+$e[1],+$e[2],+$e[3],+$e[4],j)}}else Ie=oi;if(rt={anim:s,percent:f,timestamp:nt=m.start||s.start||+new Date,start:nt+(s.del||0),status:0,initstatus:h||0,stop:!1,ms:j,easing:Ie,from:K,diff:et,to:J,el:l,callback:m.callback,prev:Q,next:F,repeat:w||s.times,origin:l.attr(),totalOrigin:v},pt.push(rt),h&&!S&&!L&&(rt.stop=!0,rt.start=new Date-j*h,1==pt.length))return Xr();L&&(rt.start=new Date-rt.ms*h),1==pt.length&&di(Xr)}k("raphael.anim.start."+l.id,l,s)}}function vt(s){for(var l=0;l<pt.length;l++)pt[l].el.paper==s&&pt.splice(l--,1)}b.version="2.1.4",b.eve=k;var mt,at,s,l,ft=/[, ]+/,It={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},qt=/\{(\d+)\}/g,Wt="hasOwnProperty",xt={doc:document,win:window},ee={was:Object.prototype[Wt].call(xt.win,"Raphael"),is:xt.win.Raphael},Xt=function(){this.ca=this.customAttributes={}},gt="apply",Rt="concat",x="ontouchstart"in xt.win||xt.win.DocumentTouch&&xt.doc instanceof DocumentTouch,W="",P=" ",U=String,M="split",y="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[M](P),O={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},D=U.prototype.toLowerCase,H=Math,G=H.max,X=H.min,E=H.abs,ot=H.pow,lt=H.PI,St="number",Ut="string",_t="array",Bt=Object.prototype.toString,Kt=(b._ISURL=/^url\(['"]?(.+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),Tt={NaN:1,Infinity:1,"-Infinity":1},jt=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Zt=H.round,Qt=parseFloat,fe=parseInt,Oe=U.prototype.toUpperCase,Re=b._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},se=b._availableAnimAttrs={blur:St,"clip-rect":"csv",cx:St,cy:St,fill:"colour","fill-opacity":St,"font-size":St,height:St,opacity:St,path:"path",r:St,rx:St,ry:St,stroke:"colour","stroke-opacity":St,"stroke-width":St,transform:"transform",width:St,x:St,y:St},cr=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,ni={hs:1,rg:1},je=/,?([achlmqrstvxz]),?/gi,Er=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,Ve=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,Tr=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,Le=(b._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),Qe=function(s,l){return Qt(s)-Qt(l)},oi=function(s){return s},be=b._rectPath=function(s,l,f,h,v){return v?[["M",s+v,l],["l",f-2*v,0],["a",v,v,0,0,1,v,v],["l",0,h-2*v],["a",v,v,0,0,1,-v,v],["l",2*v-f,0],["a",v,v,0,0,1,-v,-v],["l",0,2*v-h],["a",v,v,0,0,1,v,-v],["z"]]:[["M",s,l],["l",f,0],["l",0,h],["l",-f,0],["z"]]},Rr=function(s,l,f,h){return null==h&&(h=f),[["M",s,l],["m",0,-h],["a",f,h,0,1,1,0,2*h],["a",f,h,0,1,1,0,-2*h],["z"]]},Mt=b._getPath={path:function(s){return s.attr("path")},circle:function(s){var l=s.attrs;return Rr(l.cx,l.cy,l.r)},ellipse:function(s){var l=s.attrs;return Rr(l.cx,l.cy,l.rx,l.ry)},rect:function(s){var l=s.attrs;return be(l.x,l.y,l.width,l.height,l.r)},image:function(s){var l=s.attrs;return be(l.x,l.y,l.width,l.height)},text:function(s){var l=s._getBBox();return be(l.x,l.y,l.width,l.height)},set:function(s){var l=s._getBBox();return be(l.x,l.y,l.width,l.height)}},Gr=b.mapPath=function(s,l){if(!l)return s;var f,h,v,w,m,S,L;for(v=0,m=(s=zr(s)).length;m>v;v++)for(w=1,S=(L=s[v]).length;S>w;w+=2)f=l.x(L[w],L[w+1]),h=l.y(L[w],L[w+1]),L[w]=f,L[w+1]=h;return s};if(b._g=xt,"VML"==(b.type=xt.win.SVGAngle||xt.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML")){var Ce,ne=xt.doc.createElement("div");if(ne.innerHTML='<v:shape adj="1"/>',(Ce=ne.firstChild).style.behavior="url(#default#VML)",!Ce||"object"!=typeof Ce.adj)return b.type=W;ne=null}b.svg=!(b.vml="VML"==b.type),b._Paper=Xt,b.fn=at=Xt.prototype=b.prototype,b._id=0,b._oid=0,b.is=function(s,l){return"finite"==(l=D.call(l))?!Tt[Wt](+s):"array"==l?s instanceof Array:"null"==l&&null===s||l==typeof s&&null!==s||"object"==l&&s===Object(s)||"array"==l&&Array.isArray&&Array.isArray(s)||Bt.call(s).slice(8,-1).toLowerCase()==l},b.angle=function(s,l,f,h,v,w){if(null==v){var m=s-f,S=l-h;return m||S?(180+180*H.atan2(-S,-m)/lt+360)%360:0}return b.angle(s,l,v,w)-b.angle(f,h,v,w)},b.rad=function(s){return s%360*lt/180},b.deg=function(s){return Math.round(180*s/lt%360*1e3)/1e3},b.snapTo=function(s,l,f){if(f=b.is(f,"finite")?f:10,b.is(s,_t)){for(var h=s.length;h--;)if(E(s[h]-l)<=f)return s[h]}else{var v=l%(s=+s);if(f>v)return l-v;if(v>s-f)return l-v+s}return l},b.createUUID=(s=/[xy]/g,l=function(s){var l=16*H.random()|0;return("x"==s?l:3&l|8).toString(16)},function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(s,l).toUpperCase()}),b.setWindow=function(s){k("raphael.setWindow",b,xt.win,s),xt.win=s,xt.doc=xt.win.document,b._engine.initWin&&b._engine.initWin(xt.win)};var le=function(s){if(b.vml){var l,f=/^\s+|\s+$/g;try{var h=new ActiveXObject("htmlfile");h.write("<body>"),h.close(),l=h.body}catch(m){l=createPopup().document.body}var v=l.createTextRange();le=Vt(function(m){try{l.style.color=U(m).replace(f,W);var S=v.queryCommandValue("ForeColor");return"#"+("000000"+(S=(255&S)<<16|65280&S|(16711680&S)>>>16).toString(16)).slice(-6)}catch(L){return"none"}})}else{var w=xt.doc.createElement("i");w.title="Rapha\xebl Colour Picker",w.style.display="none",xt.doc.body.appendChild(w),le=Vt(function(m){return w.style.color=m,xt.doc.defaultView.getComputedStyle(w,W).getPropertyValue("color")})}return le(s)},pn=function(){return"hsb("+[this.h,this.s,this.b]+")"},Ge=function(){return"hsl("+[this.h,this.s,this.l]+")"},dr=function(){return this.hex},Se=function(s,l,f){if(null==l&&b.is(s,"object")&&"r"in s&&"g"in s&&"b"in s&&(f=s.b,l=s.g,s=s.r),null==l&&b.is(s,Ut)){var h=b.getRGB(s);s=h.r,l=h.g,f=h.b}return(s>1||l>1||f>1)&&(s/=255,l/=255,f/=255),[s,l,f]},Ii=function(s,l,f,h){var v={r:s*=255,g:l*=255,b:f*=255,hex:b.rgb(s,l,f),toString:dr};return b.is(h,"finite")&&(v.opacity=h),v};b.color=function(s){var l;return b.is(s,"object")&&"h"in s&&"s"in s&&"b"in s?(l=b.hsb2rgb(s),s.r=l.r,s.g=l.g,s.b=l.b,s.hex=l.hex):b.is(s,"object")&&"h"in s&&"s"in s&&"l"in s?(l=b.hsl2rgb(s),s.r=l.r,s.g=l.g,s.b=l.b,s.hex=l.hex):(b.is(s,"string")&&(s=b.getRGB(s)),b.is(s,"object")&&"r"in s&&"g"in s&&"b"in s?(l=b.rgb2hsl(s),s.h=l.h,s.s=l.s,s.l=l.l,l=b.rgb2hsb(s),s.v=l.b):(s={hex:"none"}).r=s.g=s.b=s.h=s.s=s.v=s.l=-1),s.toString=dr,s},b.hsb2rgb=function(s,l,f,h){var v,w,m,S,L;return this.is(s,"object")&&"h"in s&&"s"in s&&"b"in s&&(f=s.b,l=s.s,h=s.o,s=s.h),S=(L=f*l)*(1-E((s=(s*=360)%360/60)%2-1)),v=w=m=f-L,Ii(v+=[L,S,0,0,S,L][s=~~s],w+=[S,L,L,S,0,0][s],m+=[0,0,S,L,L,S][s],h)},b.hsl2rgb=function(s,l,f,h){var v,w,m,S,L;return this.is(s,"object")&&"h"in s&&"s"in s&&"l"in s&&(f=s.l,l=s.s,s=s.h),(s>1||l>1||f>1)&&(s/=360,l/=100,f/=100),S=(L=2*l*(.5>f?f:1-f))*(1-E((s=(s*=360)%360/60)%2-1)),v=w=m=f-L/2,Ii(v+=[L,S,0,0,S,L][s=~~s],w+=[S,L,L,S,0,0][s],m+=[0,0,S,L,L,S][s],h)},b.rgb2hsb=function(s,l,f){var w,m;return f=Se(s,l,f),{h:((0==(m=(w=G(s=f[0],l=f[1],f=f[2]))-X(s,l,f))?null:w==s?(l-f)/m:w==l?(f-s)/m+2:(s-l)/m+4)+360)%6*60/360,s:0==m?0:m/w,b:w,toString:pn}},b.rgb2hsl=function(s,l,f){var w,m,S,L;return f=Se(s,l,f),w=((m=G(s=f[0],l=f[1],f=f[2]))+(S=X(s,l,f)))/2,{h:((0==(L=m-S)?null:m==s?(l-f)/L:m==l?(f-s)/L+2:(s-l)/L+4)+360)%6*60/360,s:0==L?0:.5>w?L/(2*w):L/(2-2*w),l:w,toString:Ge}},b._path2string=function(){return this.join(",").replace(je,"$1")},b._preload=function(s,l){var f=xt.doc.createElement("img");f.style.cssText="position:absolute;left:-9999em;top:-9999em",f.onload=function(){l.call(this),this.onload=null,xt.doc.body.removeChild(this)},f.onerror=function(){xt.doc.body.removeChild(this)},xt.doc.body.appendChild(f),f.src=s},b.getRGB=Vt(function(s){if(!s||(s=U(s)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Jt};if("none"==s)return{r:-1,g:-1,b:-1,hex:"none",toString:Jt};!ni[Wt](s.toLowerCase().substring(0,2))&&"#"!=s.charAt()&&(s=le(s));var l,f,h,v,w,m,S=s.match(Kt);return S?(S[2]&&(h=fe(S[2].substring(5),16),f=fe(S[2].substring(3,5),16),l=fe(S[2].substring(1,3),16)),S[3]&&(h=fe((w=S[3].charAt(3))+w,16),f=fe((w=S[3].charAt(2))+w,16),l=fe((w=S[3].charAt(1))+w,16)),S[4]&&(m=S[4][M](cr),l=Qt(m[0]),"%"==m[0].slice(-1)&&(l*=2.55),f=Qt(m[1]),"%"==m[1].slice(-1)&&(f*=2.55),h=Qt(m[2]),"%"==m[2].slice(-1)&&(h*=2.55),"rgba"==S[1].toLowerCase().slice(0,4)&&(v=Qt(m[3])),m[3]&&"%"==m[3].slice(-1)&&(v/=100)),S[5]?(m=S[5][M](cr),l=Qt(m[0]),"%"==m[0].slice(-1)&&(l*=2.55),f=Qt(m[1]),"%"==m[1].slice(-1)&&(f*=2.55),h=Qt(m[2]),"%"==m[2].slice(-1)&&(h*=2.55),("deg"==m[0].slice(-3)||"\xb0"==m[0].slice(-1))&&(l/=360),"hsba"==S[1].toLowerCase().slice(0,4)&&(v=Qt(m[3])),m[3]&&"%"==m[3].slice(-1)&&(v/=100),b.hsb2rgb(l,f,h,v)):S[6]?(m=S[6][M](cr),l=Qt(m[0]),"%"==m[0].slice(-1)&&(l*=2.55),f=Qt(m[1]),"%"==m[1].slice(-1)&&(f*=2.55),h=Qt(m[2]),"%"==m[2].slice(-1)&&(h*=2.55),("deg"==m[0].slice(-3)||"\xb0"==m[0].slice(-1))&&(l/=360),"hsla"==S[1].toLowerCase().slice(0,4)&&(v=Qt(m[3])),m[3]&&"%"==m[3].slice(-1)&&(v/=100),b.hsl2rgb(l,f,h,v)):((S={r:l,g:f,b:h,toString:Jt}).hex="#"+(16777216|h|f<<8|l<<16).toString(16).slice(1),b.is(v,"finite")&&(S.opacity=v),S)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Jt}},b),b.hsb=Vt(function(s,l,f){return b.hsb2rgb(s,l,f).hex}),b.hsl=Vt(function(s,l,f){return b.hsl2rgb(s,l,f).hex}),b.rgb=Vt(function(s,l,f){function h(v){return v+.5|0}return"#"+(16777216|h(f)|h(l)<<8|h(s)<<16).toString(16).slice(1)}),(b.getColor=function(s){var l=this.getColor.start=this.getColor.start||{h:0,s:1,b:s||.75},f=this.hsb2rgb(l.h,l.s,l.b);return l.h+=.075,l.h>1&&(l.h=0,l.s-=.2,l.s<=0&&(this.getColor.start={h:0,s:1,b:l.b})),f.hex}).reset=function(){delete this.start},b.parsePathString=function(s){if(!s)return null;var l=qe(s);if(l.arr)return Fe(l.arr);var f={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},h=[];return b.is(s,_t)&&b.is(s[0],_t)&&(h=Fe(s)),h.length||U(s).replace(Er,function(v,w,m){var S=[],L=w.toLowerCase();if(m.replace(Tr,function(F,Q){Q&&S.push(+Q)}),"m"==L&&S.length>2&&(h.push([w][Rt](S.splice(0,2))),L="l",w="m"==w?"l":"L"),"r"==L)h.push([w][Rt](S));else for(;S.length>=f[L]&&(h.push([w][Rt](S.splice(0,f[L]))),f[L]););}),h.toString=b._path2string,l.arr=Fe(h),h},b.parseTransformString=Vt(function(s){if(!s)return null;var l=[];return b.is(s,_t)&&b.is(s[0],_t)&&(l=Fe(s)),l.length||U(s).replace(Ve,function(f,h,v){var w=[];D.call(h),v.replace(Tr,function(m,S){S&&w.push(+S)}),l.push([h][Rt](w))}),l.toString=b._path2string,l});var qe=function(s){var l=qe.ps=qe.ps||{};return l[s]?l[s].sleep=100:l[s]={sleep:100},setTimeout(function(){for(var f in l)l[Wt](f)&&f!=s&&(l[f].sleep--,!l[f].sleep&&delete l[f])}),l[s]};b.findDotsAtSegment=function(s,l,f,h,v,w,m,S,L){var F=1-L,Q=ot(F,3),nt=ot(F,2),j=L*L,K=j*L,J=Q*s+3*nt*L*f+3*F*L*L*v+K*m,et=Q*l+3*nt*L*h+3*F*L*L*w+K*S,rt=s+2*L*(f-s)+j*(v-2*f+s),z=l+2*L*(h-l)+j*(w-2*h+l),bt=f+2*L*(v-f)+j*(m-2*v+f),tt=h+2*L*(w-h)+j*(S-2*w+h),ut=F*s+L*f,it=F*l+L*h,Ht=F*v+L*m,Ft=F*w+L*S,Pt=90-180*H.atan2(rt-bt,z-tt)/lt;return(rt>bt||tt>z)&&(Pt+=180),{x:J,y:et,m:{x:rt,y:z},n:{x:bt,y:tt},start:{x:ut,y:it},end:{x:Ht,y:Ft},alpha:Pt}},b.bezierBBox=function(s,l,f,h,v,w,m,S){b.is(s,"array")||(s=[s,l,f,h,v,w,m,S]);var L=ai.apply(null,s);return{x:L.min.x,y:L.min.y,x2:L.max.x,y2:L.max.y,width:L.max.x-L.min.x,height:L.max.y-L.min.y}},b.isPointInsideBBox=function(s,l,f){return l>=s.x&&l<=s.x2&&f>=s.y&&f<=s.y2},b.isBBoxIntersect=function(s,l){var f=b.isPointInsideBBox;return f(l,s.x,s.y)||f(l,s.x2,s.y)||f(l,s.x,s.y2)||f(l,s.x2,s.y2)||f(s,l.x,l.y)||f(s,l.x2,l.y)||f(s,l.x,l.y2)||f(s,l.x2,l.y2)||(s.x<l.x2&&s.x>l.x||l.x<s.x2&&l.x>s.x)&&(s.y<l.y2&&s.y>l.y||l.y<s.y2&&l.y>s.y)},b.pathIntersection=function(s,l){return _(s,l)},b.pathIntersectionNumber=function(s,l){return _(s,l,1)},b.isPointInsidePath=function(s,l,f){var h=b.pathBBox(s);return b.isPointInsideBBox(h,l,f)&&_(s,[["M",l,f],["H",h.x2+10]],1)%2==1},b._removedFactory=function(s){return function(){k("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+s+"\u201d of removed object",s)}};var pr=b.pathBBox=function(s){var l=qe(s);if(l.bbox)return Ct(l.bbox);if(!s)return{x:0,y:0,width:0,height:0,x2:0,y2:0};for(var f,h=0,v=0,w=[],m=[],S=0,L=(s=zr(s)).length;L>S;S++)if("M"==(f=s[S])[0])v=f[2],w.push(h=f[1]),m.push(v);else{var F=ai(h,v,f[1],f[2],f[3],f[4],f[5],f[6]);w=w[Rt](F.min.x,F.max.x),m=m[Rt](F.min.y,F.max.y),h=f[5],v=f[6]}var Q=X[gt](0,w),nt=X[gt](0,m),j=G[gt](0,w),K=G[gt](0,m),J=j-Q,et=K-nt,rt={x:Q,y:nt,x2:j,y2:K,width:J,height:et,cx:Q+J/2,cy:nt+et/2};return l.bbox=Ct(rt),rt},Fe=function(s){var l=Ct(s);return l.toString=b._path2string,l},vn=b._pathToRelative=function(s){var l=qe(s);if(l.rel)return Fe(l.rel);b.is(s,_t)&&b.is(s&&s[0],_t)||(s=b.parsePathString(s));var f=[],h=0,v=0,w=0,m=0,S=0;"M"==s[0][0]&&(w=h=s[0][1],m=v=s[0][2],S++,f.push(["M",h,v]));for(var L=S,F=s.length;F>L;L++){var Q=f[L]=[],nt=s[L];if(nt[0]!=D.call(nt[0]))switch(Q[0]=D.call(nt[0]),Q[0]){case"a":Q[1]=nt[1],Q[2]=nt[2],Q[3]=nt[3],Q[4]=nt[4],Q[5]=nt[5],Q[6]=+(nt[6]-h).toFixed(3),Q[7]=+(nt[7]-v).toFixed(3);break;case"v":Q[1]=+(nt[1]-v).toFixed(3);break;case"m":w=nt[1],m=nt[2];default:for(var j=1,K=nt.length;K>j;j++)Q[j]=+(nt[j]-(j%2?h:v)).toFixed(3)}else{Q=f[L]=[],"m"==nt[0]&&(w=nt[1]+h,m=nt[2]+v);for(var J=0,et=nt.length;et>J;J++)f[L][J]=nt[J]}var rt=f[L].length;switch(f[L][0]){case"z":h=w,v=m;break;case"h":h+=+f[L][rt-1];break;case"v":v+=+f[L][rt-1];break;default:h+=+f[L][rt-2],v+=+f[L][rt-1]}}return f.toString=b._path2string,l.rel=Fe(f),f},gn=b._pathToAbsolute=function(s){var l=qe(s);if(l.abs)return Fe(l.abs);if(b.is(s,_t)&&b.is(s&&s[0],_t)||(s=b.parsePathString(s)),!s||!s.length)return[["M",0,0]];var f=[],h=0,v=0,w=0,m=0,S=0;"M"==s[0][0]&&(w=h=+s[0][1],m=v=+s[0][2],S++,f[0]=["M",h,v]);for(var L,F,Q=3==s.length&&"M"==s[0][0]&&"R"==s[1][0].toUpperCase()&&"Z"==s[2][0].toUpperCase(),nt=S,j=s.length;j>nt;nt++){if(f.push(L=[]),(F=s[nt])[0]!=Oe.call(F[0]))switch(L[0]=Oe.call(F[0]),L[0]){case"A":L[1]=F[1],L[2]=F[2],L[3]=F[3],L[4]=F[4],L[5]=F[5],L[6]=+(F[6]+h),L[7]=+(F[7]+v);break;case"V":L[1]=+F[1]+v;break;case"H":L[1]=+F[1]+h;break;case"R":for(var K=[h,v][Rt](F.slice(1)),J=2,et=K.length;et>J;J++)K[J]=+K[J]+h,K[++J]=+K[J]+v;f.pop(),f=f[Rt](Nt(K,Q));break;case"M":w=+F[1]+h,m=+F[2]+v;default:for(J=1,et=F.length;et>J;J++)L[J]=+F[J]+(J%2?h:v)}else if("R"==F[0])K=[h,v][Rt](F.slice(1)),f.pop(),f=f[Rt](Nt(K,Q)),L=["R"][Rt](F.slice(-2));else for(var rt=0,z=F.length;z>rt;rt++)L[rt]=F[rt];switch(L[0]){case"Z":h=w,v=m;break;case"H":h=L[1];break;case"V":v=L[1];break;case"M":w=L[L.length-2],m=L[L.length-1];default:h=L[L.length-2],v=L[L.length-1]}}return f.toString=b._path2string,l.abs=Fe(f),f},Lr=function(s,l,f,h){return[s,l,f,h,f,h]},yn=function(s,l,f,h,v,w){var m=.3333333333333333,S=2/3;return[m*s+S*f,m*l+S*h,m*v+S*f,m*w+S*h,v,w]},si=function(s,l,f,h,v,w,m,S,L,F){var Q,nt=120*lt/180,j=lt/180*(+v||0),K=[],J=Vt(function(Gi,tr,_r){return{x:Gi*H.cos(_r)-tr*H.sin(_r),y:Gi*H.sin(_r)+tr*H.cos(_r)}});if(F)Ft=F[0],Pt=F[1],it=F[2],Ht=F[3];else{s=(Q=J(s,l,-j)).x,l=Q.y,S=(Q=J(S,L,-j)).x,L=Q.y;var et=(H.cos(lt/180*v),H.sin(lt/180*v),(s-S)/2),rt=(l-L)/2,z=et*et/(f*f)+rt*rt/(h*h);z>1&&(f*=z=H.sqrt(z),h*=z);var bt=f*f,tt=h*h,ut=(w==m?-1:1)*H.sqrt(E((bt*tt-bt*rt*rt-tt*et*et)/(bt*rt*rt+tt*et*et))),it=ut*f*rt/h+(s+S)/2,Ht=ut*-h*et/f+(l+L)/2,Ft=H.asin(((l-Ht)/h).toFixed(9)),Pt=H.asin(((L-Ht)/h).toFixed(9));0>(Ft=it>s?lt-Ft:Ft)&&(Ft=2*lt+Ft),0>(Pt=it>S?lt-Pt:Pt)&&(Pt=2*lt+Pt),m&&Ft>Pt&&(Ft-=2*lt),!m&&Pt>Ft&&(Pt-=2*lt)}var lr=Pt-Ft;if(E(lr)>nt){var gr=Pt,ke=S,Je=L;S=it+f*H.cos(Pt=Ft+nt*(m&&Pt>Ft?1:-1)),L=Ht+h*H.sin(Pt),K=si(S,L,f,h,v,0,m,ke,Je,[Pt,gr,it,Ht])}lr=Pt-Ft;var yr=H.cos(Ft),mr=H.sin(Ft),xr=H.cos(Pt),Ie=H.sin(Pt),$e=H.tan(lr/4),Kr=4/3*f*$e,Pi=4/3*h*$e,Zr=[s,l],Or=[s+Kr*mr,l-Pi*yr],Ei=[S+Kr*Ie,L-Pi*xr],Ye=[S,L];if(Or[0]=2*Zr[0]-Or[0],Or[1]=2*Zr[1]-Or[1],F)return[Or,Ei,Ye][Rt](K);for(var xn=[],ar=0,Ri=(K=[Or,Ei,Ye][Rt](K).join()[M](",")).length;Ri>ar;ar++)xn[ar]=ar%2?J(K[ar-1],K[ar],j).y:J(K[ar],K[ar+1],j).x;return xn},li=function(s,l,f,h,v,w,m,S,L){var F=1-L;return{x:ot(F,3)*s+3*ot(F,2)*L*f+3*F*L*L*v+ot(L,3)*m,y:ot(F,3)*l+3*ot(F,2)*L*h+3*F*L*L*w+ot(L,3)*S}},ai=Vt(function(s,l,f,h,v,w,m,S){var L,F=v-2*f+s-(m-2*v+f),Q=2*(f-s)-2*(v-f),nt=s-f,j=(-Q+H.sqrt(Q*Q-4*F*nt))/2/F,K=(-Q-H.sqrt(Q*Q-4*F*nt))/2/F,J=[l,S],et=[s,m];return E(j)>"1e12"&&(j=.5),E(K)>"1e12"&&(K=.5),j>0&&1>j&&(L=li(s,l,f,h,v,w,m,S,j),et.push(L.x),J.push(L.y)),K>0&&1>K&&(L=li(s,l,f,h,v,w,m,S,K),et.push(L.x),J.push(L.y)),j=(-(Q=2*(h-l)-2*(w-h))+H.sqrt(Q*Q-4*(F=w-2*h+l-(S-2*w+h))*(nt=l-h)))/2/F,K=(-Q-H.sqrt(Q*Q-4*F*nt))/2/F,E(j)>"1e12"&&(j=.5),E(K)>"1e12"&&(K=.5),j>0&&1>j&&(L=li(s,l,f,h,v,w,m,S,j),et.push(L.x),J.push(L.y)),K>0&&1>K&&(L=li(s,l,f,h,v,w,m,S,K),et.push(L.x),J.push(L.y)),{min:{x:X[gt](0,et),y:X[gt](0,J)},max:{x:G[gt](0,et),y:G[gt](0,J)}}}),zr=b._path2curve=Vt(function(s,l){var f=!l&&qe(s);if(!l&&f.curve)return Fe(f.curve);for(var h=gn(s),v=l&&gn(l),w={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},m={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},S=function(ut,it,Ht){var Ft,Pt;if(!ut)return["C",it.x,it.y,it.x,it.y,it.x,it.y];switch(!(ut[0]in{T:1,Q:1})&&(it.qx=it.qy=null),ut[0]){case"M":it.X=ut[1],it.Y=ut[2];break;case"A":ut=["C"][Rt](si[gt](0,[it.x,it.y][Rt](ut.slice(1))));break;case"S":"C"==Ht||"S"==Ht?(Ft=2*it.x-it.bx,Pt=2*it.y-it.by):(Ft=it.x,Pt=it.y),ut=["C",Ft,Pt][Rt](ut.slice(1));break;case"T":"Q"==Ht||"T"==Ht?(it.qx=2*it.x-it.qx,it.qy=2*it.y-it.qy):(it.qx=it.x,it.qy=it.y),ut=["C"][Rt](yn(it.x,it.y,it.qx,it.qy,ut[1],ut[2]));break;case"Q":it.qx=ut[1],it.qy=ut[2],ut=["C"][Rt](yn(it.x,it.y,ut[1],ut[2],ut[3],ut[4]));break;case"L":ut=["C"][Rt](Lr(it.x,it.y,ut[1],ut[2]));break;case"H":ut=["C"][Rt](Lr(it.x,it.y,ut[1],it.y));break;case"V":ut=["C"][Rt](Lr(it.x,it.y,it.x,ut[1]));break;case"Z":ut=["C"][Rt](Lr(it.x,it.y,it.X,it.Y))}return ut},L=function(ut,it){if(ut[it].length>7){ut[it].shift();for(var Ht=ut[it];Ht.length;)Q[it]="A",v&&(nt[it]="A"),ut.splice(it++,0,["C"][Rt](Ht.splice(0,6)));ut.splice(it,1),et=G(h.length,v&&v.length||0)}},F=function(ut,it,Ht,Ft,Pt){ut&&it&&"M"==ut[Pt][0]&&"M"!=it[Pt][0]&&(it.splice(Pt,0,["M",Ft.x,Ft.y]),Ht.bx=0,Ht.by=0,Ht.x=ut[Pt][1],Ht.y=ut[Pt][2],et=G(h.length,v&&v.length||0))},Q=[],nt=[],j="",K="",J=0,et=G(h.length,v&&v.length||0);et>J;J++){h[J]&&(j=h[J][0]),"C"!=j&&(Q[J]=j,J&&(K=Q[J-1])),h[J]=S(h[J],w,K),"A"!=Q[J]&&"C"==j&&(Q[J]="C"),L(h,J),v&&(v[J]&&(j=v[J][0]),"C"!=j&&(nt[J]=j,J&&(K=nt[J-1])),v[J]=S(v[J],m,K),"A"!=nt[J]&&"C"==j&&(nt[J]="C"),L(v,J)),F(h,v,w,m,J),F(v,h,m,w,J);var rt=h[J],z=v&&v[J],bt=rt.length,tt=v&&z.length;w.x=rt[bt-2],w.y=rt[bt-1],w.bx=Qt(rt[bt-4])||w.x,w.by=Qt(rt[bt-3])||w.y,m.bx=v&&(Qt(z[tt-4])||m.x),m.by=v&&(Qt(z[tt-3])||m.y),m.x=v&&z[tt-2],m.y=v&&z[tt-1]}return v||(f.curve=Fe(h)),v?[h,v]:h},null,Fe),ui=(b._parseDots=Vt(function(s){for(var l=[],f=0,h=s.length;h>f;f++){var v={},w=s[f].match(/^([^:]*):?([\d\.]*)/);if(v.color=b.getRGB(w[1]),v.color.error)return null;v.opacity=v.color.opacity,v.color=v.color.hex,w[2]&&(v.offset=w[2]+"%"),l.push(v)}for(f=1,h=l.length-1;h>f;f++)if(!l[f].offset){for(var m=Qt(l[f-1].offset||0),S=0,L=f+1;h>L;L++)if(l[L].offset){S=l[L].offset;break}S||(S=100,L=h);for(var F=((S=Qt(S))-m)/(L-f+1);L>f;f++)l[f].offset=(m+=F)+"%"}return l}),b._tear=function(s,l){s==l.top&&(l.top=s.prev),s==l.bottom&&(l.bottom=s.next),s.next&&(s.next.prev=s.prev),s.prev&&(s.prev.next=s.next)}),Wi=(b._tofront=function(s,l){l.top!==s&&(ui(s,l),s.next=null,s.prev=l.top,l.top.next=s,l.top=s)},b._toback=function(s,l){l.bottom!==s&&(ui(s,l),s.next=l.bottom,s.prev=null,l.bottom.prev=s,l.bottom=s)},b._insertafter=function(s,l,f){ui(s,f),l==f.top&&(f.top=s),l.next&&(l.next.prev=s),s.next=l.next,s.prev=l,l.next=s},b._insertbefore=function(s,l,f){ui(s,f),l==f.bottom&&(f.bottom=s),l.prev&&(l.prev.next=s),s.prev=l.prev,l.prev=s,s.next=l},b.toMatrix=function(s,l){var f=pr(s),h={_:{transform:W},getBBox:function(){return f}};return mn(h,l),h.matrix}),mn=(b.transformPath=function(s,l){return Gr(s,Wi(s,l))},b._extractTransform=function(s,l){if(null==l)return s._.transform;l=U(l).replace(/\.{3}|\u2026/g,s._.transform||W);var v,w,f=b.parseTransformString(l),h=0,m=1,S=1,L=s._,F=new A;if(L.transform=f||[],f)for(var Q=0,nt=f.length;nt>Q;Q++){var j,K,J,et,rt,z=f[Q],bt=z.length,tt=U(z[0]).toLowerCase(),ut=z[0]!=tt,it=ut?F.invert():0;"t"==tt&&3==bt?ut?(j=it.x(0,0),K=it.y(0,0),J=it.x(z[1],z[2]),et=it.y(z[1],z[2]),F.translate(J-j,et-K)):F.translate(z[1],z[2]):"r"==tt?2==bt?(rt=rt||s.getBBox(1),F.rotate(z[1],rt.x+rt.width/2,rt.y+rt.height/2),h+=z[1]):4==bt&&(ut?(J=it.x(z[2],z[3]),et=it.y(z[2],z[3]),F.rotate(z[1],J,et)):F.rotate(z[1],z[2],z[3]),h+=z[1]):"s"==tt?2==bt||3==bt?(rt=rt||s.getBBox(1),F.scale(z[1],z[bt-1],rt.x+rt.width/2,rt.y+rt.height/2),m*=z[1],S*=z[bt-1]):5==bt&&(ut?(J=it.x(z[3],z[4]),et=it.y(z[3],z[4]),F.scale(z[1],z[2],J,et)):F.scale(z[1],z[2],z[3],z[4]),m*=z[1],S*=z[2]):"m"==tt&&7==bt&&F.add(z[1],z[2],z[3],z[4],z[5],z[6]),L.dirtyT=1,s.matrix=F}s.matrix=F,L.sx=m,L.sy=S,L.deg=h,L.dx=v=F.e,L.dy=w=F.f,1==m&&1==S&&!h&&L.bbox?(L.bbox.x+=+v,L.bbox.y+=+w):L.dirtyT=1}),fi=function(s){var l=s[0];switch(l.toLowerCase()){case"t":return[l,0,0];case"m":return[l,1,0,0,1,0,0];case"r":return 4==s.length?[l,0,s[2],s[3]]:[l,0];case"s":return 5==s.length?[l,1,1,s[3],s[4]]:3==s.length?[l,1,1]:[l,1]}},kr=b._equaliseTransform=function(s,l){l=U(l).replace(/\.{3}|\u2026/g,s),s=b.parseTransformString(s)||[],l=b.parseTransformString(l)||[];for(var f,h,v,w,m=G(s.length,l.length),S=[],L=[],F=0;m>F;F++){if(v=s[F]||fi(l[F]),w=l[F]||fi(v),v[0]!=w[0]||"r"==v[0].toLowerCase()&&(v[2]!=w[2]||v[3]!=w[3])||"s"==v[0].toLowerCase()&&(v[3]!=w[3]||v[4]!=w[4]))return;for(S[F]=[],L[F]=[],f=0,h=G(v.length,w.length);h>f;f++)f in v&&(S[F][f]=v[f]),f in w&&(L[F][f]=w[f])}return{from:S,to:L}};b._getContainer=function(s,l,f,h){var v;return null!=(v=null!=h||b.is(s,"object")?s:xt.doc.getElementById(s))?v.tagName?null==l?{container:v,width:v.style.pixelWidth||v.offsetWidth,height:v.style.pixelHeight||v.offsetHeight}:{container:v,width:l,height:f}:{container:1,x:s,y:l,width:f,height:h}:void 0},b.pathToRelative=vn,b._engine={},b.path2curve=zr,b.matrix=function(s,l,f,h,v,w){return new A(s,l,f,h,v,w)},function(s){function l(h){return h[0]*h[0]+h[1]*h[1]}function f(h){var v=H.sqrt(l(h));h[0]&&(h[0]/=v),h[1]&&(h[1]/=v)}s.add=function(h,v,w,m,S,L){var F,Q,nt,j,K=[[],[],[]],J=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],et=[[h,w,S],[v,m,L],[0,0,1]];for(h&&h instanceof A&&(et=[[h.a,h.c,h.e],[h.b,h.d,h.f],[0,0,1]]),F=0;3>F;F++)for(Q=0;3>Q;Q++){for(j=0,nt=0;3>nt;nt++)j+=J[F][nt]*et[nt][Q];K[F][Q]=j}this.a=K[0][0],this.b=K[1][0],this.c=K[0][1],this.d=K[1][1],this.e=K[0][2],this.f=K[1][2]},s.invert=function(){var h=this,v=h.a*h.d-h.b*h.c;return new A(h.d/v,-h.b/v,-h.c/v,h.a/v,(h.c*h.f-h.d*h.e)/v,(h.b*h.e-h.a*h.f)/v)},s.clone=function(){return new A(this.a,this.b,this.c,this.d,this.e,this.f)},s.translate=function(h,v){this.add(1,0,0,1,h,v)},s.scale=function(h,v,w,m){null==v&&(v=h),(w||m)&&this.add(1,0,0,1,w,m),this.add(h,0,0,v,0,0),(w||m)&&this.add(1,0,0,1,-w,-m)},s.rotate=function(h,v,w){h=b.rad(h),v=v||0,w=w||0;var m=+H.cos(h).toFixed(9),S=+H.sin(h).toFixed(9);this.add(m,S,-S,m,v,w),this.add(1,0,0,1,-v,-w)},s.x=function(h,v){return h*this.a+v*this.c+this.e},s.y=function(h,v){return h*this.b+v*this.d+this.f},s.get=function(h){return+this[U.fromCharCode(97+h)].toFixed(4)},s.toString=function(){return b.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},s.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},s.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},s.split=function(){var h={};h.dx=this.e,h.dy=this.f;var v=[[this.a,this.c],[this.b,this.d]];h.scalex=H.sqrt(l(v[0])),f(v[0]),h.shear=v[0][0]*v[1][0]+v[0][1]*v[1][1],v[1]=[v[1][0]-v[0][0]*h.shear,v[1][1]-v[0][1]*h.shear],h.scaley=H.sqrt(l(v[1])),f(v[1]),h.shear/=h.scaley;var w=-v[0][1],m=v[1][1];return 0>m?(h.rotate=b.deg(H.acos(m)),0>w&&(h.rotate=360-h.rotate)):h.rotate=b.deg(H.asin(w)),h.isSimple=!(+h.shear.toFixed(9)||h.scalex.toFixed(9)!=h.scaley.toFixed(9)&&h.rotate),h.isSuperSimple=!+h.shear.toFixed(9)&&h.scalex.toFixed(9)==h.scaley.toFixed(9)&&!h.rotate,h.noRotation=!+h.shear.toFixed(9)&&!h.rotate,h},s.toTransformString=function(h){var v=h||this[M]();return v.isSimple?(v.scalex=+v.scalex.toFixed(4),v.scaley=+v.scaley.toFixed(4),v.rotate=+v.rotate.toFixed(4),(v.dx||v.dy?"t"+[v.dx,v.dy]:W)+(1!=v.scalex||1!=v.scaley?"s"+[v.scalex,v.scaley,0,0]:W)+(v.rotate?"r"+[v.rotate,0,0]:W)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(A.prototype);for(var Yn=function(){this.returnValue=!1},Xn=function(){return this.originalEvent.preventDefault()},hi=function(){this.cancelBubble=!0},Bi=function(){return this.originalEvent.stopPropagation()},vr=function(s){return{x:s.clientX+(xt.doc.documentElement.scrollLeft||xt.doc.body.scrollLeft),y:s.clientY+(xt.doc.documentElement.scrollTop||xt.doc.body.scrollTop)}},Kn=xt.doc.addEventListener?function(s,l,f,h){var v=function(m){var S=vr(m);return f.call(h,m,S.x,S.y)};if(s.addEventListener(l,v,!1),x&&O[l]){var w=function(m){for(var S=vr(m),L=m,F=0,Q=m.targetTouches&&m.targetTouches.length;Q>F;F++)if(m.targetTouches[F].target==s){(m=m.targetTouches[F]).originalEvent=L,m.preventDefault=Xn,m.stopPropagation=Bi;break}return f.call(h,m,S.x,S.y)};s.addEventListener(O[l],w,!1)}return function(){return s.removeEventListener(l,v,!1),x&&O[l]&&s.removeEventListener(O[l],w,!1),!0}}:xt.doc.attachEvent?function(s,l,f,h){var v=function(m){var F=(m=m||xt.win.event).clientX+(xt.doc.documentElement.scrollLeft||xt.doc.body.scrollLeft),Q=m.clientY+(xt.doc.documentElement.scrollTop||xt.doc.body.scrollTop);return m.preventDefault=m.preventDefault||Yn,m.stopPropagation=m.stopPropagation||hi,f.call(h,m,F,Q)};return s.attachEvent("on"+l,v),function(){return s.detachEvent("on"+l,v),!0}}:void 0,_e=[],Ur=function(s){for(var l,f=s.clientX,h=s.clientY,v=xt.doc.documentElement.scrollTop||xt.doc.body.scrollTop,w=xt.doc.documentElement.scrollLeft||xt.doc.body.scrollLeft,m=_e.length;m--;){if(l=_e[m],x&&s.touches){for(var S,L=s.touches.length;L--;)if((S=s.touches[L]).identifier==l.el._drag.id){f=S.clientX,h=S.clientY,(s.originalEvent?s.originalEvent:s).preventDefault();break}}else s.preventDefault();var F,Q=l.el.node,nt=Q.nextSibling,j=Q.parentNode,K=Q.style.display;xt.win.opera&&j.removeChild(Q),Q.style.display="none",F=l.el.paper.getElementByPoint(f,h),Q.style.display=K,xt.win.opera&&(nt?j.insertBefore(Q,nt):j.appendChild(Q)),F&&k("raphael.drag.over."+l.el.id,l.el,F),k("raphael.drag.move."+l.el.id,l.move_scope||l.el,(f+=w)-l.el._drag.x,(h+=v)-l.el._drag.y,f,h,s)}},ci=function(s){b.unmousemove(Ur).unmouseup(ci);for(var l,f=_e.length;f--;)(l=_e[f]).el._drag={},k("raphael.drag.end."+l.el.id,l.end_scope||l.start_scope||l.move_scope||l.el,s);_e=[]},At=b.el={},Lt=y.length;Lt--;)!function(s){b[s]=At[s]=function(l,f){return b.is(l,"function")&&(this.events=this.events||[],this.events.push({name:s,f:l,unbind:Kn(this.shape||this.node||xt.doc,s,l,f||this)})),this},b["un"+s]=At["un"+s]=function(l){for(var f=this.events||[],h=f.length;h--;)f[h].name!=s||!b.is(l,"undefined")&&f[h].f!=l||(f[h].unbind(),f.splice(h,1),!f.length&&delete this.events);return this}}(y[Lt]);At.data=function(s,l){var f=Le[this.id]=Le[this.id]||{};if(0==arguments.length)return f;if(1==arguments.length){if(b.is(s,"object")){for(var h in s)s[Wt](h)&&this.data(h,s[h]);return this}return k("raphael.data.get."+this.id,this,f[s],s),f[s]}return f[s]=l,k("raphael.data.set."+this.id,this,l,s),this},At.removeData=function(s){return null==s?Le[this.id]={}:Le[this.id]&&delete Le[this.id][s],this},At.getData=function(){return Ct(Le[this.id]||{})},At.hover=function(s,l,f,h){return this.mouseover(s,f).mouseout(l,h||f)},At.unhover=function(s,l){return this.unmouseover(s).unmouseout(l)};var ze=[];At.drag=function(s,l,f,h,v,w){function m(S){(S.originalEvent||S).preventDefault();var L=S.clientX,F=S.clientY,Q=xt.doc.documentElement.scrollTop||xt.doc.body.scrollTop,nt=xt.doc.documentElement.scrollLeft||xt.doc.body.scrollLeft;if(this._drag.id=S.identifier,x&&S.touches)for(var j,K=S.touches.length;K--;)if(this._drag.id=(j=S.touches[K]).identifier,j.identifier==this._drag.id){L=j.clientX,F=j.clientY;break}this._drag.x=L+nt,this._drag.y=F+Q,!_e.length&&b.mousemove(Ur).mouseup(ci),_e.push({el:this,move_scope:h,start_scope:v,end_scope:w}),l&&k.on("raphael.drag.start."+this.id,l),s&&k.on("raphael.drag.move."+this.id,s),f&&k.on("raphael.drag.end."+this.id,f),k("raphael.drag.start."+this.id,v||h||this,S.clientX+nt,S.clientY+Q,S)}return this._drag={},ze.push({el:this,start:m}),this.mousedown(m),this},At.onDragOver=function(s){s?k.on("raphael.drag.over."+this.id,s):k.unbind("raphael.drag.over."+this.id)},At.undrag=function(){for(var s=ze.length;s--;)ze[s].el==this&&(this.unmousedown(ze[s].start),ze.splice(s,1),k.unbind("raphael.drag.*."+this.id));!ze.length&&b.unmousemove(Ur).unmouseup(ci),_e=[]},at.circle=function(s,l,f){var h=b._engine.circle(this,s||0,l||0,f||0);return this.__set__&&this.__set__.push(h),h},at.rect=function(s,l,f,h,v){var w=b._engine.rect(this,s||0,l||0,f||0,h||0,v||0);return this.__set__&&this.__set__.push(w),w},at.ellipse=function(s,l,f,h){var v=b._engine.ellipse(this,s||0,l||0,f||0,h||0);return this.__set__&&this.__set__.push(v),v},at.path=function(s){s&&!b.is(s,Ut)&&!b.is(s[0],_t)&&(s+=W);var l=b._engine.path(b.format[gt](b,arguments),this);return this.__set__&&this.__set__.push(l),l},at.image=function(s,l,f,h,v){var w=b._engine.image(this,s||"about:blank",l||0,f||0,h||0,v||0);return this.__set__&&this.__set__.push(w),w},at.text=function(s,l,f){var h=b._engine.text(this,s||0,l||0,U(f));return this.__set__&&this.__set__.push(h),h},at.set=function(s){!b.is(s,"array")&&(s=Array.prototype.splice.call(arguments,0,arguments.length));var l=new sr(s);return this.__set__&&this.__set__.push(l),l.paper=this,l.type="set",l},at.setStart=function(s){this.__set__=s||this.set()},at.setFinish=function(s){var l=this.__set__;return delete this.__set__,l},at.getSize=function(){var s=this.canvas.parentNode;return{width:s.offsetWidth,height:s.offsetHeight}},at.setSize=function(s,l){return b._engine.setSize.call(this,s,l)},at.setViewBox=function(s,l,f,h,v){return b._engine.setViewBox.call(this,s,l,f,h,v)},at.top=at.bottom=null,at.raphael=b,at.getElementByPoint=function(s,l){var f=this,h=f.canvas,v=xt.doc.elementFromPoint(s,l);if(xt.win.opera&&"svg"==v.tagName){var w=function(s){var l=s.getBoundingClientRect(),f=s.ownerDocument,h=f.body,v=f.documentElement;return{y:l.top+(xt.win.pageYOffset||v.scrollTop||h.scrollTop)-(v.clientTop||h.clientTop||0),x:l.left+(xt.win.pageXOffset||v.scrollLeft||h.scrollLeft)-(v.clientLeft||h.clientLeft||0)}}(h),m=h.createSVGRect();m.x=s-w.x,m.y=l-w.y,m.width=m.height=1;var S=h.getIntersectionList(m,null);S.length&&(v=S[S.length-1])}if(!v)return null;for(;v.parentNode&&v!=h.parentNode&&!v.raphael;)v=v.parentNode;return v==f.canvas.parentNode&&(v=h),v&&v.raphael?f.getById(v.raphaelid):null},at.getElementsByBBox=function(s){var l=this.set();return this.forEach(function(f){b.isBBoxIntersect(f.getBBox(),s)&&l.push(f)}),l},at.getById=function(s){for(var l=this.bottom;l;){if(l.id==s)return l;l=l.next}return null},at.forEach=function(s,l){for(var f=this.bottom;f;){if(!1===s.call(l,f))return this;f=f.next}return this},at.getElementsByPoint=function(s,l){var f=this.set();return this.forEach(function(h){h.isPointInside(s,l)&&f.push(h)}),f},At.isPointInside=function(s,l){var f=this.realPath=Mt[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(f=b.transformPath(f,this.attr("transform"))),b.isPointInsidePath(f,s,l)},At.getBBox=function(s){if(this.removed)return{};var l=this._;return s?((l.dirty||!l.bboxwt)&&(this.realPath=Mt[this.type](this),l.bboxwt=pr(this.realPath),l.bboxwt.toString=Z,l.dirty=0),l.bboxwt):((l.dirty||l.dirtyT||!l.bbox)&&((l.dirty||!this.realPath)&&(l.bboxwt=0,this.realPath=Mt[this.type](this)),l.bbox=pr(Gr(this.realPath,this.matrix)),l.bbox.toString=Z,l.dirty=l.dirtyT=0),l.bbox)},At.clone=function(){if(this.removed)return null;var s=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(s),s},At.glow=function(s){if("text"==this.type)return null;var l={width:((s=s||{}).width||10)+(+this.attr("stroke-width")||1),fill:s.fill||!1,opacity:null==s.opacity?.5:s.opacity,offsetx:s.offsetx||0,offsety:s.offsety||0,color:s.color||"#000"},f=l.width/2,h=this.paper,v=h.set(),w=this.realPath||Mt[this.type](this);w=this.matrix?Gr(w,this.matrix):w;for(var m=1;f+1>m;m++)v.push(h.path(w).attr({stroke:l.color,fill:l.fill?l.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(l.width/f*m).toFixed(3),opacity:+(l.opacity/f).toFixed(3)}));return v.insertBefore(this).translate(l.offsetx,l.offsety)};var Ue=function(s,l,f,h,v,w,m,S,L){return null==L?zt(s,l,f,h,v,w,m,S):b.findDotsAtSegment(s,l,f,h,v,w,m,S,function p(s,l,f,h,v,w,m,S,L){if(!(0>L||zt(s,l,f,h,v,w,m,S)<L)){var F,nt=.5,j=1-nt;for(F=zt(s,l,f,h,v,w,m,S,j);E(F-L)>.01;)F=zt(s,l,f,h,v,w,m,S,j+=(L>F?1:-1)*(nt/=2));return j}}(s,l,f,h,v,w,m,S,L))},$t=function(s,l){return function(f,h,v){for(var w,m,S,L,F,Q="",nt={},j=0,K=0,J=(f=zr(f)).length;J>K;K++){if("M"==(S=f[K])[0])w=+S[1],m=+S[2];else{if(j+(L=Ue(w,m,S[1],S[2],S[3],S[4],S[5],S[6]))>h){if(l&&!nt.start){if(Q+=["C"+(F=Ue(w,m,S[1],S[2],S[3],S[4],S[5],S[6],h-j)).start.x,F.start.y,F.m.x,F.m.y,F.x,F.y],v)return Q;nt.start=Q,Q=["M"+F.x,F.y+"C"+F.n.x,F.n.y,F.end.x,F.end.y,S[5],S[6]].join(),j+=L,w=+S[5],m=+S[6];continue}if(!s&&!l)return{x:(F=Ue(w,m,S[1],S[2],S[3],S[4],S[5],S[6],h-j)).x,y:F.y,alpha:F.alpha}}j+=L,w=+S[5],m=+S[6]}Q+=S.shift()+S}return nt.end=Q,(F=s?j:l?nt:b.findDotsAtSegment(w,m,S[0],S[1],S[2],S[3],S[4],S[5],1)).alpha&&(F={x:F.x,y:F.y,alpha:F.alpha}),F}},or=$t(1),Nr=$t(),Yr=$t(0,1);b.getTotalLength=or,b.getPointAtLength=Nr,b.getSubpath=function(s,l,f){if(this.getTotalLength(s)-f<1e-6)return Yr(s,l).end;var h=Yr(s,f,1);return l?Yr(h,l).end:h},At.getTotalLength=function(){var s=this.getPath();if(s)return this.node.getTotalLength?this.node.getTotalLength():or(s)},At.getPointAtLength=function(s){var l=this.getPath();if(l)return Nr(l,s)},At.getPath=function(){var s,l=b._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return l&&(s=l(this)),s},At.getSubpath=function(s,l){var f=this.getPath();if(f)return b.getSubpath(f,s,l)};var q=b.easing_formulas={linear:function(s){return s},"<":function(s){return ot(s,1.7)},">":function(s){return ot(s,.48)},"<>":function(s){var l=.48-s/1.04,f=H.sqrt(.1734+l*l),h=f-l,w=-f-l,S=ot(E(h),1/3)*(0>h?-1:1)+ot(E(w),1/3)*(0>w?-1:1)+.5;return 3*(1-S)*S*S+S*S*S},backIn:function(s){var l=1.70158;return s*s*((l+1)*s-l)},backOut:function(s){var l=1.70158;return(s-=1)*s*((l+1)*s+l)+1},elastic:function(s){return s==!!s?s:ot(2,-10*s)*H.sin(2*(s-.075)*lt/.3)+1},bounce:function(s){var f=7.5625,h=2.75;return 1/h>s?f*s*s:2/h>s?f*(s-=1.5/h)*s+.75:2.5/h>s?f*(s-=2.25/h)*s+.9375:f*(s-=2.625/h)*s+.984375}};q.easeIn=q["ease-in"]=q["<"],q.easeOut=q["ease-out"]=q[">"],q.easeInOut=q["ease-in-out"]=q["<>"],q["back-in"]=q.backIn,q["back-out"]=q.backOut;var pt=[],di=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(s){setTimeout(s,16)},Xr=function(){for(var s=+new Date,l=0;l<pt.length;l++){var f=pt[l];if(!f.el.removed&&!f.paused){var h,v,w=s-f.start,m=f.ms,S=f.easing,L=f.from,F=f.diff,Q=f.to,nt=f.el,j={},K={};if(f.initstatus?(w=(f.initstatus*f.anim.top-f.prev)/(f.percent-f.prev)*m,f.status=f.initstatus,delete f.initstatus,f.stop&&pt.splice(l--,1)):f.status=(f.prev+w/m*(f.percent-f.prev))/f.anim.top,!(0>w))if(m>w){var J=S(w/m);for(var et in L)if(L[Wt](et)){switch(se[et]){case St:h=+L[et]+J*m*F[et];break;case"colour":h="rgb("+[Mr(Zt(L[et].r+J*m*F[et].r)),Mr(Zt(L[et].g+J*m*F[et].g)),Mr(Zt(L[et].b+J*m*F[et].b))].join(",")+")";break;case"path":h=[];for(var rt=0,z=L[et].length;z>rt;rt++){h[rt]=[L[et][rt][0]];for(var bt=1,tt=L[et][rt].length;tt>bt;bt++)h[rt][bt]=+L[et][rt][bt]+J*m*F[et][rt][bt];h[rt]=h[rt].join(P)}h=h.join(P);break;case"transform":if(F[et].real)for(h=[],rt=0,z=L[et].length;z>rt;rt++)for(h[rt]=[L[et][rt][0]],bt=1,tt=L[et][rt].length;tt>bt;bt++)h[rt][bt]=L[et][rt][bt]+J*m*F[et][rt][bt];else{var ut=function(Ht){return+L[et][Ht]+J*m*F[et][Ht]};h=[["m",ut(0),ut(1),ut(2),ut(3),ut(4),ut(5)]]}break;case"csv":if("clip-rect"==et)for(h=[],rt=4;rt--;)h[rt]=+L[et][rt]+J*m*F[et][rt];break;default:var it=[][Rt](L[et]);for(h=[],rt=nt.paper.customAttributes[et].length;rt--;)h[rt]=+it[rt]+J*m*F[et][rt]}j[et]=h}nt.attr(j),function(Ht,Ft,Pt){setTimeout(function(){k("raphael.anim.frame."+Ht,Ft,Pt)})}(nt.id,nt,f.anim)}else{if(function(Ht,Ft,Pt){setTimeout(function(){k("raphael.anim.frame."+Ft.id,Ft,Pt),k("raphael.anim.finish."+Ft.id,Ft,Pt),b.is(Ht,"function")&&Ht.call(Ft)})}(f.callback,nt,f.anim),nt.attr(Q),pt.splice(l--,1),f.repeat>1&&!f.next){for(v in Q)Q[Wt](v)&&(K[v]=f.totalOrigin[v]);f.el.attr(K),dt(f.anim,f.el,f.anim.percents[0],null,f.totalOrigin,f.repeat-1)}f.next&&!f.stop&&dt(f.anim,f.el,f.next,null,f.totalOrigin,f.repeat)}}}pt.length&&di(Xr)},Mr=function(s){return s>255?255:0>s?0:s};At.animateWith=function(s,l,f,h,v,w){var m=this;if(m.removed)return w&&w.call(m),m;var S=f instanceof R?f:b.animation(f,h,v,w);dt(S,m,S.percents[0],null,m.attr());for(var L=0,F=pt.length;F>L;L++)if(pt[L].anim==l&&pt[L].el==s){pt[F-1].start=pt[L].start;break}return m},At.onAnimation=function(s){return s?k.on("raphael.anim.frame."+this.id,s):k.unbind("raphael.anim.frame."+this.id),this},R.prototype.delay=function(s){var l=new R(this.anim,this.ms);return l.times=this.times,l.del=+s||0,l},R.prototype.repeat=function(s){var l=new R(this.anim,this.ms);return l.del=this.del,l.times=H.floor(G(s,0))||1,l},b.animation=function(s,l,f,h){if(s instanceof R)return s;(b.is(f,"function")||!f)&&(h=h||f||null,f=null),s=Object(s),l=+l||0;var v,w,m={};for(w in s)s[Wt](w)&&Qt(w)!=w&&Qt(w)+"%"!=w&&(v=!0,m[w]=s[w]);if(v)return f&&(m.easing=f),h&&(m.callback=h),new R({100:m},l);if(h){var S=0;for(var L in s){var F=fe(L);s[Wt](L)&&F>S&&(S=F)}!s[S+="%"].callback&&(s[S].callback=h)}return new R(s,l)},At.animate=function(s,l,f,h){var v=this;if(v.removed)return h&&h.call(v),v;var w=s instanceof R?s:b.animation(s,l,f,h);return dt(w,v,w.percents[0],null,v.attr()),v},At.setTime=function(s,l){return s&&null!=l&&this.status(s,X(l,s.ms)/s.ms),this},At.status=function(s,l){var f,h,v=[],w=0;if(null!=l)return dt(s,this,-1,X(l,1)),this;for(f=pt.length;f>w;w++)if((h=pt[w]).el.id==this.id&&(!s||h.anim==s)){if(s)return h.status;v.push({anim:h.anim,status:h.status})}return s?0:v},At.pause=function(s){for(var l=0;l<pt.length;l++)pt[l].el.id!=this.id||s&&pt[l].anim!=s||!1!==k("raphael.anim.pause."+this.id,this,pt[l].anim)&&(pt[l].paused=!0);return this},At.resume=function(s){for(var l=0;l<pt.length;l++)if(pt[l].el.id==this.id&&(!s||pt[l].anim==s)){var f=pt[l];!1!==k("raphael.anim.resume."+this.id,this,f.anim)&&(delete f.paused,this.status(f.anim,f.status))}return this},At.stop=function(s){for(var l=0;l<pt.length;l++)pt[l].el.id!=this.id||s&&pt[l].anim!=s||!1!==k("raphael.anim.stop."+this.id,this,pt[l].anim)&&pt.splice(l--,1);return this},k.on("raphael.remove",vt),k.on("raphael.clear",vt),At.toString=function(){return"Rapha\xebl\u2019s object"};var sr=function(s){if(this.items=[],this.length=0,this.type="set",s)for(var l=0,f=s.length;f>l;l++)!s[l]||s[l].constructor!=At.constructor&&s[l].constructor!=sr||(this[this.items.length]=this.items[this.items.length]=s[l],this.length++)},ve=sr.prototype;for(var Dt in ve.push=function(){for(var s,l,f=0,h=arguments.length;h>f;f++)!(s=arguments[f])||s.constructor!=At.constructor&&s.constructor!=sr||(this[l=this.items.length]=this.items[l]=s,this.length++);return this},ve.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},ve.forEach=function(s,l){for(var f=0,h=this.items.length;h>f;f++)if(!1===s.call(l,this.items[f],f))return this;return this},At)At[Wt](Dt)&&(ve[Dt]=function(s){return function(){var l=arguments;return this.forEach(function(f){f[s][gt](f,l)})}}(Dt));return ve.attr=function(s,l){if(s&&b.is(s,_t)&&b.is(s[0],"object"))for(var f=0,h=s.length;h>f;f++)this.items[f].attr(s[f]);else for(var v=0,w=this.items.length;w>v;v++)this.items[v].attr(s,l);return this},ve.clear=function(){for(;this.length;)this.pop()},ve.splice=function(s,l,f){s=0>s?G(this.length+s,0):s,l=G(0,X(this.length-s,l));var h,v=[],w=[],m=[];for(h=2;h<arguments.length;h++)m.push(arguments[h]);for(h=0;l>h;h++)w.push(this[s+h]);for(;h<this.length-s;h++)v.push(this[s+h]);var S=m.length;for(h=0;h<S+v.length;h++)this.items[s+h]=this[s+h]=S>h?m[h]:v[h-S];for(h=this.items.length=this.length-=l-S;this[h];)delete this[h++];return new sr(w)},ve.exclude=function(s){for(var l=0,f=this.length;f>l;l++)if(this[l]==s)return this.splice(l,1),!0},ve.animate=function(s,l,f,h){(b.is(f,"function")||!f)&&(h=f||null);var v,w,m=this.items.length,S=m,L=this;if(!m)return this;h&&(w=function(){!--m&&h.call(L)}),f=b.is(f,Ut)?f:w;var F=b.animation(s,l,f,w);for(v=this.items[--S].animate(F);S--;)this.items[S]&&!this.items[S].removed&&this.items[S].animateWith(v,F,F),this.items[S]&&!this.items[S].removed||m--;return this},ve.insertAfter=function(s){for(var l=this.items.length;l--;)this.items[l].insertAfter(s);return this},ve.getBBox=function(){for(var s=[],l=[],f=[],h=[],v=this.items.length;v--;)if(!this.items[v].removed){var w=this.items[v].getBBox();s.push(w.x),l.push(w.y),f.push(w.x+w.width),h.push(w.y+w.height)}return{x:s=X[gt](0,s),y:l=X[gt](0,l),x2:f=G[gt](0,f),y2:h=G[gt](0,h),width:f-s,height:h-l}},ve.clone=function(s){s=this.paper.set();for(var l=0,f=this.items.length;f>l;l++)s.push(this.items[l].clone());return s},ve.toString=function(){return"Rapha\xebl\u2018s set"},ve.glow=function(s){var l=this.paper.set();return this.forEach(function(f,h){var v=f.glow(s);null!=v&&v.forEach(function(w,m){l.push(w)})}),l},ve.isPointInside=function(s,l){var f=!1;return this.forEach(function(h){return h.isPointInside(s,l)?(f=!0,!1):void 0}),f},b.registerFont=function(s){if(!s.face)return s;this.fonts=this.fonts||{};var l={w:s.w,face:{},glyphs:{}},f=s.face["font-family"];for(var h in s.face)s.face[Wt](h)&&(l.face[h]=s.face[h]);if(this.fonts[f]?this.fonts[f].push(l):this.fonts[f]=[l],!s.svg)for(var v in l.face["units-per-em"]=fe(s.face["units-per-em"],10),s.glyphs)if(s.glyphs[Wt](v)){var w=s.glyphs[v];if(l.glyphs[v]={w:w.w,k:{},d:w.d&&"M"+w.d.replace(/[mlcxtrv]/g,function(S){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[S]||"M"})+"z"},w.k)for(var m in w.k)w[Wt](m)&&(l.glyphs[v].k[m]=w.k[m])}return s},at.getFont=function(s,l,f,h){if(h=h||"normal",f=f||"normal",l=+l||{normal:400,bold:700,lighter:300,bolder:800}[l]||400,b.fonts){var S,v=b.fonts[s];if(!v){var w=new RegExp("(^|\\s)"+s.replace(/[^\w\d\s+!~.:_-]/g,W)+"(\\s|$)","i");for(var m in b.fonts)if(b.fonts[Wt](m)&&w.test(m)){v=b.fonts[m];break}}if(v)for(var L=0,F=v.length;F>L&&((S=v[L]).face["font-weight"]!=l||S.face["font-style"]!=f&&S.face["font-style"]||S.face["font-stretch"]!=h);L++);return S}},at.print=function(s,l,f,h,v,w,m,S){w=w||"middle",m=G(X(m||0,1),-1),S=G(X(S||1,3),1);var L,F=U(f)[M](W),Q=0,nt=0,j=W;if(b.is(h,"string")&&(h=this.getFont(h)),h){L=(v||16)/h.face["units-per-em"];for(var K=h.face.bbox[M](ft),J=+K[0],et=K[3]-K[1],rt=0,z=+K[1]+("baseline"==w?et+ +h.face.descent:et/2),bt=0,tt=F.length;tt>bt;bt++){if("\n"==F[bt])Q=0,it=0,nt=0,rt+=et*S;else{var ut=nt&&h.glyphs[F[bt-1]]||{},it=h.glyphs[F[bt]];Q+=nt?(ut.w||h.w)+(ut.k&&ut.k[F[bt]]||0)+h.w*m:0,nt=1}it&&it.d&&(j+=b.transformPath(it.d,["t",Q*L,rt*L,"s",L,L,J,z,"t",(s-J)/L,(l-z)/L]))}}return this.path(j).attr({fill:"#000",stroke:"none"})},at.add=function(s){if(b.is(s,"array"))for(var l,f=this.set(),h=0,v=s.length;v>h;h++)It[Wt]((l=s[h]||{}).type)&&f.push(this[l.type]().attr(l));return f},b.format=function(s,l){var f=b.is(l,_t)?[0][Rt](l):arguments;return s&&b.is(s,Ut)&&f.length-1&&(s=s.replace(qt,function(h,v){return null==f[++v]?W:f[v]})),s||W},b.fullfill=function(){var s=/\{([^\}]+)\}/g,l=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;return function(h,v){return String(h).replace(s,function(w,m){return function(h,v,w){var m=w;return v.replace(l,function(S,L,F,Q,nt){L=L||Q,m&&(L in m&&(m=m[L]),"function"==typeof m&&nt&&(m=m()))}),m=(null==m||m==w?h:m)+""}(w,m,v)})}}(),b.ninja=function(){return ee.was?xt.win.Raphael=ee.is:delete Raphael,b},b.st=ve,k.on("raphael.DOMload",function(){mt=!0}),function(s,l,f){null==s.readyState&&s.addEventListener&&(s.addEventListener(l,f=function(){s.removeEventListener(l,f,!1),s.readyState="complete"},!1),s.readyState="loading"),function h(){/in/.test(s.readyState)?setTimeout(h,9):b.eve("raphael.DOMload")}()}(document,"DOMContentLoaded"),b}),function(k,b){"function"==typeof define&&define.amd?define("raphael.svg",["raphael.core"],function(Ct){return b(Ct)}):b("object"==typeof exports?require("./raphael.core"):k.Raphael)}(this,function(k){if(!k||k.svg){var b="hasOwnProperty",Ct=String,Et=parseFloat,Vt=parseInt,Jt=Math,Nt=Jt.max,Gt=Jt.abs,zt=Jt.pow,p=/[, ]+/,g=k.eve,T="",_=" ",A="http://www.w3.org/1999/xlink",Z={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},$={};k.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var R=function(x,W){if(W)for(var P in"string"==typeof x&&(x=R(x)),W)W[b](P)&&("xlink:"==P.substring(0,6)?x.setAttributeNS(A,P.substring(6),Ct(W[P])):x.setAttribute(P,Ct(W[P])));else(x=k._g.doc.createElementNS("http://www.w3.org/2000/svg",x)).style&&(x.style.webkitTapHighlightColor="rgba(0,0,0,0)");return x},dt=function(x,W){var P="linear",U=x.id+W,M=.5,y=.5,O=x.node,D=x.paper,H=O.style,G=k._g.doc.getElementById(U);if(!G){if(W=(W=Ct(W).replace(k._radial_gradient,function(_t,Bt,Kt){if(P="radial",Bt&&Kt){M=Et(Bt);var Tt=2*((y=Et(Kt))>.5)-1;zt(M-.5,2)+zt(y-.5,2)>.25&&(y=Jt.sqrt(.25-zt(M-.5,2))*Tt+.5)&&.5!=y&&(y=y.toFixed(5)-1e-5*Tt)}return T})).split(/\s*\-\s*/),"linear"==P){var X=W.shift();if(X=-Et(X),isNaN(X))return null;var E=[0,0,Jt.cos(k.rad(X)),Jt.sin(k.rad(X))],ot=1/(Nt(Gt(E[2]),Gt(E[3]))||1);E[2]*=ot,E[3]*=ot,E[2]<0&&(E[0]=-E[2],E[2]=0),E[3]<0&&(E[1]=-E[3],E[3]=0)}var lt=k._parseDots(W);if(!lt)return null;if(U=U.replace(/[\(\)\s,\xb0#]/g,"_"),x.gradient&&U!=x.gradient.id&&(D.defs.removeChild(x.gradient),delete x.gradient),!x.gradient){G=R(P+"Gradient",{id:U}),x.gradient=G,R(G,"radial"==P?{fx:M,fy:y}:{x1:E[0],y1:E[1],x2:E[2],y2:E[3],gradientTransform:x.matrix.invert()}),D.defs.appendChild(G);for(var St=0,Ut=lt.length;Ut>St;St++)G.appendChild(R("stop",{offset:lt[St].offset?lt[St].offset:St?"100%":"0%","stop-color":lt[St].color||"#fff","stop-opacity":isFinite(lt[St].opacity)?lt[St].opacity:1}))}}return R(O,{fill:"url('"+document.location.origin+document.location.pathname+"#"+U+"')",opacity:1,"fill-opacity":1}),H.fill=T,H.opacity=1,H.fillOpacity=1,1},vt=function(x){var W=x.getBBox(1);R(x.pattern,{patternTransform:x.matrix.invert()+" translate("+W.x+","+W.y+")"})},mt=function(x,W,P){if("path"==x.type){for(var U,M,y,O,D,H=Ct(W).toLowerCase().split("-"),G=x.paper,X=P?"end":"start",E=x.node,ot=x.attrs,lt=ot["stroke-width"],St=H.length,Ut="classic",_t=3,Bt=3,Kt=5;St--;)switch(H[St]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":Ut=H[St];break;case"wide":Bt=5;break;case"narrow":Bt=2;break;case"long":_t=5;break;case"short":_t=2}if("open"==Ut?(_t+=2,Bt+=2,Kt+=2,y=1,O=P?4:1,D={fill:"none",stroke:ot.stroke}):(O=y=_t/2,D={fill:ot.stroke,stroke:"none"}),x._.arrows?P?(x._.arrows.endPath&&$[x._.arrows.endPath]--,x._.arrows.endMarker&&$[x._.arrows.endMarker]--):(x._.arrows.startPath&&$[x._.arrows.startPath]--,x._.arrows.startMarker&&$[x._.arrows.startMarker]--):x._.arrows={},"none"!=Ut){var Tt="raphael-marker-"+Ut,jt="raphael-marker-"+X+Ut+_t+Bt+"-obj"+x.id;k._g.doc.getElementById(Tt)?$[Tt]++:(G.defs.appendChild(R(R("path"),{"stroke-linecap":"round",d:Z[Ut],id:Tt})),$[Tt]=1);var Zt,Qt=k._g.doc.getElementById(jt);Qt?($[jt]++,Zt=Qt.getElementsByTagName("use")[0]):(Qt=R(R("marker"),{id:jt,markerHeight:Bt,markerWidth:_t,orient:"auto",refX:O,refY:Bt/2}),Zt=R(R("use"),{"xlink:href":"#"+Tt,transform:(P?"rotate(180 "+_t/2+" "+Bt/2+") ":T)+"scale("+_t/Kt+","+Bt/Kt+")","stroke-width":(1/((_t/Kt+Bt/Kt)/2)).toFixed(4)}),Qt.appendChild(Zt),G.defs.appendChild(Qt),$[jt]=1),R(Zt,D);var fe=y*("diamond"!=Ut&&"oval"!=Ut);P?(U=x._.arrows.startdx*lt||0,M=k.getTotalLength(ot.path)-fe*lt):(U=fe*lt,M=k.getTotalLength(ot.path)-(x._.arrows.enddx*lt||0)),(D={})["marker-"+X]="url(#"+jt+")",(M||U)&&(D.d=k.getSubpath(ot.path,U,M)),R(E,D),x._.arrows[X+"Path"]=Tt,x._.arrows[X+"Marker"]=jt,x._.arrows[X+"dx"]=fe,x._.arrows[X+"Type"]=Ut,x._.arrows[X+"String"]=W}else P?(U=x._.arrows.startdx*lt||0,M=k.getTotalLength(ot.path)-U):(U=0,M=k.getTotalLength(ot.path)-(x._.arrows.enddx*lt||0)),x._.arrows[X+"Path"]&&R(E,{d:k.getSubpath(ot.path,U,M)}),delete x._.arrows[X+"Path"],delete x._.arrows[X+"Marker"],delete x._.arrows[X+"dx"],delete x._.arrows[X+"Type"],delete x._.arrows[X+"String"];for(D in $)if($[b](D)&&!$[D]){var Oe=k._g.doc.getElementById(D);Oe&&Oe.parentNode.removeChild(Oe)}}},at={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},ft=function(x,W,P){if(W=at[Ct(W).toLowerCase()]){for(var U=x.attrs["stroke-width"]||"1",M={round:U,square:U,butt:0}[x.attrs["stroke-linecap"]||P["stroke-linecap"]]||0,y=[],O=W.length;O--;)y[O]=W[O]*U+(O%2?1:-1)*M;R(x.node,{"stroke-dasharray":y.join(",")})}else R(x.node,{"stroke-dasharray":"none"})},It=function(x,W){var P=x.node,U=x.attrs,M=P.style.visibility;for(var y in P.style.visibility="hidden",W)if(W[b](y)){if(!k._availableAttrs[b](y))continue;var O=W[y];switch(U[y]=O,y){case"blur":x.blur(O);break;case"title":var D=P.getElementsByTagName("title");if(D.length&&(D=D[0]))D.firstChild.nodeValue=O;else{D=R("title");var H=k._g.doc.createTextNode(O);D.appendChild(H),P.appendChild(D)}break;case"href":case"target":var G=P.parentNode;if("a"!=G.tagName.toLowerCase()){var X=R("a");G.insertBefore(X,P),X.appendChild(P),G=X}"target"==y?G.setAttributeNS(A,"show","blank"==O?"new":O):G.setAttributeNS(A,y,O);break;case"cursor":P.style.cursor=O;break;case"transform":x.transform(O);break;case"arrow-start":mt(x,O);break;case"arrow-end":mt(x,O,1);break;case"clip-rect":var E=Ct(O).split(p);if(4==E.length){x.clip&&x.clip.parentNode.parentNode.removeChild(x.clip.parentNode);var ot=R("clipPath"),lt=R("rect");ot.id=k.createUUID(),R(lt,{x:E[0],y:E[1],width:E[2],height:E[3]}),ot.appendChild(lt),x.paper.defs.appendChild(ot),R(P,{"clip-path":"url(#"+ot.id+")"}),x.clip=lt}if(!O){var St=P.getAttribute("clip-path");if(St){var Ut=k._g.doc.getElementById(St.replace(/(^url\(#|\)$)/g,T));Ut&&Ut.parentNode.removeChild(Ut),R(P,{"clip-path":T}),delete x.clip}}break;case"path":"path"==x.type&&(R(P,{d:O?U.path=k._pathToAbsolute(O):"M0,0"}),x._.dirty=1,x._.arrows&&("startString"in x._.arrows&&mt(x,x._.arrows.startString),"endString"in x._.arrows&&mt(x,x._.arrows.endString,1)));break;case"width":if(P.setAttribute(y,O),x._.dirty=1,!U.fx)break;y="x",O=U.x;case"x":U.fx&&(O=-U.x-(U.width||0));case"rx":if("rx"==y&&"rect"==x.type)break;case"cx":P.setAttribute(y,O),x.pattern&&vt(x),x._.dirty=1;break;case"height":if(P.setAttribute(y,O),x._.dirty=1,!U.fy)break;y="y",O=U.y;case"y":U.fy&&(O=-U.y-(U.height||0));case"ry":if("ry"==y&&"rect"==x.type)break;case"cy":P.setAttribute(y,O),x.pattern&&vt(x),x._.dirty=1;break;case"r":"rect"==x.type?R(P,{rx:O,ry:O}):P.setAttribute(y,O),x._.dirty=1;break;case"src":"image"==x.type&&P.setAttributeNS(A,"href",O);break;case"stroke-width":(1!=x._.sx||1!=x._.sy)&&(O/=Nt(Gt(x._.sx),Gt(x._.sy))||1),P.setAttribute(y,O),U["stroke-dasharray"]&&ft(x,U["stroke-dasharray"],W),x._.arrows&&("startString"in x._.arrows&&mt(x,x._.arrows.startString),"endString"in x._.arrows&&mt(x,x._.arrows.endString,1));break;case"stroke-dasharray":ft(x,O,W);break;case"fill":var _t=Ct(O).match(k._ISURL);if(_t){ot=R("pattern");var Bt=R("image");ot.id=k.createUUID(),R(ot,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),R(Bt,{x:0,y:0,"xlink:href":_t[1]}),ot.appendChild(Bt),function(Qt){k._preload(_t[1],function(){var fe=this.offsetWidth,Oe=this.offsetHeight;R(Qt,{width:fe,height:Oe}),R(Bt,{width:fe,height:Oe})})}(ot),x.paper.defs.appendChild(ot),R(P,{fill:"url(#"+ot.id+")"}),x.pattern=ot,x.pattern&&vt(x);break}var Kt=k.getRGB(O);if(Kt.error){if(("circle"==x.type||"ellipse"==x.type||"r"!=Ct(O).charAt())&&dt(x,O)){if("opacity"in U||"fill-opacity"in U){var Tt=k._g.doc.getElementById(P.getAttribute("fill").replace(/^url\(#|\)$/g,T));if(Tt){var jt=Tt.getElementsByTagName("stop");R(jt[jt.length-1],{"stop-opacity":("opacity"in U?U.opacity:1)*("fill-opacity"in U?U["fill-opacity"]:1)})}}U.gradient=O,U.fill="none";break}}else delete W.gradient,delete U.gradient,!k.is(U.opacity,"undefined")&&k.is(W.opacity,"undefined")&&R(P,{opacity:U.opacity}),!k.is(U["fill-opacity"],"undefined")&&k.is(W["fill-opacity"],"undefined")&&R(P,{"fill-opacity":U["fill-opacity"]});Kt[b]("opacity")&&R(P,{"fill-opacity":Kt.opacity>1?Kt.opacity/100:Kt.opacity});case"stroke":Kt=k.getRGB(O),P.setAttribute(y,Kt.hex),"stroke"==y&&Kt[b]("opacity")&&R(P,{"stroke-opacity":Kt.opacity>1?Kt.opacity/100:Kt.opacity}),"stroke"==y&&x._.arrows&&("startString"in x._.arrows&&mt(x,x._.arrows.startString),"endString"in x._.arrows&&mt(x,x._.arrows.endString,1));break;case"gradient":("circle"==x.type||"ellipse"==x.type||"r"!=Ct(O).charAt())&&dt(x,O);break;case"opacity":U.gradient&&!U[b]("stroke-opacity")&&R(P,{"stroke-opacity":O>1?O/100:O});case"fill-opacity":if(U.gradient){(Tt=k._g.doc.getElementById(P.getAttribute("fill").replace(/^url\(#|\)$/g,T)))&&(jt=Tt.getElementsByTagName("stop"),R(jt[jt.length-1],{"stop-opacity":O}));break}default:"font-size"==y&&(O=Vt(O,10)+"px");var Zt=y.replace(/(\-.)/g,function(Qt){return Qt.substring(1).toUpperCase()});P.style[Zt]=O,x._.dirty=1,P.setAttribute(y,O)}}Wt(x,W),P.style.visibility=M},Wt=function(x,W){if("text"==x.type&&(W[b]("text")||W[b]("font")||W[b]("font-size")||W[b]("x")||W[b]("y"))){var P=x.attrs,U=x.node,M=U.firstChild?Vt(k._g.doc.defaultView.getComputedStyle(U.firstChild,T).getPropertyValue("font-size"),10):10;if(W[b]("text")){for(P.text=W.text;U.firstChild;)U.removeChild(U.firstChild);for(var y,O=Ct(W.text).split("\n"),D=[],H=0,G=O.length;G>H;H++)y=R("tspan"),H&&R(y,{dy:1.2*M,x:P.x}),y.appendChild(k._g.doc.createTextNode(O[H])),U.appendChild(y),D[H]=y}else for(H=0,G=(D=U.getElementsByTagName("tspan")).length;G>H;H++)H?R(D[H],{dy:1.2*M,x:P.x}):R(D[0],{dy:0});R(U,{x:P.x,y:P.y}),x._.dirty=1;var X=x._getBBox(),E=P.y-(X.y+X.height/2);E&&k.is(E,"finite")&&R(D[0],{dy:E})}},xt=function(x){return x.parentNode&&"a"===x.parentNode.tagName.toLowerCase()?x.parentNode:x},ee=function(x,W){this[0]=this.node=x,x.raphael=!0,this.id=k._oid++,x.raphaelid=this.id,this.matrix=k.matrix(),this.realPath=null,this.paper=W,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!W.bottom&&(W.bottom=this),this.prev=W.top,W.top&&(W.top.next=this),W.top=this,this.next=null},Xt=k.el;ee.prototype=Xt,Xt.constructor=ee,k._engine.path=function(x,W){var P=R("path");W.canvas&&W.canvas.appendChild(P);var U=new ee(P,W);return U.type="path",It(U,{fill:"none",stroke:"#000",path:x}),U},Xt.rotate=function(x,W,P){if(this.removed)return this;if((x=Ct(x).split(p)).length-1&&(W=Et(x[1]),P=Et(x[2])),x=Et(x[0]),null==P&&(W=P),null==W||null==P){var U=this.getBBox(1);W=U.x+U.width/2,P=U.y+U.height/2}return this.transform(this._.transform.concat([["r",x,W,P]])),this},Xt.scale=function(x,W,P,U){if(this.removed)return this;if((x=Ct(x).split(p)).length-1&&(W=Et(x[1]),P=Et(x[2]),U=Et(x[3])),x=Et(x[0]),null==W&&(W=x),null==U&&(P=U),null==P||null==U)var M=this.getBBox(1);return this.transform(this._.transform.concat([["s",x,W,P=null==P?M.x+M.width/2:P,U=null==U?M.y+M.height/2:U]])),this},Xt.translate=function(x,W){return this.removed||((x=Ct(x).split(p)).length-1&&(W=Et(x[1])),x=Et(x[0])||0,this.transform(this._.transform.concat([["t",x,W=+W||0]]))),this},Xt.transform=function(x){var W=this._;if(null==x)return W.transform;if(k._extractTransform(this,x),this.clip&&R(this.clip,{transform:this.matrix.invert()}),this.pattern&&vt(this),this.node&&R(this.node,{transform:this.matrix}),1!=W.sx||1!=W.sy){var P=this.attrs[b]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":P})}return W.transform=this.matrix.toTransformString(),this},Xt.hide=function(){return this.removed||(this.node.style.display="none"),this},Xt.show=function(){return this.removed||(this.node.style.display=""),this},Xt.remove=function(){var x=xt(this.node);if(!this.removed&&x.parentNode){var W=this.paper;for(var P in W.__set__&&W.__set__.exclude(this),g.unbind("raphael.*.*."+this.id),this.gradient&&W.defs.removeChild(this.gradient),k._tear(this,W),x.parentNode.removeChild(x),this.removeData(),this)this[P]="function"==typeof this[P]?k._removedFactory(P):null;this.removed=!0}},Xt._getBBox=function(){if("none"==this.node.style.display){this.show();var x=!0}var W,P=!1;this.paper.canvas.parentElement?W=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(W=this.paper.canvas.parentNode.style),W&&"none"==W.display&&(P=!0,W.display="");var U={};try{U=this.node.getBBox()}catch(M){U={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{U=U||{},P&&(W.display="none")}return x&&this.hide(),U},Xt.attr=function(x,W){if(this.removed)return this;if(null==x){var P={};for(var U in this.attrs)this.attrs[b](U)&&(P[U]=this.attrs[U]);return P.gradient&&"none"==P.fill&&(P.fill=P.gradient)&&delete P.gradient,P.transform=this._.transform,P}if(null==W&&k.is(x,"string")){if("fill"==x&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==x)return this._.transform;for(var M=x.split(p),y={},O=0,D=M.length;D>O;O++)y[x=M[O]]=x in this.attrs?this.attrs[x]:k.is(this.paper.customAttributes[x],"function")?this.paper.customAttributes[x].def:k._availableAttrs[x];return D-1?y:y[M[0]]}if(null==W&&k.is(x,"array")){for(y={},O=0,D=x.length;D>O;O++)y[x[O]]=this.attr(x[O]);return y}if(null!=W){var H={};H[x]=W}else null!=x&&k.is(x,"object")&&(H=x);for(var G in H)g("raphael.attr."+G+"."+this.id,this,H[G]);for(G in this.paper.customAttributes)if(this.paper.customAttributes[b](G)&&H[b](G)&&k.is(this.paper.customAttributes[G],"function")){var X=this.paper.customAttributes[G].apply(this,[].concat(H[G]));for(var E in this.attrs[G]=H[G],X)X[b](E)&&(H[E]=X[E])}return It(this,H),this},Xt.toFront=function(){if(this.removed)return this;var x=xt(this.node);x.parentNode.appendChild(x);var W=this.paper;return W.top!=this&&k._tofront(this,W),this},Xt.toBack=function(){if(this.removed)return this;var x=xt(this.node),W=x.parentNode;return W.insertBefore(x,W.firstChild),k._toback(this,this.paper),this},Xt.insertAfter=function(x){if(this.removed||!x)return this;var W=xt(this.node),P=xt(x.node||x[x.length-1].node);return P.nextSibling?P.parentNode.insertBefore(W,P.nextSibling):P.parentNode.appendChild(W),k._insertafter(this,x,this.paper),this},Xt.insertBefore=function(x){if(this.removed||!x)return this;var W=xt(this.node),P=xt(x.node||x[0].node);return P.parentNode.insertBefore(W,P),k._insertbefore(this,x,this.paper),this},Xt.blur=function(x){var W=this;if(0!=+x){var P=R("filter"),U=R("feGaussianBlur");W.attrs.blur=x,P.id=k.createUUID(),R(U,{stdDeviation:+x||1.5}),P.appendChild(U),W.paper.defs.appendChild(P),W._blur=P,R(W.node,{filter:"url(#"+P.id+")"})}else W._blur&&(W._blur.parentNode.removeChild(W._blur),delete W._blur,delete W.attrs.blur),W.node.removeAttribute("filter");return W},k._engine.circle=function(x,W,P,U){var M=R("circle");x.canvas&&x.canvas.appendChild(M);var y=new ee(M,x);return y.attrs={cx:W,cy:P,r:U,fill:"none",stroke:"#000"},y.type="circle",R(M,y.attrs),y},k._engine.rect=function(x,W,P,U,M,y){var O=R("rect");x.canvas&&x.canvas.appendChild(O);var D=new ee(O,x);return D.attrs={x:W,y:P,width:U,height:M,rx:y||0,ry:y||0,fill:"none",stroke:"#000"},D.type="rect",R(O,D.attrs),D},k._engine.ellipse=function(x,W,P,U,M){var y=R("ellipse");x.canvas&&x.canvas.appendChild(y);var O=new ee(y,x);return O.attrs={cx:W,cy:P,rx:U,ry:M,fill:"none",stroke:"#000"},O.type="ellipse",R(y,O.attrs),O},k._engine.image=function(x,W,P,U,M,y){var O=R("image");R(O,{x:P,y:U,width:M,height:y,preserveAspectRatio:"none"}),O.setAttributeNS(A,"href",W),x.canvas&&x.canvas.appendChild(O);var D=new ee(O,x);return D.attrs={x:P,y:U,width:M,height:y,src:W},D.type="image",D},k._engine.text=function(x,W,P,U){var M=R("text");x.canvas&&x.canvas.appendChild(M);var y=new ee(M,x);return y.attrs={x:W,y:P,"text-anchor":"middle",text:U,"font-family":k._availableAttrs["font-family"],"font-size":k._availableAttrs["font-size"],stroke:"none",fill:"#000"},y.type="text",It(y,y.attrs),y},k._engine.setSize=function(x,W){return this.width=x||this.width,this.height=W||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},k._engine.create=function(){var x=k._getContainer.apply(0,arguments),W=x&&x.container,P=x.x,U=x.y,M=x.width,y=x.height;if(!W)throw new Error("SVG container not found.");var O,D=R("svg"),H="overflow:hidden;";return P=P||0,U=U||0,R(D,{height:y=y||342,version:1.1,width:M=M||512,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),1==W?(D.style.cssText=H+"position:absolute;left:"+P+"px;top:"+U+"px",k._g.doc.body.appendChild(D),O=1):(D.style.cssText=H+"position:relative",W.firstChild?W.insertBefore(D,W.firstChild):W.appendChild(D)),(W=new k._Paper).width=M,W.height=y,W.canvas=D,W.clear(),W._left=W._top=0,O&&(W.renderfix=function(){}),W.renderfix(),W},k._engine.setViewBox=function(x,W,P,U,M){g("raphael.setViewBox",this,this._viewBox,[x,W,P,U,M]);var y,D=this.getSize(),H=Nt(P/D.width,U/D.height),G=this.top,X=M?"xMidYMid meet":"xMinYMin";for(null==x?(this._vbSize&&(H=1),delete this._vbSize,y="0 0 "+this.width+_+this.height):(this._vbSize=H,y=x+_+W+_+P+_+U),R(this.canvas,{viewBox:y,preserveAspectRatio:X});H&&G;)G.attr({"stroke-width":"stroke-width"in G.attrs?G.attrs["stroke-width"]:1}),G._.dirty=1,G._.dirtyT=1,G=G.prev;return this._viewBox=[x,W,P,U,!!M],this},k.prototype.renderfix=function(){var x,W=this.canvas,P=W.style;try{x=W.getScreenCTM()||W.createSVGMatrix()}catch(y){x=W.createSVGMatrix()}var U=-x.e%1,M=-x.f%1;(U||M)&&(U&&(this._left=(this._left+U)%1,P.left=this._left+"px"),M&&(this._top=(this._top+M)%1,P.top=this._top+"px"))},k.prototype.clear=function(){k.eve("raphael.clear",this);for(var x=this.canvas;x.firstChild;)x.removeChild(x.firstChild);this.bottom=this.top=null,(this.desc=R("desc")).appendChild(k._g.doc.createTextNode("Created with Rapha\xebl "+k.version)),x.appendChild(this.desc),x.appendChild(this.defs=R("defs"))},k.prototype.remove=function(){for(var x in g("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this)this[x]="function"==typeof this[x]?k._removedFactory(x):null};var gt=k.st;for(var Rt in Xt)Xt[b](Rt)&&!gt[b](Rt)&&(gt[Rt]=function(x){return function(){var W=arguments;return this.forEach(function(P){P[x].apply(P,W)})}}(Rt))}}),function(k,b){"function"==typeof define&&define.amd?define("raphael.vml",["raphael.core"],function(Ct){return b(Ct)}):b("object"==typeof exports?require("./raphael.core"):k.Raphael)}(this,function(k){if(!k||k.vml){var b="hasOwnProperty",Ct=String,Et=parseFloat,Vt=Math,Jt=Vt.round,Nt=Vt.max,Gt=Vt.min,zt=Vt.abs,p="fill",g=/[, ]+/,T=k.eve,A=" ",Z="",$={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},R=/([clmz]),?([^clmz]*)/gi,dt=/ progid:\S+Blur\([^\)]+\)/g,vt=/-?[^,\s-]+/g,mt="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",at=21600,ft={path:1,rect:1,image:1},It={circle:1,ellipse:1},Wt=function(M,y,O){var D=k.matrix();return D.rotate(-M,.5,.5),{dx:D.x(y,O),dy:D.y(y,O)}},xt=function(M,y,O,D,H,G){var X=M._,E=M.matrix,ot=X.fillpos,lt=M.node,St=lt.style,Ut=1,_t="",Bt=at/y,Kt=at/O;if(St.visibility="hidden",y&&O){if(lt.coordsize=zt(Bt)+A+zt(Kt),St.rotation=G*(0>y*O?-1:1),G){var Tt=Wt(G,D,H);D=Tt.dx,H=Tt.dy}if(0>y&&(_t+="x"),0>O&&(_t+=" y")&&(Ut=-1),St.flip=_t,lt.coordorigin=D*-Bt+A+H*-Kt,ot||X.fillsize){var jt=lt.getElementsByTagName(p);lt.removeChild(jt=jt&&jt[0]),ot&&(Tt=Wt(G,E.x(ot[0],ot[1]),E.y(ot[0],ot[1])),jt.position=Tt.dx*Ut+A+Tt.dy*Ut),X.fillsize&&(jt.size=X.fillsize[0]*zt(y)+A+X.fillsize[1]*zt(O)),lt.appendChild(jt)}St.visibility="visible"}};k.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var W,ee=function(M,y,O){for(var D=Ct(y).toLowerCase().split("-"),H=O?"end":"start",G=D.length,X="classic",E="medium",ot="medium";G--;)switch(D[G]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":X=D[G];break;case"wide":case"narrow":ot=D[G];break;case"long":case"short":E=D[G]}var lt=M.node.getElementsByTagName("stroke")[0];lt[H+"arrow"]=X,lt[H+"arrowlength"]=E,lt[H+"arrowwidth"]=ot},Xt=function(M,y){M.attrs=M.attrs||{};var O=M.node,D=M.attrs,H=O.style,G=ft[M.type]&&(y.x!=D.x||y.y!=D.y||y.width!=D.width||y.height!=D.height||y.cx!=D.cx||y.cy!=D.cy||y.rx!=D.rx||y.ry!=D.ry||y.r!=D.r),X=It[M.type]&&(D.cx!=y.cx||D.cy!=y.cy||D.r!=y.r||D.rx!=y.rx||D.ry!=y.ry),E=M;for(var ot in y)y[b](ot)&&(D[ot]=y[ot]);if(G&&(D.path=k._getPath[M.type](M),M._.dirty=1),y.href&&(O.href=y.href),y.title&&(O.title=y.title),y.target&&(O.target=y.target),y.cursor&&(H.cursor=y.cursor),"blur"in y&&M.blur(y.blur),(y.path&&"path"==M.type||G)&&(O.path=function(M){var y=/[ahqstv]/gi,O=k._pathToAbsolute;if(Ct(M).match(y)&&(O=k._path2curve),y=/[clmz]/g,O==k._pathToAbsolute&&!Ct(M).match(y)){var D=Ct(M).replace(R,function(Ut,_t,Bt){var Kt=[],Tt="m"==_t.toLowerCase(),jt=$[_t];return Bt.replace(vt,function(Zt){Tt&&2==Kt.length&&(jt+=Kt+$["m"==_t?"l":"L"],Kt=[]),Kt.push(Jt(Zt*at))}),jt+Kt});return D}var H,G,X=O(M);D=[];for(var E=0,ot=X.length;ot>E;E++){H=X[E],"z"==(G=X[E][0].toLowerCase())&&(G="x");for(var lt=1,St=H.length;St>lt;lt++)G+=Jt(H[lt]*at)+(lt!=St-1?",":Z);D.push(G)}return D.join(A)}(~Ct(D.path).toLowerCase().indexOf("r")?k._pathToAbsolute(D.path):D.path),M._.dirty=1,"image"==M.type&&(M._.fillpos=[D.x,D.y],M._.fillsize=[D.width,D.height],xt(M,1,1,0,0,0))),"transform"in y&&M.transform(y.transform),X){var lt=+D.cx,St=+D.cy,Ut=+D.rx||+D.r||0,_t=+D.ry||+D.r||0;O.path=k.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",Jt((lt-Ut)*at),Jt((St-_t)*at),Jt((lt+Ut)*at),Jt((St+_t)*at),Jt(lt*at)),M._.dirty=1}if("clip-rect"in y){var Bt=Ct(y["clip-rect"]).split(g);if(4==Bt.length){Bt[2]=+Bt[2]+ +Bt[0],Bt[3]=+Bt[3]+ +Bt[1];var Kt=O.clipRect||k._g.doc.createElement("div"),Tt=Kt.style;Tt.clip=k.format("rect({1}px {2}px {3}px {0}px)",Bt),O.clipRect||(Tt.position="absolute",Tt.top=0,Tt.left=0,Tt.width=M.paper.width+"px",Tt.height=M.paper.height+"px",O.parentNode.insertBefore(Kt,O),Kt.appendChild(O),O.clipRect=Kt)}y["clip-rect"]||O.clipRect&&(O.clipRect.style.clip="auto")}if(M.textpath){var jt=M.textpath.style;y.font&&(jt.font=y.font),y["font-family"]&&(jt.fontFamily='"'+y["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,Z)+'"'),y["font-size"]&&(jt.fontSize=y["font-size"]),y["font-weight"]&&(jt.fontWeight=y["font-weight"]),y["font-style"]&&(jt.fontStyle=y["font-style"])}if("arrow-start"in y&&ee(E,y["arrow-start"]),"arrow-end"in y&&ee(E,y["arrow-end"],1),null!=y.opacity||null!=y["stroke-width"]||null!=y.fill||null!=y.src||null!=y.stroke||null!=y["stroke-width"]||null!=y["stroke-opacity"]||null!=y["fill-opacity"]||null!=y["stroke-dasharray"]||null!=y["stroke-miterlimit"]||null!=y["stroke-linejoin"]||null!=y["stroke-linecap"]){var Zt=O.getElementsByTagName(p);if(!(Zt=Zt&&Zt[0])&&(Zt=W(p)),"image"==M.type&&y.src&&(Zt.src=y.src),y.fill&&(Zt.on=!0),(null==Zt.on||"none"==y.fill||null===y.fill)&&(Zt.on=!1),Zt.on&&y.fill){var fe=Ct(y.fill).match(k._ISURL);if(fe){Zt.parentNode==O&&O.removeChild(Zt),Zt.rotate=!0,Zt.src=fe[1],Zt.type="tile";var Oe=M.getBBox(1);Zt.position=Oe.x+A+Oe.y,M._.fillpos=[Oe.x,Oe.y],k._preload(fe[1],function(){M._.fillsize=[this.offsetWidth,this.offsetHeight]})}else Zt.color=k.getRGB(y.fill).hex,Zt.src=Z,Zt.type="solid",k.getRGB(y.fill).error&&(E.type in{circle:1,ellipse:1}||"r"!=Ct(y.fill).charAt())&&gt(E,y.fill,Zt)&&(D.fill="none",D.gradient=y.fill,Zt.rotate=!1)}if("fill-opacity"in y||"opacity"in y){var Re=((+D["fill-opacity"]+1||2)-1)*((+D.opacity+1||2)-1)*((+k.getRGB(y.fill).o+1||2)-1);Re=Gt(Nt(Re,0),1),Zt.opacity=Re,Zt.src&&(Zt.color="none")}O.appendChild(Zt);var se=O.getElementsByTagName("stroke")&&O.getElementsByTagName("stroke")[0],cr=!1;!se&&(cr=se=W("stroke")),(y.stroke&&"none"!=y.stroke||y["stroke-width"]||null!=y["stroke-opacity"]||y["stroke-dasharray"]||y["stroke-miterlimit"]||y["stroke-linejoin"]||y["stroke-linecap"])&&(se.on=!0),("none"==y.stroke||null===y.stroke||null==se.on||0==y.stroke||0==y["stroke-width"])&&(se.on=!1);var ni=k.getRGB(y.stroke);se.on&&y.stroke&&(se.color=ni.hex),Re=((+D["stroke-opacity"]+1||2)-1)*((+D.opacity+1||2)-1)*((+ni.o+1||2)-1);var je=.75*(Et(y["stroke-width"])||1);if(Re=Gt(Nt(Re,0),1),null==y["stroke-width"]&&(je=D["stroke-width"]),y["stroke-width"]&&(se.weight=je),je&&1>je&&(Re*=je)&&(se.weight=1),se.opacity=Re,y["stroke-linejoin"]&&(se.joinstyle=y["stroke-linejoin"]||"miter"),se.miterlimit=y["stroke-miterlimit"]||8,y["stroke-linecap"]&&(se.endcap="butt"==y["stroke-linecap"]?"flat":"square"==y["stroke-linecap"]?"square":"round"),"stroke-dasharray"in y){var Er={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};se.dashstyle=Er[b](y["stroke-dasharray"])?Er[y["stroke-dasharray"]]:Z}cr&&O.appendChild(se)}if("text"==E.type){E.paper.canvas.style.display=Z;var Ve=E.paper.span,Le=D.font&&D.font.match(/\d+(?:\.\d*)?(?=px)/);H=Ve.style,D.font&&(H.font=D.font),D["font-family"]&&(H.fontFamily=D["font-family"]),D["font-weight"]&&(H.fontWeight=D["font-weight"]),D["font-style"]&&(H.fontStyle=D["font-style"]),Le=Et(D["font-size"]||Le&&Le[0])||10,H.fontSize=100*Le+"px",E.textpath.string&&(Ve.innerHTML=Ct(E.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var Qe=Ve.getBoundingClientRect();E.W=D.w=(Qe.right-Qe.left)/100,E.H=D.h=(Qe.bottom-Qe.top)/100,E.X=D.x,E.Y=D.y+E.H/2,("x"in y||"y"in y)&&(E.path.v=k.format("m{0},{1}l{2},{1}",Jt(D.x*at),Jt(D.y*at),Jt(D.x*at)+1));for(var oi=["x","y","text","font","font-family","font-weight","font-style","font-size"],be=0,Rr=oi.length;Rr>be;be++)if(oi[be]in y){E._.dirty=1;break}switch(D["text-anchor"]){case"start":E.textpath.style["v-text-align"]="left",E.bbx=E.W/2;break;case"end":E.textpath.style["v-text-align"]="right",E.bbx=-E.W/2;break;default:E.textpath.style["v-text-align"]="center",E.bbx=0}E.textpath.style["v-text-kern"]=!0}},gt=function(M,y,O){M.attrs=M.attrs||{};var D=Math.pow,H="linear",G=".5 .5";if(M.attrs.gradient=y,y=(y=Ct(y).replace(k._radial_gradient,function(Ut,_t,Bt){return H="radial",_t&&Bt&&(_t=Et(_t),Bt=Et(Bt),D(_t-.5,2)+D(Bt-.5,2)>.25&&(Bt=Vt.sqrt(.25-D(_t-.5,2))*(2*(Bt>.5)-1)+.5),G=_t+A+Bt),Z})).split(/\s*\-\s*/),"linear"==H){var X=y.shift();if(X=-Et(X),isNaN(X))return null}var E=k._parseDots(y);if(!E)return null;if(M=M.shape||M.node,E.length){M.removeChild(O),O.on=!0,O.method="none",O.color=E[0].color,O.color2=E[E.length-1].color;for(var ot=[],lt=0,St=E.length;St>lt;lt++)E[lt].offset&&ot.push(E[lt].offset+A+E[lt].color);O.colors=ot.length?ot.join():"0% "+O.color,"radial"==H?(O.type="gradientTitle",O.focus="100%",O.focussize="0 0",O.focusposition=G,O.angle=0):(O.type="gradient",O.angle=(270-X)%360),M.appendChild(O)}return 1},Rt=function(M,y){this[0]=this.node=M,M.raphael=!0,this.id=k._oid++,M.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=y,this.matrix=k.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!y.bottom&&(y.bottom=this),this.prev=y.top,y.top&&(y.top.next=this),y.top=this,this.next=null},x=k.el;Rt.prototype=x,x.constructor=Rt,x.transform=function(M){if(null==M)return this._.transform;var y,O=this.paper._viewBoxShift,D=O?"s"+[O.scale,O.scale]+"-1-1t"+[O.dx,O.dy]:Z;O&&(y=M=Ct(M).replace(/\.{3}|\u2026/g,this._.transform||Z)),k._extractTransform(this,D+M);var H,G=this.matrix.clone(),X=this.skew,E=this.node,ot=~Ct(this.attrs.fill).indexOf("-"),lt=!Ct(this.attrs.fill).indexOf("url(");if(G.translate(1,1),lt||ot||"image"==this.type)if(X.matrix="1 0 0 1",X.offset="0 0",H=G.split(),ot&&H.noRotation||!H.isSimple){E.style.filter=G.toFilter();var St=this.getBBox(),Ut=this.getBBox(1),_t=St.x-Ut.x,Bt=St.y-Ut.y;E.coordorigin=_t*-at+A+Bt*-at,xt(this,1,1,_t,Bt,0)}else E.style.filter=Z,xt(this,H.scalex,H.scaley,H.dx,H.dy,H.rotate);else E.style.filter=Z,X.matrix=Ct(G),X.offset=G.offset();return null!==y&&(this._.transform=y,k._extractTransform(this,y)),this},x.rotate=function(M,y,O){if(this.removed)return this;if(null!=M){if((M=Ct(M).split(g)).length-1&&(y=Et(M[1]),O=Et(M[2])),M=Et(M[0]),null==O&&(y=O),null==y||null==O){var D=this.getBBox(1);y=D.x+D.width/2,O=D.y+D.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",M,y,O]])),this}},x.translate=function(M,y){return this.removed||((M=Ct(M).split(g)).length-1&&(y=Et(M[1])),M=Et(M[0])||0,y=+y||0,this._.bbox&&(this._.bbox.x+=M,this._.bbox.y+=y),this.transform(this._.transform.concat([["t",M,y]]))),this},x.scale=function(M,y,O,D){if(this.removed)return this;if((M=Ct(M).split(g)).length-1&&(y=Et(M[1]),O=Et(M[2]),D=Et(M[3]),isNaN(O)&&(O=null),isNaN(D)&&(D=null)),M=Et(M[0]),null==y&&(y=M),null==D&&(O=D),null==O||null==D)var H=this.getBBox(1);return this.transform(this._.transform.concat([["s",M,y,O=null==O?H.x+H.width/2:O,D=null==D?H.y+H.height/2:D]])),this._.dirtyT=1,this},x.hide=function(){return!this.removed&&(this.node.style.display="none"),this},x.show=function(){return!this.removed&&(this.node.style.display=Z),this},x.auxGetBBox=k.el.getBBox,x.getBBox=function(){var M=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var y={},O=1/this.paper._viewBoxShift.scale;return y.x=M.x-this.paper._viewBoxShift.dx,y.x*=O,y.y=M.y-this.paper._viewBoxShift.dy,y.y*=O,y.width=M.width*O,y.height=M.height*O,y.x2=y.x+y.width,y.y2=y.y+y.height,y}return M},x._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},x.remove=function(){if(!this.removed&&this.node.parentNode){for(var M in this.paper.__set__&&this.paper.__set__.exclude(this),k.eve.unbind("raphael.*.*."+this.id),k._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape),this)this[M]="function"==typeof this[M]?k._removedFactory(M):null;this.removed=!0}},x.attr=function(M,y){if(this.removed)return this;if(null==M){var O={};for(var D in this.attrs)this.attrs[b](D)&&(O[D]=this.attrs[D]);return O.gradient&&"none"==O.fill&&(O.fill=O.gradient)&&delete O.gradient,O.transform=this._.transform,O}if(null==y&&k.is(M,"string")){if(M==p&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var H=M.split(g),G={},X=0,E=H.length;E>X;X++)G[M=H[X]]=M in this.attrs?this.attrs[M]:k.is(this.paper.customAttributes[M],"function")?this.paper.customAttributes[M].def:k._availableAttrs[M];return E-1?G:G[H[0]]}if(this.attrs&&null==y&&k.is(M,"array")){for(G={},X=0,E=M.length;E>X;X++)G[M[X]]=this.attr(M[X]);return G}var ot;for(var lt in null!=y&&((ot={})[M]=y),null==y&&k.is(M,"object")&&(ot=M),ot)T("raphael.attr."+lt+"."+this.id,this,ot[lt]);if(ot){for(lt in this.paper.customAttributes)if(this.paper.customAttributes[b](lt)&&ot[b](lt)&&k.is(this.paper.customAttributes[lt],"function")){var St=this.paper.customAttributes[lt].apply(this,[].concat(ot[lt]));for(var Ut in this.attrs[lt]=ot[lt],St)St[b](Ut)&&(ot[Ut]=St[Ut])}ot.text&&"text"==this.type&&(this.textpath.string=ot.text),Xt(this,ot)}return this},x.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&k._tofront(this,this.paper),this},x.toBack=function(){return this.removed||this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),k._toback(this,this.paper)),this},x.insertAfter=function(M){return this.removed||(M.constructor==k.st.constructor&&(M=M[M.length-1]),M.node.nextSibling?M.node.parentNode.insertBefore(this.node,M.node.nextSibling):M.node.parentNode.appendChild(this.node),k._insertafter(this,M,this.paper)),this},x.insertBefore=function(M){return this.removed||(M.constructor==k.st.constructor&&(M=M[0]),M.node.parentNode.insertBefore(this.node,M.node),k._insertbefore(this,M,this.paper)),this},x.blur=function(M){var y=this.node.runtimeStyle,O=y.filter;return O=O.replace(dt,Z),0!=+M?(this.attrs.blur=M,y.filter=O+A+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+M||1.5)+")",y.margin=k.format("-{0}px 0 0 -{0}px",Jt(+M||1.5))):(y.filter=O,y.margin=0,delete this.attrs.blur),this},k._engine.path=function(M,y){var O=W("shape");O.style.cssText=mt,O.coordsize=at+A+at,O.coordorigin=y.coordorigin;var D=new Rt(O,y),H={fill:"none",stroke:"#000"};M&&(H.path=M),D.type="path",D.path=[],D.Path=Z,Xt(D,H),y.canvas.appendChild(O);var G=W("skew");return G.on=!0,O.appendChild(G),D.skew=G,D.transform(Z),D},k._engine.rect=function(M,y,O,D,H,G){var X=k._rectPath(y,O,D,H,G),E=M.path(X),ot=E.attrs;return E.X=ot.x=y,E.Y=ot.y=O,E.W=ot.width=D,E.H=ot.height=H,ot.r=G,ot.path=X,E.type="rect",E},k._engine.ellipse=function(M,y,O,D,H){var G=M.path();return G.X=y-D,G.Y=O-H,G.W=2*D,G.H=2*H,G.type="ellipse",Xt(G,{cx:y,cy:O,rx:D,ry:H}),G},k._engine.circle=function(M,y,O,D){var H=M.path();return H.X=y-D,H.Y=O-D,H.W=H.H=2*D,H.type="circle",Xt(H,{cx:y,cy:O,r:D}),H},k._engine.image=function(M,y,O,D,H,G){var X=k._rectPath(O,D,H,G),E=M.path(X).attr({stroke:"none"}),ot=E.attrs,lt=E.node,St=lt.getElementsByTagName(p)[0];return ot.src=y,E.X=ot.x=O,E.Y=ot.y=D,E.W=ot.width=H,E.H=ot.height=G,ot.path=X,E.type="image",St.parentNode==lt&&lt.removeChild(St),St.rotate=!0,St.src=y,St.type="tile",E._.fillpos=[O,D],E._.fillsize=[H,G],lt.appendChild(St),xt(E,1,1,0,0,0),E},k._engine.text=function(M,y,O,D){var H=W("shape"),G=W("path"),X=W("textpath");O=O||0,D=D||"",G.v=k.format("m{0},{1}l{2},{1}",Jt((y=y||0)*at),Jt(O*at),Jt(y*at)+1),G.textpathok=!0,X.string=Ct(D),X.on=!0,H.style.cssText=mt,H.coordsize=at+A+at,H.coordorigin="0 0";var E=new Rt(H,M),ot={fill:"#000",stroke:"none",font:k._availableAttrs.font,text:D};E.shape=H,E.path=G,E.textpath=X,E.type="text",E.attrs.text=Ct(D),E.attrs.x=y,E.attrs.y=O,E.attrs.w=1,E.attrs.h=1,Xt(E,ot),H.appendChild(X),H.appendChild(G),M.canvas.appendChild(H);var lt=W("skew");return lt.on=!0,H.appendChild(lt),E.skew=lt,E.transform(Z),E},k._engine.setSize=function(M,y){var O=this.canvas.style;return this.width=M,this.height=y,M==+M&&(M+="px"),y==+y&&(y+="px"),O.width=M,O.height=y,O.clip="rect(0 "+M+" "+y+" 0)",this._viewBox&&k._engine.setViewBox.apply(this,this._viewBox),this},k._engine.setViewBox=function(M,y,O,D,H){k.eve("raphael.setViewBox",this,this._viewBox,[M,y,O,D,H]);var G,X,E=this.getSize(),ot=E.width,lt=E.height;return H&&(ot>O*(G=lt/D)&&(M-=(ot-O*G)/2/G),lt>D*(X=ot/O)&&(y-=(lt-D*X)/2/X)),this._viewBox=[M,y,O,D,!!H],this._viewBoxShift={dx:-M,dy:-y,scale:E},this.forEach(function(St){St.transform("...")}),this},k._engine.initWin=function(M){var y=M.document;y.styleSheets.length<31?y.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):y.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!y.namespaces.rvml&&y.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),W=function(O){return y.createElement("<rvml:"+O+' class="rvml">')}}catch(O){W=function(D){return y.createElement("<"+D+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},k._engine.initWin(k._g.win),k._engine.create=function(){var M=k._getContainer.apply(0,arguments),y=M.container,O=M.height,D=M.width,H=M.x,G=M.y;if(!y)throw new Error("VML container not found.");var X=new k._Paper,E=X.canvas=k._g.doc.createElement("div"),ot=E.style;return H=H||0,G=G||0,O=O||342,X.width=D=D||512,X.height=O,D==+D&&(D+="px"),O==+O&&(O+="px"),X.coordsize=1e3*at+A+1e3*at,X.coordorigin="0 0",X.span=k._g.doc.createElement("span"),X.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",E.appendChild(X.span),ot.cssText=k.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",D,O),1==y?(k._g.doc.body.appendChild(E),ot.left=H+"px",ot.top=G+"px",ot.position="absolute"):y.firstChild?y.insertBefore(E,y.firstChild):y.appendChild(E),X.renderfix=function(){},X},k.prototype.clear=function(){k.eve("raphael.clear",this),this.canvas.innerHTML=Z,this.span=k._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},k.prototype.remove=function(){for(var M in k.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas),this)this[M]="function"==typeof this[M]?k._removedFactory(M):null;return!0};var P=k.st;for(var U in x)x[b](U)&&!P[b](U)&&(P[U]=function(M){return function(){var y=arguments;return this.forEach(function(O){O[M].apply(O,y)})}}(U))}}),function(k,b){if("function"==typeof define&&define.amd)define("raphael",["raphael.core","raphael.svg","raphael.vml"],function(Et){return k.Raphael=b(Et)});else if("object"==typeof exports){var Ct=require("raphael.core");require("raphael.svg"),require("raphael.vml"),module.exports=b(Ct)}else k.Raphael=b(k.Raphael)}(this,function(k){return k.ninja()}),function(){String.prototype.startsWith||(String.prototype.startsWith=function(p,g){return this.substr(g||0,p.length)===p});var k=null,b={inheritAttrs:function(p,g){for(var T in g)g.hasOwnProperty(T)&&(p[T]instanceof Object&&g[T]instanceof Object&&"function"!=typeof g[T]?this.inheritAttrs(p[T],g[T]):p[T]=g[T]);return p},createMerge:function(p,g){var T={};return p&&this.inheritAttrs(T,this.cloneObj(p)),g&&this.inheritAttrs(T,g),T},extend:function(){return k?(Array.prototype.unshift.apply(arguments,[!0,{}]),k.extend.apply(k,arguments)):b.createMerge.apply(this,arguments)},cloneObj:function(p){if(Object(p)!==p)return p;var g=new p.constructor;for(var T in p)p.hasOwnProperty(T)&&(g[T]=this.cloneObj(p[T]));return g},addEvent:function(p,g,T){k?k(p).on(g+".treant",T):p.addEventListener?p.addEventListener(g,T,!1):p.attachEvent?p.attachEvent("on"+g,T):p["on"+g]=T},findEl:function(p,g,T){if(T=T||document,k){var _=k(p,T);return g?_.get(0):_}if("#"===p.charAt(0))return T.getElementById(p.substring(1));if("."===p.charAt(0)){var A=T.getElementsByClassName(p.substring(1));return A.length?A[0]:null}throw new Error("Unknown container element")},getOuterHeight:function(p){return"function"==typeof p.getBoundingClientRect?p.getBoundingClientRect().height:k?Math.ceil(k(p).outerHeight())+1:Math.ceil(p.clientHeight+b.getStyle(p,"border-top-width",!0)+b.getStyle(p,"border-bottom-width",!0)+b.getStyle(p,"padding-top",!0)+b.getStyle(p,"padding-bottom",!0)+1)},getOuterWidth:function(p){return"function"==typeof p.getBoundingClientRect?p.getBoundingClientRect().width:k?Math.ceil(k(p).outerWidth())+1:Math.ceil(p.clientWidth+b.getStyle(p,"border-left-width",!0)+b.getStyle(p,"border-right-width",!0)+b.getStyle(p,"padding-left",!0)+b.getStyle(p,"padding-right",!0)+1)},getStyle:function(p,g,T){var _="";return document.defaultView&&document.defaultView.getComputedStyle?_=document.defaultView.getComputedStyle(p,"").getPropertyValue(g):p.currentStyle&&(g=g.replace(/\-(\w)/g,function(A,Z){return Z.toUpperCase()}),_=p.currentStyle[g]),T?parseFloat(_):_},addClass:function(p,g){k?k(p).addClass(g):b.hasClass(p,g)||(p.classList?p.classList.add(g):p.className+=" "+g)},hasClass:function(p,g){return(" "+p.className+" ").replace(/[\n\t]/g," ").indexOf(" "+g+" ")>-1},toggleClass:function(p,g,T){k?k(p).toggleClass(g,T):T?p.classList.add(g):p.classList.remove(g)},setDimensions:function(p,g,T){k?k(p).width(g).height(T):(p.style.width=g+"px",p.style.height=T+"px")},isjQueryAvailable:function(){return void 0!==k&&k}},Ct=function(){this.reset()};Ct.prototype={reset:function(){return this.loading=[],this},processNode:function(p){for(var g=p.nodeDOM.getElementsByTagName("img"),T=g.length;T--;)this.create(p,g[T]);return this},removeAll:function(p){for(var g=this.loading.length;g--;)this.loading[g]===p&&this.loading.splice(g,1);return this},create:function(p,g){var T=this,_=g.src;function A(){T.removeAll(_),p.width=p.nodeDOM.offsetWidth,p.height=p.nodeDOM.offsetHeight}if(0!==g.src.indexOf("data:")){if(this.loading.push(_),g.complete)return A();b.addEvent(g,"load",A),b.addEvent(g,"error",A),g.src+=(g.src.indexOf("?")>0?"&":"?")+(new Date).getTime()}else A()},isNotLoading:function(){return 0===this.loading.length}};var Et={store:[],createTree:function(p){var g=this.store.length;return this.store.push(new Vt(p,g)),this.get(g)},get:function(p){return this.store[p]},destroy:function(p){var g=this.get(p);if(g){g._R.remove();for(var T=g.drawArea;T.firstChild;)T.removeChild(T.firstChild);for(var _=T.className.split(" "),A=[],Z=0;Z<_.length;Z++){var $=_[Z];"Treant"!==$&&"Treant-loaded"!==$&&A.push($)}T.style.overflowY="",T.style.overflowX="",T.className=A.join(" "),this.store[p]=null}return this}},Vt=function(p,g){this.reset=function(T,_){if(this.initJsonConfig=T,this.initTreeId=_,this.id=_,this.CONFIG=b.extend(Vt.CONFIG,T.chart),this.drawArea=b.findEl(this.CONFIG.container,!0),!this.drawArea)throw new Error('Failed to find element by selector "'+this.CONFIG.container+'"');return b.addClass(this.drawArea,"Treant"),this.drawArea.innerHTML="",this.imageLoader=new Ct,this.nodeDB=new Jt(T.nodeStructure,this),this.connectionStore={},this.loaded=!1,this._R=new Raphael(this.drawArea,100,100),this},this.reload=function(){return this.reset(this.initJsonConfig,this.initTreeId).redraw(),this},this.reset(p,g)};Vt.prototype={getNodeDb:function(){return this.nodeDB},addNode:function(p,g){this.CONFIG.callback.onBeforeAddNode.apply(this,[p,g]);var T=this.nodeDB.createNode(g,p.id,this);return T.createGeometry(this),T.parent().createSwitchGeometry(this),this.positionTree(),this.CONFIG.callback.onAfterAddNode.apply(this,[T,p,g]),T},redraw:function(){return this.positionTree(),this},positionTree:function(p){var g=this;if(this.imageLoader.isNotLoading()){var T=this.root();this.resetLevelData(),this.firstWalk(T,0),this.secondWalk(T,0,0,0),this.positionNodes(),this.CONFIG.animateOnInit&&setTimeout(function(){T.toggleCollapse()},this.CONFIG.animateOnInitDelay),this.loaded||(b.addClass(this.drawArea,"Treant-loaded"),"[object Function]"===Object.prototype.toString.call(p)&&p(g),g.CONFIG.callback.onTreeLoaded.apply(g,[T]),this.loaded=!0)}else setTimeout(function(){g.positionTree(p)},10);return this},firstWalk:function(p,g){p.prelim=null,p.modifier=null,this.setNeighbors(p,g),this.calcLevelDim(p,g);var T=p.leftSibling();if(0===p.childrenCount()||g==this.CONFIG.maxDepth)p.prelim=T?T.prelim+T.size()+this.CONFIG.siblingSeparation:0;else{for(var _=0,A=p.childrenCount();_<A;_++)this.firstWalk(p.childAt(_),g+1);var Z=p.childrenCenter()-p.size()/2;T?(p.prelim=T.prelim+T.size()+this.CONFIG.siblingSeparation,p.modifier=p.prelim-Z,this.apportion(p,g)):p.prelim=Z,p.stackParent?p.modifier+=this.nodeDB.get(p.stackChildren[0]).size()/2+p.connStyle.stackIndent:p.stackParentId&&(p.prelim=0)}return this},apportion:function(p,g){for(var T=p.firstChild(),_=T.leftNeighbor(),A=1,Z=this.CONFIG.maxDepth-g;T&&_&&A<=Z;){for(var $=0,R=0,dt=_,vt=T,mt=0;mt<A;mt++)dt=dt.parent(),vt=vt.parent(),R+=dt.modifier,$+=vt.modifier,void 0!==vt.stackParent&&($+=vt.size()/2);var at=_.prelim+R+_.size()+this.CONFIG.subTeeSeparation-(T.prelim+$);if(at>0){for(var ft=p,It=0;ft&&ft.id!==dt.id;)ft=ft.leftSibling(),It++;if(ft)for(var qt=p,Wt=at/It;qt.id!==dt.id;)qt.prelim+=at,qt.modifier+=at,at-=Wt,qt=qt.leftSibling()}A++,(T=0===T.childrenCount()?p.leftMost(0,A):T=T.firstChild())&&(_=T.leftNeighbor())}},secondWalk:function(p,g,T,_){if(!(g>this.CONFIG.maxDepth)){var dt,vt,A=p.prelim+T,Z=_,$=this.CONFIG.nodeAlign,R=this.CONFIG.rootOrientation;if("NORTH"===R||"SOUTH"===R?(dt=this.levelMaxDim[g].height,vt=p.height,p.pseudo&&(p.height=dt)):("WEST"===R||"EAST"===R)&&(dt=this.levelMaxDim[g].width,vt=p.width,p.pseudo&&(p.width=dt)),p.X=A,p.pseudo?"NORTH"===R||"WEST"===R?p.Y=Z:("SOUTH"===R||"EAST"===R)&&(p.Y=Z+(dt-vt)):p.Y="CENTER"===$?Z+(dt-vt)/2:"TOP"===$?Z+(dt-vt):Z,"WEST"===R||"EAST"===R){var mt=p.X;p.X=p.Y,p.Y=mt}"SOUTH"===R?p.Y=-p.Y-vt:"EAST"===R&&(p.X=-p.X-vt),0!==p.childrenCount()&&this.secondWalk(p.firstChild(),g+1,T+p.modifier,0===p.id&&this.CONFIG.hideRootNode?_:_+dt+this.CONFIG.levelSeparation),p.rightSibling()&&this.secondWalk(p.rightSibling(),g,T,_)}},positionNodes:function(){var p=this,g={x:p.nodeDB.getMinMaxCoord("X",null,null),y:p.nodeDB.getMinMaxCoord("Y",null,null)},T=g.x.max-g.x.min,_=g.y.max-g.y.min,A={x:g.x.max-T/2,y:g.y.max-_/2};this.handleOverflow(T,_);var mt,at,ft,Z={x:p.drawArea.clientWidth/2,y:p.drawArea.clientHeight/2},$=Z.x-A.x,R=Z.y-A.y,dt=g.x.min+$<=0?Math.abs(g.x.min):0,vt=g.y.min+R<=0?Math.abs(g.y.min):0;for(mt=0,at=this.nodeDB.db.length;mt<at;mt++)if(ft=this.nodeDB.get(mt),p.CONFIG.callback.onBeforePositionNode.apply(p,[ft,mt,Z,A]),0===ft.id&&this.CONFIG.hideRootNode)p.CONFIG.callback.onAfterPositionNode.apply(p,[ft,mt,Z,A]);else{ft.X+=dt+(T<this.drawArea.clientWidth?$:this.CONFIG.padding),ft.Y+=vt+(_<this.drawArea.clientHeight?R:this.CONFIG.padding);var It=ft.collapsedParent(),qt=null;It?(qt=It.connectorPoint(!0),ft.hide(qt)):ft.positioned?ft.show():(ft.nodeDOM.style.left=ft.X+"px",ft.nodeDOM.style.top=ft.Y+"px",ft.positioned=!0),0===ft.id||0===ft.parent().id&&this.CONFIG.hideRootNode?!this.CONFIG.hideRootNode&&ft.drawLineThrough&&ft.drawLineThroughMe():this.setConnectionToParent(ft,qt),p.CONFIG.callback.onAfterPositionNode.apply(p,[ft,mt,Z,A])}return this},handleOverflow:function(p,g){var T=p<this.drawArea.clientWidth?this.drawArea.clientWidth:p+2*this.CONFIG.padding,_=g<this.drawArea.clientHeight?this.drawArea.clientHeight:g+2*this.CONFIG.padding;if(this._R.setSize(T,_),"resize"===this.CONFIG.scrollbar)b.setDimensions(this.drawArea,T,_);else if(b.isjQueryAvailable()&&"native"!==this.CONFIG.scrollbar){if("fancy"===this.CONFIG.scrollbar){var A=k(this.drawArea);if(A.hasClass("ps-container"))A.find(".Treant").css({width:T,height:_}),A.perfectScrollbar("update");else{var Z=A.wrapInner('<div class="Treant"/>');Z.find(".Treant").css({width:T,height:_}),Z.perfectScrollbar()}}}else this.drawArea.clientWidth<p&&(this.drawArea.style.overflowX="auto"),this.drawArea.clientHeight<g&&(this.drawArea.style.overflowY="auto");return this},setConnectionToParent:function(p,g){var _,T=p.stackParentId,A=T?this.nodeDB.get(T):p.parent(),Z=g?this.getPointPathString(g):this.getPathString(A,p,T);return this.connectionStore[p.id]?this.animatePath(_=this.connectionStore[p.id],Z):(_=this._R.path(Z),this.connectionStore[p.id]=_,p.pseudo&&delete A.connStyle.style["arrow-end"],A.pseudo&&delete A.connStyle.style["arrow-start"],_.attr(A.connStyle.style),(p.drawLineThrough||p.pseudo)&&p.drawLineThroughMe(g)),p.connector=_,this},getPointPathString:function(p){return["_M",p.x,",",p.y,"L",p.x,",",p.y,p.x,",",p.y].join(" ")},animatePath:function(p,g){return p.hidden&&"_"!==g.charAt(0)&&(p.show(),p.hidden=!1),p.animate({path:"_"===g.charAt(0)?g.substring(1):g},this.CONFIG.animation.connectorsSpeed,this.CONFIG.animation.connectorsAnimation,function(){"_"===g.charAt(0)&&(p.hide(),p.hidden=!0)}),this},getPathString:function(p,g,T){var _=p.connectorPoint(!0),A=g.connectorPoint(!1),Z=this.CONFIG.rootOrientation,$=p.connStyle.type,R={},dt={};"NORTH"===Z||"SOUTH"===Z?(R.y=dt.y=(_.y+A.y)/2,R.x=_.x,dt.x=A.x):("EAST"===Z||"WEST"===Z)&&(R.x=dt.x=(_.x+A.x)/2,R.y=_.y,dt.y=A.y);var qt,Wt,vt=_.x+","+_.y,mt=R.x+","+R.y,at=dt.x+","+dt.y,ft=A.x+","+A.y;if(T){if(Wt="EAST"===Z||"WEST"===Z?A.x+","+_.y:_.x+","+A.y,"step"===$||"straight"===$)qt=["M",vt,"L",Wt,"L",ft];else if("curve"===$||"bCurve"===$){var xt,ee=p.connStyle.stackIndent;"NORTH"===Z?xt=A.x-ee+","+(A.y-ee):"SOUTH"===Z?xt=A.x-ee+","+(A.y+ee):"EAST"===Z?xt=A.x+ee+","+_.y:"WEST"===Z&&(xt=A.x-ee+","+_.y),qt=["M",vt,"L",xt,"S",Wt,ft]}}else"step"===$?qt=["M",vt,"L",mt,"L",at,"L",ft]:"curve"===$?qt=["M",vt,"C",mt,at,ft]:"bCurve"===$?qt=["M",vt,"Q",mt,(R.x+dt.x)/2+","+(R.y+dt.y)/2,"T",ft]:"straight"===$&&(qt=["M",vt,"L",vt,ft]);return qt.join(" ")},setNeighbors:function(p,g){return p.leftNeighborId=this.lastNodeOnLevel[g],p.leftNeighborId&&(p.leftNeighbor().rightNeighborId=p.id),this.lastNodeOnLevel[g]=p.id,this},calcLevelDim:function(p,g){return this.levelMaxDim[g]={width:Math.max(this.levelMaxDim[g]?this.levelMaxDim[g].width:0,p.width),height:Math.max(this.levelMaxDim[g]?this.levelMaxDim[g].height:0,p.height)},this},resetLevelData:function(){return this.lastNodeOnLevel=[],this.levelMaxDim=[],this},root:function(){return this.nodeDB.get(0)}};var Jt=function(p,g){this.reset(p,g)};Jt.prototype={reset:function(p,g){this.db=[];var T=this;return g.CONFIG.animateOnInit&&(p.collapsed=!0),function _(A,Z){var $=T.createNode(A,Z,g,null);if(A.children){if(A.childrenDropLevel&&A.childrenDropLevel>0)for(;A.childrenDropLevel--;){var R=b.cloneObj($.connStyle);($=T.createNode("pseudo",$.id,g,null)).connStyle=R,$.children=[]}var dt=A.stackChildren&&!T.hasGrandChildren(A)?$.id:null;null!==dt&&($.stackChildren=[]);for(var vt=0,mt=A.children.length;vt<mt;vt++)null!==dt?($=T.createNode(A.children[vt],$.id,g,dt),vt+1<mt&&($.children=[])):_(A.children[vt],$.id)}}(p,-1),this.createGeometries(g),this},createGeometries:function(p){for(var g=this.db.length;g--;)this.get(g).createGeometry(p);return this},get:function(p){return this.db[p]},walk:function(p){for(var g=this.db.length;g--;)p.apply(this,[this.get(g)]);return this},createNode:function(p,g,T,_){var A=new Nt(p,this.db.length,g,T,_);if(this.db.push(A),g>=0){var Z=this.get(g);if(p.position)if("left"===p.position)Z.children.push(A.id);else if("right"===p.position)Z.children.splice(0,0,A.id);else if("center"===p.position)Z.children.splice(Math.floor(Z.children.length/2),0,A.id);else{var $=parseInt(p.position);Z.children.splice(1===Z.children.length&&$>0?0:Math.max($,Z.children.length-1),0,A.id)}else Z.children.push(A.id)}return _&&(this.get(_).stackParent=!0,this.get(_).stackChildren.push(A.id)),A},getMinMaxCoord:function(p,g,T){g=g||this.get(0),T=T||{min:g[p],max:g[p]+("X"===p?g.width:g.height)};for(var _=g.childrenCount();_--;){var A=g.childAt(_),Z=A[p]+("X"===p?A.width:A.height),$=A[p];Z>T.max&&(T.max=Z),$<T.min&&(T.min=$),this.getMinMaxCoord(p,A,T)}return T},hasGrandChildren:function(p){for(var g=p.children.length;g--;)if(p.children[g].children&&p.children[g].children.length>0)return!0;return!1}};var Nt=function(p,g,T,_,A){this.reset(p,g,T,_,A)};Nt.prototype={reset:function(p,g,T,_,A){return this.id=g,this.parentId=T,this.treeId=_.id,this.prelim=0,this.modifier=0,this.leftNeighborId=null,this.stackParentId=A,this.pseudo="pseudo"===p||p.pseudo,this.meta=p.meta||{},this.image=p.image||null,this.link=b.createMerge(_.CONFIG.node.link,p.link),this.connStyle=b.createMerge(_.CONFIG.connectors,p.connectors),this.connector=null,this.drawLineThrough=!1!==p.drawLineThrough&&(p.drawLineThrough||_.CONFIG.node.drawLineThrough),this.collapsable=!1!==p.collapsable&&(p.collapsable||_.CONFIG.node.collapsable),this.collapsed=p.collapsed,this.text=p.text,this.nodeInnerHTML=p.innerHTML,this.nodeHTMLclass=(_.CONFIG.node.HTMLclass?_.CONFIG.node.HTMLclass:"")+(p.HTMLclass?" "+p.HTMLclass:""),this.nodeHTMLid=p.HTMLid,this.children=[],this},getTree:function(){return Et.get(this.treeId)},getTreeConfig:function(){return this.getTree().CONFIG},getTreeNodeDb:function(){return this.getTree().getNodeDb()},lookupNode:function(p){return this.getTreeNodeDb().get(p)},Tree:function(){return Et.get(this.treeId)},dbGet:function(p){return this.getTreeNodeDb().get(p)},size:function(){var p=this.getTreeConfig().rootOrientation;return this.pseudo?-this.getTreeConfig().subTeeSeparation:"NORTH"===p||"SOUTH"===p?this.width:"WEST"===p||"EAST"===p?this.height:void 0},childrenCount:function(){return this.collapsed||!this.children?0:this.children.length},childAt:function(p){return this.dbGet(this.children[p])},firstChild:function(){return this.childAt(0)},lastChild:function(){return this.childAt(this.children.length-1)},parent:function(){return this.lookupNode(this.parentId)},leftNeighbor:function(){if(this.leftNeighborId)return this.lookupNode(this.leftNeighborId)},rightNeighbor:function(){if(this.rightNeighborId)return this.lookupNode(this.rightNeighborId)},leftSibling:function(){var p=this.leftNeighbor();if(p&&p.parentId===this.parentId)return p},rightSibling:function(){var p=this.rightNeighbor();if(p&&p.parentId===this.parentId)return p},childrenCenter:function(){var p=this.firstChild(),g=this.lastChild();return p.prelim+(g.prelim-p.prelim+g.size())/2},collapsedParent:function(){var p=this.parent();return!!p&&(p.collapsed?p:p.collapsedParent())},leftMost:function(p,g){if(p>=g)return this;if(0!==this.childrenCount())for(var T=0,_=this.childrenCount();T<_;T++){var A=this.childAt(T).leftMost(p+1,g);if(A)return A}},connectorPoint:function(p){var g=this.Tree().CONFIG.rootOrientation,T={};return this.stackParentId&&("NORTH"===g||"SOUTH"===g?g="WEST":("EAST"===g||"WEST"===g)&&(g="NORTH")),"NORTH"===g?(T.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,T.y=p?this.Y+this.height:this.Y):"SOUTH"===g?(T.x=this.pseudo?this.X-this.Tree().CONFIG.subTeeSeparation/2:this.X+this.width/2,T.y=p?this.Y:this.Y+this.height):"EAST"===g?(T.x=p?this.X:this.X+this.width,T.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2):"WEST"===g&&(T.x=p?this.X+this.width:this.X,T.y=this.pseudo?this.Y-this.Tree().CONFIG.subTeeSeparation/2:this.Y+this.height/2),T},pathStringThrough:function(){var p=this.connectorPoint(!0),g=this.connectorPoint(!1);return["M",p.x+","+p.y,"L",g.x+","+g.y].join(" ")},drawLineThroughMe:function(p){var g=p?this.Tree().getPointPathString(p):this.pathStringThrough();this.lineThroughMe=this.lineThroughMe||this.Tree()._R.path(g);var T=b.cloneObj(this.connStyle.style);delete T["arrow-start"],delete T["arrow-end"],this.lineThroughMe.attr(T),p&&(this.lineThroughMe.hide(),this.lineThroughMe.hidden=!0)},addSwitchEvent:function(p){var g=this;b.addEvent(p,"click",function(T){if(T.preventDefault(),!1===g.getTreeConfig().callback.onBeforeClickCollapseSwitch.apply(g,[p,T]))return!1;g.toggleCollapse(),g.getTreeConfig().callback.onAfterClickCollapseSwitch.apply(g,[p,T])})},collapse:function(){return this.collapsed||this.toggleCollapse(),this},expand:function(){return this.collapsed&&this.toggleCollapse(),this},toggleCollapse:function(){var p=this.getTree();if(!p.inAnimation){p.inAnimation=!0,this.collapsed=!this.collapsed,b.toggleClass(this.nodeDOM,"collapsed",this.collapsed),p.positionTree();var g=this;setTimeout(function(){p.inAnimation=!1,p.CONFIG.callback.onToggleCollapseFinished.apply(p,[g,g.collapsed])},p.CONFIG.animation.nodeSpeed>p.CONFIG.animation.connectorsSpeed?p.CONFIG.animation.nodeSpeed:p.CONFIG.animation.connectorsSpeed)}return this},hide:function(p){p=p||!1;var g=this.hidden;this.hidden=!0,this.nodeDOM.style.overflow="hidden";var T=this.getTree(),_=this.getTreeConfig(),A={opacity:0};if(p&&(A.left=p.x,A.top=p.y),!this.positioned||g?(this.nodeDOM.style.visibility="hidden",k?k(this.nodeDOM).css(A):(this.nodeDOM.style.left=A.left+"px",this.nodeDOM.style.top=A.top+"px"),this.positioned=!0):k?k(this.nodeDOM).animate(A,_.animation.nodeSpeed,_.animation.nodeAnimation,function(){this.style.visibility="hidden"}):(this.nodeDOM.style.transition="all "+_.animation.nodeSpeed+"ms ease",this.nodeDOM.style.transitionProperty="opacity, left, top",this.nodeDOM.style.opacity=A.opacity,this.nodeDOM.style.left=A.left+"px",this.nodeDOM.style.top=A.top+"px",this.nodeDOM.style.visibility="hidden"),this.lineThroughMe){var Z=T.getPointPathString(p);g?this.lineThroughMe.attr({path:Z}):T.animatePath(this.lineThroughMe,T.getPointPathString(p))}return this},hideConnector:function(){var p=this.Tree(),g=p.connectionStore[this.id];return g&&g.animate({opacity:0},p.CONFIG.animation.connectorsSpeed,p.CONFIG.animation.connectorsAnimation),this},show:function(){this.hidden=!1,this.nodeDOM.style.visibility="visible",this.Tree();var g={left:this.X,top:this.Y,opacity:1},T=this.getTreeConfig();return k?k(this.nodeDOM).animate(g,T.animation.nodeSpeed,T.animation.nodeAnimation,function(){this.style.overflow=""}):(this.nodeDOM.style.transition="all "+T.animation.nodeSpeed+"ms ease",this.nodeDOM.style.transitionProperty="opacity, left, top",this.nodeDOM.style.left=g.left+"px",this.nodeDOM.style.top=g.top+"px",this.nodeDOM.style.opacity=g.opacity,this.nodeDOM.style.overflow=""),this.lineThroughMe&&this.getTree().animatePath(this.lineThroughMe,this.pathStringThrough()),this},showConnector:function(){var p=this.Tree(),g=p.connectionStore[this.id];return g&&g.animate({opacity:1},p.CONFIG.animation.connectorsSpeed,p.CONFIG.animation.connectorsAnimation),this}},Nt.prototype.buildNodeFromText=function(p){if(this.image&&(image=document.createElement("img"),image.src=this.image,p.appendChild(image)),this.text)for(var g in this.text)if(g.startsWith("data-"))p.setAttribute(g,this.text[g]);else{var T=document.createElement(this.text[g].href?"a":"p");this.text[g].href&&(T.href=this.text[g].href,this.text[g].target&&(T.target=this.text[g].target)),T.className="node-"+g,T.appendChild(document.createTextNode(this.text[g].val?this.text[g].val:this.text[g]instanceof Object?"'val' param missing!":this.text[g])),p.appendChild(T)}return p},Nt.prototype.buildNodeFromHtml=function(p){if("#"===this.nodeInnerHTML.charAt(0)){var g=document.getElementById(this.nodeInnerHTML.substring(1));g?((p=g.cloneNode(!0)).id+="-clone",p.className+=" node"):p.innerHTML="<b> Wrong ID selector </b>"}else p.innerHTML=this.nodeInnerHTML;return p},Nt.prototype.createGeometry=function(p){if(0===this.id&&p.CONFIG.hideRootNode)return this.width=0,void(this.height=0);var g=p.drawArea,_=document.createElement(this.link.href?"a":"div");_.className=this.pseudo?"pseudo":Nt.CONFIG.nodeHTMLclass,this.nodeHTMLclass&&!this.pseudo&&(_.className+=" "+this.nodeHTMLclass),this.nodeHTMLid&&(_.id=this.nodeHTMLid),this.link.href&&(_.href=this.link.href,_.target=this.link.target),k?k(_).data("treenode",this):_.data={treenode:this},this.pseudo||(_=this.nodeInnerHTML?this.buildNodeFromHtml(_):this.buildNodeFromText(_),(this.collapsed||this.collapsable&&this.childrenCount()&&!this.stackParentId)&&this.createSwitchGeometry(p,_)),p.CONFIG.callback.onCreateNode.apply(p,[this,_]),g.appendChild(_),this.width=_.offsetWidth,this.height=_.offsetHeight,this.nodeDOM=_,p.imageLoader.processNode(this)},Nt.prototype.createSwitchGeometry=function(p,g){var T=b.findEl(".collapse-switch",!0,g=g||this.nodeDOM);return T||((T=document.createElement("a")).className="collapse-switch",g.appendChild(T),this.addSwitchEvent(T),this.collapsed&&(g.className+=" collapsed"),p.CONFIG.callback.onCreateNodeCollapseSwitch.apply(p,[this,g,T])),T},Vt.CONFIG={maxDepth:100,rootOrientation:"NORTH",nodeAlign:"CENTER",levelSeparation:30,siblingSeparation:30,subTeeSeparation:30,hideRootNode:!1,animateOnInit:!1,animateOnInitDelay:500,padding:15,scrollbar:"native",connectors:{type:"curve",style:{stroke:"black"},stackIndent:15},node:{link:{target:"_self"}},animation:{nodeSpeed:450,nodeAnimation:"linear",connectorsSpeed:450,connectorsAnimation:"linear"},callback:{onCreateNode:function(p,g){},onCreateNodeCollapseSwitch:function(p,g,T){},onAfterAddNode:function(p,g,T){},onBeforeAddNode:function(p,g){},onAfterPositionNode:function(p,g,T,_){},onBeforePositionNode:function(p,g,T,_){},onToggleCollapseFinished:function(p,g){},onAfterClickCollapseSwitch:function(p,g){},onBeforeClickCollapseSwitch:function(p,g){},onTreeLoaded:function(p){}}},Nt.CONFIG={nodeHTMLclass:"node"};var p,Gt={make:function(p){var T,g=p.length;for(this.jsonStructure={chart:null,nodeStructure:null};g--;)(T=p[g]).hasOwnProperty("container")?this.jsonStructure.chart=T:!T.hasOwnProperty("parent")&&!T.hasOwnProperty("container")&&(this.jsonStructure.nodeStructure=T,T._json_id=0);return this.findChildren(p),this.jsonStructure},findChildren:function(p){for(var g=[0];g.length;){for(var T=g.pop(),_=this.findNode(this.jsonStructure.nodeStructure,T),A=0,Z=p.length,$=[];A<Z;A++){var R=p[A];R.parent&&R.parent._json_id===T&&(R._json_id=this.getID(),delete R.parent,$.push(R),g.push(R._json_id))}$.length&&(_.children=$)}},findNode:function(p,g){var T,_;if(p._json_id===g)return p;if(p.children)for(T=p.children.length;T--;)if(_=this.findNode(p.children[T],g))return _},getID:(p=1,function(){return p++})},zt=function(p,g,T){p instanceof Array&&(p=Gt.make(p)),T&&(k=T),this.tree=Et.createTree(p),this.tree.positionTree(g)};zt.prototype.destroy=function(){Et.destroy(this.tree.id)},window.Treant=zt}(),function(k,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(k=k||self).CodeMirror=b()}(this,function(){"use strict";var k=navigator.userAgent,b=navigator.platform,Ct=/gecko\/\d/i.test(k),Et=/MSIE \d/.test(k),Vt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(k),Jt=/Edge\/(\d+)/.exec(k),Nt=Et||Vt||Jt,Gt=Nt&&(Et?document.documentMode||6:+(Jt||Vt)[1]),zt=!Jt&&/WebKit\//.test(k),p=zt&&/Qt\/\d+\.\d+/.test(k),g=!Jt&&/Chrome\//.test(k),T=/Opera\//.test(k),_=/Apple Computer/.test(navigator.vendor),A=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(k),Z=/PhantomJS/.test(k),$=_&&(/Mobile\/\w+/.test(k)||navigator.maxTouchPoints>2),R=/Android/.test(k),dt=$||R||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(k),vt=$||/Mac/.test(b),mt=/\bCrOS\b/.test(k),at=/win/i.test(b),ft=T&&k.match(/Version\/(\d*\.\d*)/);ft&&(ft=Number(ft[1])),ft&&ft>=15&&(T=!1,zt=!0);var It=vt&&(p||T&&(null==ft||ft<12.11)),qt=Ct||Nt&&Gt>=9;function Wt(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}var x,xt=function(t,e){var i=t.className,r=Wt(e).exec(i);if(r){var n=i.slice(r.index+r[0].length);t.className=i.slice(0,r.index)+(n?r[1]+n:"")}};function ee(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function Xt(t,e){return ee(t).appendChild(e)}function gt(t,e,i,r){var n=document.createElement(t);if(i&&(n.className=i),r&&(n.style.cssText=r),"string"==typeof e)n.appendChild(document.createTextNode(e));else if(e)for(var o=0;o<e.length;++o)n.appendChild(e[o]);return n}function Rt(t,e,i,r){var n=gt(t,e,i,r);return n.setAttribute("role","presentation"),n}function W(t,e){if(3==e.nodeType&&(e=e.parentNode),t.contains)return t.contains(e);do{if(11==e.nodeType&&(e=e.host),e==t)return!0}while(e=e.parentNode)}function P(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function U(t,e){var i=t.className;Wt(e).test(i)||(t.className+=(i?" ":"")+e)}function M(t,e){for(var i=t.split(" "),r=0;r<i.length;r++)i[r]&&!Wt(i[r]).test(e)&&(e+=" "+i[r]);return e}x=document.createRange?function(t,e,i,r){var n=document.createRange();return n.setEnd(r||t,i),n.setStart(t,e),n}:function(t,e,i){var r=document.body.createTextRange();try{r.moveToElementText(t.parentNode)}catch(n){return r}return r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",e),r};var y=function(t){t.select()};function O(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function D(t,e,i){for(var r in e||(e={}),t)t.hasOwnProperty(r)&&(!1!==i||!e.hasOwnProperty(r))&&(e[r]=t[r]);return e}function H(t,e,i,r,n){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);for(var o=r||0,a=n||0;;){var u=t.indexOf("\t",o);if(u<0||u>=e)return a+(e-o);a+=u-o,a+=i-a%i,o=u+1}}$?y=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:Nt&&(y=function(t){try{t.select()}catch(e){}});var G=function(){this.id=null,this.f=null,this.time=0,this.handler=O(this.onTimeout,this)};function X(t,e){for(var i=0;i<t.length;++i)if(t[i]==e)return i;return-1}G.prototype.onTimeout=function(t){t.id=0,t.time<=+new Date?t.f():setTimeout(t.handler,t.time-+new Date)},G.prototype.set=function(t,e){this.f=e;var i=+new Date+t;(!this.id||i<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,t),this.time=i)};var ot={toString:function(){return"CodeMirror.Pass"}},lt={scroll:!1},St={origin:"*mouse"},Ut={origin:"+move"};function _t(t,e,i){for(var r=0,n=0;;){var o=t.indexOf("\t",r);-1==o&&(o=t.length);var a=o-r;if(o==t.length||n+a>=e)return r+Math.min(a,e-n);if(n+=o-r,r=o+1,(n+=i-n%i)>=e)return r}}var Bt=[""];function Kt(t){for(;Bt.length<=t;)Bt.push(Tt(Bt)+" ");return Bt[t]}function Tt(t){return t[t.length-1]}function jt(t,e){for(var i=[],r=0;r<t.length;r++)i[r]=e(t[r],r);return i}function Qt(){}function fe(t,e){var i;return Object.create?i=Object.create(t):(Qt.prototype=t,i=new Qt),e&&D(e,i),i}var Oe=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Re(t){return/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||Oe.test(t))}function se(t,e){return e?!!(e.source.indexOf("\\w")>-1&&Re(t))||e.test(t):Re(t)}function cr(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}var ni=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function je(t){return t.charCodeAt(0)>=768&&ni.test(t)}function Er(t,e,i){for(;(i<0?e>0:e<t.length)&&je(t.charAt(e));)e+=i;return e}function Ve(t,e,i){for(var r=e>i?-1:1;;){if(e==i)return e;var n=(e+i)/2,o=r<0?Math.ceil(n):Math.floor(n);if(o==e)return t(o)?e:i;t(o)?i=o:e=o+r}}var Le=null;function Qe(t,e,i){var r;Le=null;for(var n=0;n<t.length;++n){var o=t[n];if(o.from<e&&o.to>e)return n;o.to==e&&(o.from!=o.to&&"before"==i?r=n:Le=n),o.from==e&&(o.from!=o.to&&"before"!=i?r=n:Le=n)}return null!=r?r:Le}var oi=function(){function i(d){return d<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(d):1424<=d&&d<=1524?"R":1536<=d&&d<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(d-1536):1774<=d&&d<=2220?"r":8192<=d&&d<=8203?"w":8204==d?"b":"L"}var r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,n=/[stwN]/,o=/[LRr]/,a=/[Lb1n]/,u=/[1n]/;function c(d,C,N){this.level=d,this.from=C,this.to=N}return function(d,C){var N="ltr"==C?"L":"R";if(0==d.length||"ltr"==C&&!r.test(d))return!1;for(var B=d.length,I=[],Y=0;Y<B;++Y)I.push(i(d.charCodeAt(Y)));for(var V=0,st=N;V<B;++V){var ht=I[V];"m"==ht?I[V]=st:st=ht}for(var yt=0,ct=N;yt<B;++yt){var wt=I[yt];"1"==wt&&"r"==ct?I[yt]="n":o.test(wt)&&(ct=wt,"r"==wt&&(I[yt]="R"))}for(var Ot=1,kt=I[0];Ot<B-1;++Ot){var Yt=I[Ot];"+"==Yt&&"1"==kt&&"1"==I[Ot+1]?I[Ot]="1":","==Yt&&kt==I[Ot+1]&&("1"==kt||"n"==kt)&&(I[Ot]=kt),kt=Yt}for(var ie=0;ie<B;++ie){var xe=I[ie];if(","==xe)I[ie]="N";else if("%"==xe){var ae=void 0;for(ae=ie+1;ae<B&&"%"==I[ae];++ae);for(var Ke=ie&&"!"==I[ie-1]||ae<B&&"1"==I[ae]?"1":"N",He=ie;He<ae;++He)I[He]=Ke;ie=ae-1}}for(var ce=0,Pe=N;ce<B;++ce){var Te=I[ce];"L"==Pe&&"1"==Te?I[ce]="L":o.test(Te)&&(Pe=Te)}for(var pe=0;pe<B;++pe)if(n.test(I[pe])){var de=void 0;for(de=pe+1;de<B&&n.test(I[de]);++de);for(var ue="L"==(pe?I[pe-1]:N),Di=ue==("L"==(de<B?I[de]:N))?ue?"L":"R":N,Pr=pe;Pr<de;++Pr)I[Pr]=Di;pe=de-1}for(var hr,Me=[],we=0;we<B;)if(a.test(I[we])){var Do=we;for(++we;we<B&&a.test(I[we]);++we);Me.push(new c(0,Do,we))}else{var Sr=we,ri=Me.length,ii="rtl"==C?1:0;for(++we;we<B&&"L"!=I[we];++we);for(var De=Sr;De<we;)if(u.test(I[De])){Sr<De&&(Me.splice(ri,0,new c(1,Sr,De)),ri+=ii);var Fi=De;for(++De;De<we&&u.test(I[De]);++De);Me.splice(ri,0,new c(2,Fi,De)),ri+=ii,Sr=De}else++De;Sr<we&&Me.splice(ri,0,new c(1,Sr,we))}return"ltr"==C&&(1==Me[0].level&&(hr=d.match(/^\s+/))&&(Me[0].from=hr[0].length,Me.unshift(new c(0,0,hr[0].length))),1==Tt(Me).level&&(hr=d.match(/\s+$/))&&(Tt(Me).to-=hr[0].length,Me.push(new c(0,B-hr[0].length,B)))),"rtl"==C?Me.reverse():Me}}();function be(t,e){var i=t.order;return null==i&&(i=t.order=oi(t.text,e)),i}var Rr=[],Mt=function(t,e,i){if(t.addEventListener)t.addEventListener(e,i,!1);else if(t.attachEvent)t.attachEvent("on"+e,i);else{var r=t._handlers||(t._handlers={});r[e]=(r[e]||Rr).concat(i)}};function Gr(t,e){return t._handlers&&t._handlers[e]||Rr}function Ce(t,e,i){if(t.removeEventListener)t.removeEventListener(e,i,!1);else if(t.detachEvent)t.detachEvent("on"+e,i);else{var r=t._handlers,n=r&&r[e];if(n){var o=X(n,i);o>-1&&(r[e]=n.slice(0,o).concat(n.slice(o+1)))}}}function ne(t,e){var i=Gr(t,e);if(i.length)for(var r=Array.prototype.slice.call(arguments,2),n=0;n<i.length;++n)i[n].apply(null,r)}function le(t,e,i){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),ne(t,i||e.type,t,e),qe(e)||e.codemirrorIgnore}function pn(t){var e=t._handlers&&t._handlers.cursorActivity;if(e)for(var i=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),r=0;r<e.length;++r)-1==X(i,e[r])&&i.push(e[r])}function Ge(t,e){return Gr(t,e).length>0}function dr(t){t.prototype.on=function(e,i){Mt(this,e,i)},t.prototype.off=function(e,i){Ce(this,e,i)}}function Se(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function Ii(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function qe(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function pr(t){Se(t),Ii(t)}function Fe(t){return t.target||t.srcElement}function vn(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),vt&&t.ctrlKey&&1==e&&(e=3),e}var Lr,si,gn=function(){if(Nt&&Gt<9)return!1;var t=gt("div");return"draggable"in t||"dragDrop"in t}();function yn(t){if(null==Lr){var e=gt("span","\u200b");Xt(t,gt("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(Lr=e.offsetWidth<=1&&e.offsetHeight>2&&!(Nt&&Gt<8))}var i=Lr?gt("span","\u200b"):gt("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px");return i.setAttribute("cm-text",""),i}function li(t){if(null!=si)return si;var e=Xt(t,document.createTextNode("A\u062eA")),i=x(e,0,1).getBoundingClientRect(),r=x(e,1,2).getBoundingClientRect();return ee(t),!(!i||i.left==i.right)&&(si=r.right-i.right<3)}var t,ai=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,i=[],r=t.length;e<=r;){var n=t.indexOf("\n",e);-1==n&&(n=t.length);var o=t.slice(e,"\r"==t.charAt(n-1)?n-1:n),a=o.indexOf("\r");-1!=a?(i.push(o.slice(0,a)),e+=a+1):(i.push(o),e=n+1)}return i}:function(t){return t.split(/\r\n?|\n/)},zr=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(e){return!1}}:function(t){var e;try{e=t.ownerDocument.selection.createRange()}catch(i){}return!(!e||e.parentElement()!=t)&&0!=e.compareEndPoints("StartToEnd",e)},ui="oncopy"in(t=gt("div"))||(t.setAttribute("oncopy","return;"),"function"==typeof t.oncopy),Wi=null,fi={},kr={};function Yn(t,e){arguments.length>2&&(e.dependencies=Array.prototype.slice.call(arguments,2)),fi[t]=e}function hi(t){if("string"==typeof t&&kr.hasOwnProperty(t))t=kr[t];else if(t&&"string"==typeof t.name&&kr.hasOwnProperty(t.name)){var e=kr[t.name];"string"==typeof e&&(e={name:e}),(t=fe(e,t)).name=e.name}else{if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return hi("application/xml");if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return hi("application/json")}return"string"==typeof t?{name:t}:t||{name:"null"}}function Bi(t,e){e=hi(e);var i=fi[e.name];if(!i)return Bi(t,"text/plain");var r=i(t,e);if(vr.hasOwnProperty(e.name)){var n=vr[e.name];for(var o in n)!n.hasOwnProperty(o)||(r.hasOwnProperty(o)&&(r["_"+o]=r[o]),r[o]=n[o])}if(r.name=e.name,e.helperType&&(r.helperType=e.helperType),e.modeProps)for(var a in e.modeProps)r[a]=e.modeProps[a];return r}var vr={};function Kn(t,e){D(e,vr.hasOwnProperty(t)?vr[t]:vr[t]={})}function _e(t,e){if(!0===e)return e;if(t.copyState)return t.copyState(e);var i={};for(var r in e){var n=e[r];n instanceof Array&&(n=n.concat([])),i[r]=n}return i}function Ur(t,e){for(var i;t.innerMode&&(i=t.innerMode(e))&&i.mode!=t;)e=i.state,t=i.mode;return i||{mode:t,state:e}}function ci(t,e,i){return!t.startState||t.startState(e,i)}var At=function(t,e,i){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=i};function Lt(t,e){if((e-=t.first)<0||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(var i=t;!i.lines;)for(var r=0;;++r){var n=i.children[r],o=n.chunkSize();if(e<o){i=n;break}e-=o}return i.lines[e]}function ze(t,e,i){var r=[],n=e.line;return t.iter(e.line,i.line+1,function(o){var a=o.text;n==i.line&&(a=a.slice(0,i.ch)),n==e.line&&(a=a.slice(e.ch)),r.push(a),++n}),r}function Hi(t,e,i){var r=[];return t.iter(e,i,function(n){r.push(n.text)}),r}function Ue(t,e){var i=e-t.height;if(i)for(var r=t;r;r=r.parent)r.height+=i}function $t(t){if(null==t.parent)return null;for(var e=t.parent,i=X(e.lines,t),r=e.parent;r;e=r,r=r.parent)for(var n=0;r.children[n]!=e;++n)i+=r.children[n].chunkSize();return i+e.first}function or(t,e){var i=t.first;t:do{for(var r=0;r<t.children.length;++r){var n=t.children[r],o=n.height;if(e<o){t=n;continue t}e-=o,i+=n.chunkSize()}return i}while(!t.lines);for(var a=0;a<t.lines.length;++a){var c=t.lines[a].height;if(e<c)break;e-=c}return i+a}function Nr(t,e){return e>=t.first&&e<t.first+t.size}function Yr(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function q(t,e,i){if(void 0===i&&(i=null),!(this instanceof q))return new q(t,e,i);this.line=t,this.ch=e,this.sticky=i}function pt(t,e){return t.line-e.line||t.ch-e.ch}function di(t,e){return t.sticky==e.sticky&&0==pt(t,e)}function Xr(t){return q(t.line,t.ch)}function Mr(t,e){return pt(t,e)<0?e:t}function sr(t,e){return pt(t,e)<0?t:e}function ve(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function Dt(t,e){if(e.line<t.first)return q(t.first,0);var i=t.first+t.size-1;return e.line>i?q(i,Lt(t,i).text.length):function s(t,e){var i=t.ch;return null==i||i>e?q(t.line,e):i<0?q(t.line,0):t}(e,Lt(t,e.line).text.length)}function l(t,e){for(var i=[],r=0;r<e.length;r++)i[r]=Dt(t,e[r]);return i}At.prototype.eol=function(){return this.pos>=this.string.length},At.prototype.sol=function(){return this.pos==this.lineStart},At.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},At.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},At.prototype.eat=function(t){var e=this.string.charAt(this.pos);if("string"==typeof t?e==t:e&&(t.test?t.test(e):t(e)))return++this.pos,e},At.prototype.eatWhile=function(t){for(var e=this.pos;this.eat(t););return this.pos>e},At.prototype.eatSpace=function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},At.prototype.skipToEnd=function(){this.pos=this.string.length},At.prototype.skipTo=function(t){var e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0},At.prototype.backUp=function(t){this.pos-=t},At.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=H(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?H(this.string,this.lineStart,this.tabSize):0)},At.prototype.indentation=function(){return H(this.string,null,this.tabSize)-(this.lineStart?H(this.string,this.lineStart,this.tabSize):0)},At.prototype.match=function(t,e,i){if("string"!=typeof t){var o=this.string.slice(this.pos).match(t);return o&&o.index>0?null:(o&&!1!==e&&(this.pos+=o[0].length),o)}var r=function(a){return i?a.toLowerCase():a};if(r(this.string.substr(this.pos,t.length))==r(t))return!1!==e&&(this.pos+=t.length),!0},At.prototype.current=function(){return this.string.slice(this.start,this.pos)},At.prototype.hideFirstChars=function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}},At.prototype.lookAhead=function(t){var e=this.lineOracle;return e&&e.lookAhead(t)},At.prototype.baseToken=function(){var t=this.lineOracle;return t&&t.baseToken(this.pos)};var f=function(t,e){this.state=t,this.lookAhead=e},h=function(t,e,i,r){this.state=e,this.doc=t,this.line=i,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1};function v(t,e,i,r){var n=[t.state.modeGen],o={};K(t,e.text,t.doc.mode,i,function(d,C){return n.push(d,C)},o,r);for(var a=i.state,u=function(d){i.baseTokens=n;var C=t.state.overlays[d],N=1,B=0;i.state=!0,K(t,e.text,C.mode,i,function(I,Y){for(var V=N;B<I;){var st=n[N];st>I&&n.splice(N,1,I,n[N+1],st),N+=2,B=Math.min(I,st)}if(Y)if(C.opaque)n.splice(V,N-V,I,"overlay "+Y),N=V+2;else for(;V<N;V+=2){var ht=n[V+1];n[V+1]=(ht?ht+" ":"")+"overlay "+Y}},o),i.state=a,i.baseTokens=null,i.baseTokenPos=1},c=0;c<t.state.overlays.length;++c)u(c);return{styles:n,classes:o.bgClass||o.textClass?o:null}}function w(t,e,i){if(!e.styles||e.styles[0]!=t.state.modeGen){var r=m(t,$t(e)),n=e.text.length>t.options.maxHighlightLength&&_e(t.doc.mode,r.state),o=v(t,e,r);n&&(r.state=n),e.stateAfter=r.save(!n),e.styles=o.styles,o.classes?e.styleClasses=o.classes:e.styleClasses&&(e.styleClasses=null),i===t.doc.highlightFrontier&&(t.doc.modeFrontier=Math.max(t.doc.modeFrontier,++t.doc.highlightFrontier))}return e.styles}function m(t,e,i){var r=t.doc,n=t.display;if(!r.mode.startState)return new h(r,!0,e);var o=function J(t,e,i){for(var r,n,o=t.doc,a=i?-1:e-(t.doc.mode.innerMode?1e3:100),u=e;u>a;--u){if(u<=o.first)return o.first;var c=Lt(o,u-1),d=c.stateAfter;if(d&&(!i||u+(d instanceof f?d.lookAhead:0)<=o.modeFrontier))return u;var C=H(c.text,null,t.options.tabSize);(null==n||r>C)&&(n=u-1,r=C)}return n}(t,e,i),a=o>r.first&&Lt(r,o-1).stateAfter,u=a?h.fromSaved(r,a,o):new h(r,ci(r.mode),o);return r.iter(o,e,function(c){S(t,c.text,u);var d=u.line;c.stateAfter=d==e-1||d%5==0||d>=n.viewFrom&&d<n.viewTo?u.save():null,u.nextLine()}),i&&(r.modeFrontier=u.line),u}function S(t,e,i,r){var n=t.doc.mode,o=new At(e,t.options.tabSize,i);for(o.start=o.pos=r||0,""==e&&L(n,i.state);!o.eol();)F(n,o,i.state),o.start=o.pos}function L(t,e){if(t.blankLine)return t.blankLine(e);if(t.innerMode){var i=Ur(t,e);if(i.mode.blankLine)return i.mode.blankLine(i.state)}}function F(t,e,i,r){for(var n=0;n<10;n++){r&&(r[0]=Ur(t,i).mode);var o=t.token(e,i);if(e.pos>e.start)return o}throw new Error("Mode "+t.name+" failed to advance stream.")}h.prototype.lookAhead=function(t){var e=this.doc.getLine(this.line+t);return null!=e&&t>this.maxLookAhead&&(this.maxLookAhead=t),e},h.prototype.baseToken=function(t){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=t;)this.baseTokenPos+=2;var e=this.baseTokens[this.baseTokenPos+1];return{type:e&&e.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-t}},h.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},h.fromSaved=function(t,e,i){return e instanceof f?new h(t,_e(t.mode,e.state),i,e.lookAhead):new h(t,_e(t.mode,e),i)},h.prototype.save=function(t){var e=!1!==t?_e(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new f(e,this.maxLookAhead):e};var Q=function(t,e,i){this.start=t.start,this.end=t.pos,this.string=t.current(),this.type=e||null,this.state=i};function nt(t,e,i,r){var a,C,n=t.doc,o=n.mode,u=Lt(n,(e=Dt(n,e)).line),c=m(t,e.line,i),d=new At(u.text,t.options.tabSize,c);for(r&&(C=[]);(r||d.pos<e.ch)&&!d.eol();)d.start=d.pos,a=F(o,d,c.state),r&&C.push(new Q(d,a,_e(n.mode,c.state)));return r?C:new Q(d,a,c.state)}function j(t,e){if(t)for(;;){var i=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;t=t.slice(0,i.index)+t.slice(i.index+i[0].length);var r=i[1]?"bgClass":"textClass";null==e[r]?e[r]=i[2]:new RegExp("(?:^|\\s)"+i[2]+"(?:$|\\s)").test(e[r])||(e[r]+=" "+i[2])}return t}function K(t,e,i,r,n,o,a){var u=i.flattenSpans;null==u&&(u=t.options.flattenSpans);var N,c=0,d=null,C=new At(e,t.options.tabSize,r),B=t.options.addModeClass&&[null];for(""==e&&j(L(i,r.state),o);!C.eol();){if(C.pos>t.options.maxHighlightLength?(u=!1,a&&S(t,e,r,C.pos),C.pos=e.length,N=null):N=j(F(i,C,r.state,B),o),B){var I=B[0].name;I&&(N="m-"+(N?I+" "+N:I))}if(!u||d!=N){for(;c<C.start;)n(c=Math.min(C.start,c+5e3),d);d=N}C.start=C.pos}for(;c<C.pos;){var Y=Math.min(C.pos,c+5e3);n(Y,d),c=Y}}var rt=!1,z=!1;function ut(t,e,i){this.marker=t,this.from=e,this.to=i}function it(t,e){if(t)for(var i=0;i<t.length;++i){var r=t[i];if(r.marker==e)return r}}function Ht(t,e){for(var i,r=0;r<t.length;++r)t[r]!=e&&(i||(i=[])).push(t[r]);return i}function gr(t,e){if(e.full)return null;var i=Nr(t,e.from.line)&&Lt(t,e.from.line).markedSpans,r=Nr(t,e.to.line)&&Lt(t,e.to.line).markedSpans;if(!i&&!r)return null;var n=e.from.ch,o=e.to.ch,a=0==pt(e.from,e.to),u=function Pt(t,e,i){var r;if(t)for(var n=0;n<t.length;++n){var o=t[n],a=o.marker;null!=o.from&&!(a.inclusiveLeft?o.from<=e:o.from<e)&&(o.from!=e||"bookmark"!=a.type||i&&o.marker.insertLeft)||(r||(r=[])).push(new ut(a,o.from,null==o.to||(a.inclusiveRight?o.to>=e:o.to>e)?null:o.to))}return r}(i,n,a),c=function lr(t,e,i){var r;if(t)for(var n=0;n<t.length;++n){var o=t[n],a=o.marker;(null==o.to||(a.inclusiveRight?o.to>=e:o.to>e)||o.from==e&&"bookmark"==a.type&&(!i||o.marker.insertLeft))&&(r||(r=[])).push(new ut(a,null==o.from||(a.inclusiveLeft?o.from<=e:o.from<e)?null:o.from-e,null==o.to?null:o.to-e))}return r}(r,o,a),d=1==e.text.length,C=Tt(e.text).length+(d?n:0);if(u)for(var N=0;N<u.length;++N){var B=u[N];if(null==B.to){var I=it(c,B.marker);I?d&&(B.to=null==I.to?null:I.to+C):B.to=n}}if(c)for(var Y=0;Y<c.length;++Y){var V=c[Y];null!=V.to&&(V.to+=C),null==V.from?it(u,V.marker)||(V.from=C,d&&(u||(u=[])).push(V)):(V.from+=C,d&&(u||(u=[])).push(V))}u&&(u=ke(u)),c&&c!=u&&(c=ke(c));var ht=[u];if(!d){var ct,yt=e.text.length-2;if(yt>0&&u)for(var wt=0;wt<u.length;++wt)null==u[wt].to&&(ct||(ct=[])).push(new ut(u[wt].marker,null,null));for(var Ot=0;Ot<yt;++Ot)ht.push(ct);ht.push(c)}return ht}function ke(t){for(var e=0;e<t.length;++e){var i=t[e];null!=i.from&&i.from==i.to&&!1!==i.marker.clearWhenEmpty&&t.splice(e--,1)}return t.length?t:null}function yr(t){var e=t.markedSpans;if(e){for(var i=0;i<e.length;++i)e[i].marker.detachLine(t);t.markedSpans=null}}function mr(t,e){if(e){for(var i=0;i<e.length;++i)e[i].marker.attachLine(t);t.markedSpans=e}}function xr(t){return t.inclusiveLeft?-1:0}function Ie(t){return t.inclusiveRight?1:0}function $e(t,e){var i=t.lines.length-e.lines.length;if(0!=i)return i;var r=t.find(),n=e.find(),o=pt(r.from,n.from)||xr(t)-xr(e);return o?-o:pt(r.to,n.to)||Ie(t)-Ie(e)||e.id-t.id}function Kr(t,e){var r,i=z&&t.markedSpans;if(i)for(var n=void 0,o=0;o<i.length;++o)(n=i[o]).marker.collapsed&&null==(e?n.from:n.to)&&(!r||$e(r,n.marker)<0)&&(r=n.marker);return r}function Pi(t){return Kr(t,!0)}function Zr(t){return Kr(t,!1)}function Or(t,e){var r,i=z&&t.markedSpans;if(i)for(var n=0;n<i.length;++n){var o=i[n];o.marker.collapsed&&(null==o.from||o.from<e)&&(null==o.to||o.to>e)&&(!r||$e(r,o.marker)<0)&&(r=o.marker)}return r}function Ei(t,e,i,r,n){var o=Lt(t,e),a=z&&o.markedSpans;if(a)for(var u=0;u<a.length;++u){var c=a[u];if(c.marker.collapsed){var d=c.marker.find(0),C=pt(d.from,i)||xr(c.marker)-xr(n),N=pt(d.to,r)||Ie(c.marker)-Ie(n);if(!(C>=0&&N<=0||C<=0&&N>=0)&&(C<=0&&(c.marker.inclusiveRight&&n.inclusiveLeft?pt(d.to,i)>=0:pt(d.to,i)>0)||C>=0&&(c.marker.inclusiveRight&&n.inclusiveLeft?pt(d.from,r)<=0:pt(d.from,r)<0)))return!0}}}function Ye(t){for(var e;e=Pi(t);)t=e.find(-1,!0).line;return t}function Ri(t,e){var i=Lt(t,e),r=Ye(i);return i==r?e:$t(r)}function Gi(t,e){if(e>t.lastLine())return e;var r,i=Lt(t,e);if(!tr(t,i))return e;for(;r=Zr(i);)i=r.find(1,!0).line;return $t(i)+1}function tr(t,e){var i=z&&e.markedSpans;if(i)for(var r=void 0,n=0;n<i.length;++n)if((r=i[n]).marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&_r(t,e,r))return!0}}function _r(t,e,i){if(null==i.to){var r=i.marker.find(1,!0);return _r(t,r.line,it(r.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==e.text.length)return!0;for(var n=void 0,o=0;o<e.markedSpans.length;++o)if((n=e.markedSpans[o]).marker.collapsed&&!n.marker.widgetNode&&n.from==i.to&&(null==n.to||n.to!=i.from)&&(n.marker.inclusiveLeft||i.marker.inclusiveRight)&&_r(t,e,n))return!0}function er(t){for(var e=0,i=(t=Ye(t)).parent,r=0;r<i.lines.length;++r){var n=i.lines[r];if(n==t)break;e+=n.height}for(var o=i.parent;o;o=(i=o).parent)for(var a=0;a<o.children.length;++a){var u=o.children[a];if(u==i)break;e+=u.height}return e}function pi(t){if(0==t.height)return 0;for(var i,e=t.text.length,r=t;i=Pi(r);){var n=i.find(0,!0);r=n.from.line,e+=n.from.ch-n.to.ch}for(r=t;i=Zr(r);){var o=i.find(0,!0);e-=r.text.length-o.from.ch,e+=(r=o.to.line).text.length-o.to.ch}return e}function Zn(t){var e=t.display,i=t.doc;e.maxLine=Lt(i,i.first),e.maxLineLength=pi(e.maxLine),e.maxLineChanged=!0,i.iter(function(r){var n=pi(r);n>e.maxLineLength&&(e.maxLineLength=n,e.maxLine=r)})}var vi=function(t,e,i){this.text=t,mr(this,e),this.height=i?i(this):1};function ml(t){t.parent=null,yr(t)}vi.prototype.lineNo=function(){return $t(this)},dr(vi);var xl={},wl={};function Io(t,e){if(!t||/^\s*$/.test(t))return null;var i=e.addModeClass?wl:xl;return i[t]||(i[t]=t.replace(/\S+/g,"cm-$&"))}function Wo(t,e){var i=Rt("span",null,null,zt?"padding-right: .1px":null),r={pre:Rt("pre",[i],"CodeMirror-line"),content:i,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:t.getOption("lineWrapping")};e.measure={};for(var n=0;n<=(e.rest?e.rest.length:0);n++){var o=n?e.rest[n-1]:e.line,a=void 0;r.pos=0,r.addToken=Cl,li(t.display.measure)&&(a=be(o,t.doc.direction))&&(r.addToken=Tl(r.addToken,a)),r.map=[],Ll(o,r,w(t,o,e!=t.display.externalMeasured&&$t(o))),o.styleClasses&&(o.styleClasses.bgClass&&(r.bgClass=M(o.styleClasses.bgClass,r.bgClass||"")),o.styleClasses.textClass&&(r.textClass=M(o.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(yn(t.display.measure))),0==n?(e.measure.map=r.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(r.map),(e.measure.caches||(e.measure.caches=[])).push({}))}if(zt){var c=r.content.lastChild;(/\bcm-tab\b/.test(c.className)||c.querySelector&&c.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack")}return ne(t,"renderLine",t,e.line,r.pre),r.pre.className&&(r.textClass=M(r.pre.className,r.textClass||"")),r}function bl(t){var e=gt("span","\u2022","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e.setAttribute("aria-label",e.title),e}function Cl(t,e,i,r,n,o,a){if(e){var C,u=t.splitSpaces?function Sl(t,e){if(t.length>1&&!/  /.test(t))return t;for(var i=e,r="",n=0;n<t.length;n++){var o=t.charAt(n);" "==o&&i&&(n==t.length-1||32==t.charCodeAt(n+1))&&(o="\xa0"),r+=o,i=" "==o}return r}(e,t.trailingSpace):e,c=t.cm.state.specialChars,d=!1;if(c.test(e)){C=document.createDocumentFragment();for(var N=0;;){c.lastIndex=N;var B=c.exec(e),I=B?B.index-N:e.length-N;if(I){var Y=document.createTextNode(u.slice(N,N+I));C.appendChild(Nt&&Gt<9?gt("span",[Y]):Y),t.map.push(t.pos,t.pos+I,Y),t.col+=I,t.pos+=I}if(!B)break;N+=I+1;var V=void 0;if("\t"==B[0]){var st=t.cm.options.tabSize,ht=st-t.col%st;(V=C.appendChild(gt("span",Kt(ht),"cm-tab"))).setAttribute("role","presentation"),V.setAttribute("cm-text","\t"),t.col+=ht}else"\r"==B[0]||"\n"==B[0]?((V=C.appendChild(gt("span","\r"==B[0]?"\u240d":"\u2424","cm-invalidchar"))).setAttribute("cm-text",B[0]),t.col+=1):((V=t.cm.options.specialCharPlaceholder(B[0])).setAttribute("cm-text",B[0]),C.appendChild(Nt&&Gt<9?gt("span",[V]):V),t.col+=1);t.map.push(t.pos,t.pos+1,V),t.pos++}}else t.col+=e.length,C=document.createTextNode(u),t.map.push(t.pos,t.pos+e.length,C),Nt&&Gt<9&&(d=!0),t.pos+=e.length;if(t.trailingSpace=32==u.charCodeAt(e.length-1),i||r||n||d||o||a){var yt=i||"";r&&(yt+=r),n&&(yt+=n);var ct=gt("span",[C],yt,o);if(a)for(var wt in a)a.hasOwnProperty(wt)&&"style"!=wt&&"class"!=wt&&ct.setAttribute(wt,a[wt]);return t.content.appendChild(ct)}t.content.appendChild(C)}}function Tl(t,e){return function(i,r,n,o,a,u,c){n=n?n+" cm-force-border":"cm-force-border";for(var d=i.pos,C=d+r.length;;){for(var N=void 0,B=0;B<e.length&&!((N=e[B]).to>d&&N.from<=d);B++);if(N.to>=C)return t(i,r,n,o,a,u,c);t(i,r.slice(0,N.to-d),n,o,null,u,c),o=null,r=r.slice(N.to-d),d=N.to}}}function Bo(t,e,i,r){var n=!r&&i.widgetNode;n&&t.map.push(t.pos,t.pos+e,n),!r&&t.cm.display.input.needsContentAttribute&&(n||(n=t.content.appendChild(document.createElement("span"))),n.setAttribute("cm-marker",i.id)),n&&(t.cm.display.input.setUneditable(n),t.content.appendChild(n)),t.pos+=e,t.trailingSpace=!1}function Ll(t,e,i){var r=t.markedSpans,n=t.text,o=0;if(r)for(var N,B,Y,V,st,ht,yt,u=n.length,c=0,d=1,C="",I=0;;){if(I==c){Y=V=st=B="",yt=null,ht=null,I=1/0;for(var ct=[],wt=void 0,Ot=0;Ot<r.length;++Ot){var kt=r[Ot],Yt=kt.marker;if("bookmark"==Yt.type&&kt.from==c&&Yt.widgetNode)ct.push(Yt);else if(kt.from<=c&&(null==kt.to||kt.to>c||Yt.collapsed&&kt.to==c&&kt.from==c)){if(null!=kt.to&&kt.to!=c&&I>kt.to&&(I=kt.to,V=""),Yt.className&&(Y+=" "+Yt.className),Yt.css&&(B=(B?B+";":"")+Yt.css),Yt.startStyle&&kt.from==c&&(st+=" "+Yt.startStyle),Yt.endStyle&&kt.to==I&&(wt||(wt=[])).push(Yt.endStyle,kt.to),Yt.title&&((yt||(yt={})).title=Yt.title),Yt.attributes)for(var ie in Yt.attributes)(yt||(yt={}))[ie]=Yt.attributes[ie];Yt.collapsed&&(!ht||$e(ht.marker,Yt)<0)&&(ht=kt)}else kt.from>c&&I>kt.from&&(I=kt.from)}if(wt)for(var xe=0;xe<wt.length;xe+=2)wt[xe+1]==I&&(V+=" "+wt[xe]);if(!ht||ht.from==c)for(var ae=0;ae<ct.length;++ae)Bo(e,0,ct[ae]);if(ht&&(ht.from||0)==c){if(Bo(e,(null==ht.to?u+1:ht.to)-c,ht.marker,null==ht.from),null==ht.to)return;ht.to==c&&(ht=!1)}}if(c>=u)break;for(var Ke=Math.min(u,I);;){if(C){var He=c+C.length;if(!ht){var ce=He>Ke?C.slice(0,Ke-c):C;e.addToken(e,ce,N?N+Y:Y,st,c+ce.length==I?V:"",B,yt)}if(He>=Ke){C=C.slice(Ke-c),c=Ke;break}c=He,st=""}C=n.slice(o,o=i[d++]),N=Io(i[d++],e.cm.options)}}else for(var a=1;a<i.length;a+=2)e.addToken(e,n.slice(o,o=i[a]),Io(i[a+1],e.cm.options))}function Ho(t,e,i){this.line=e,this.rest=function ar(t){for(var e,i;e=Zr(t);)t=e.find(1,!0).line,(i||(i=[])).push(t);return i}(e),this.size=this.rest?$t(Tt(this.rest))-i+1:1,this.node=this.text=null,this.hidden=tr(t,e)}function wn(t,e,i){for(var n,r=[],o=e;o<i;o=n){var a=new Ho(t.doc,Lt(t.doc,o),o);n=o+a.size,r.push(a)}return r}var gi=null,zi=null;function ge(t,e){var i=Gr(t,e);if(i.length){var n,r=Array.prototype.slice.call(arguments,2);gi?n=gi.delayedCallbacks:zi?n=zi:(n=zi=[],setTimeout(Ol,0));for(var o=function(u){n.push(function(){return i[u].apply(null,r)})},a=0;a<i.length;++a)o(a)}}function Ol(){var t=zi;zi=null;for(var e=0;e<t.length;++e)t[e]()}function Po(t,e,i,r){for(var n=0;n<e.changes.length;n++){var o=e.changes[n];"text"==o?Al(t,e):"gutter"==o?Ro(t,e,i,r):"class"==o?Qn(t,e):"widget"==o&&Dl(t,e,r)}e.changes=null}function Ui(t){return t.node==t.text&&(t.node=gt("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),Nt&&Gt<8&&(t.node.style.zIndex=2)),t.node}function Eo(t,e){var i=t.display.externalMeasured;return i&&i.line==e.line?(t.display.externalMeasured=null,e.measure=i.measure,i.built):Wo(t,e)}function Al(t,e){var i=e.text.className,r=Eo(t,e);e.text==e.node&&(e.node=r.pre),e.text.parentNode.replaceChild(r.pre,e.text),e.text=r.pre,r.bgClass!=e.bgClass||r.textClass!=e.textClass?(e.bgClass=r.bgClass,e.textClass=r.textClass,Qn(t,e)):i&&(e.text.className=i)}function Qn(t,e){(function _l(t,e){var i=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(i&&(i+=" CodeMirror-linebackground"),e.background)i?e.background.className=i:(e.background.parentNode.removeChild(e.background),e.background=null);else if(i){var r=Ui(e);e.background=r.insertBefore(gt("div",null,i),r.firstChild),t.display.input.setUneditable(e.background)}})(t,e),e.line.wrapClass?Ui(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className=""),e.text.className=(e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass)||""}function Ro(t,e,i,r){if(e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null),e.gutterBackground&&(e.node.removeChild(e.gutterBackground),e.gutterBackground=null),e.line.gutterClass){var n=Ui(e);e.gutterBackground=gt("div",null,"CodeMirror-gutter-background "+e.line.gutterClass,"left: "+(t.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),t.display.input.setUneditable(e.gutterBackground),n.insertBefore(e.gutterBackground,e.text)}var o=e.line.gutterMarkers;if(t.options.lineNumbers||o){var a=Ui(e),u=e.gutter=gt("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(u.setAttribute("aria-hidden","true"),t.display.input.setUneditable(u),a.insertBefore(u,e.text),e.line.gutterClass&&(u.className+=" "+e.line.gutterClass),t.options.lineNumbers&&(!o||!o["CodeMirror-linenumbers"])&&(e.lineNumber=u.appendChild(gt("div",Yr(t.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),o)for(var c=0;c<t.display.gutterSpecs.length;++c){var d=t.display.gutterSpecs[c].className,C=o.hasOwnProperty(d)&&o[d];C&&u.appendChild(gt("div",[C],"CodeMirror-gutter-elt","left: "+r.gutterLeft[d]+"px; width: "+r.gutterWidth[d]+"px"))}}}function Dl(t,e,i){e.alignable&&(e.alignable=null);for(var r=Wt("CodeMirror-linewidget"),n=e.node.firstChild,o=void 0;n;n=o)o=n.nextSibling,r.test(n.className)&&e.node.removeChild(n);Go(t,e,i)}function Fl(t,e,i,r){var n=Eo(t,e);return e.text=e.node=n.pre,n.bgClass&&(e.bgClass=n.bgClass),n.textClass&&(e.textClass=n.textClass),Qn(t,e),Ro(t,e,i,r),Go(t,e,r),e.node}function Go(t,e,i){if(zo(t,e.line,e,i,!0),e.rest)for(var r=0;r<e.rest.length;r++)zo(t,e.rest[r],e,i,!1)}function zo(t,e,i,r,n){if(e.widgets)for(var o=Ui(i),a=0,u=e.widgets;a<u.length;++a){var c=u[a],d=gt("div",[c.node],"CodeMirror-linewidget"+(c.className?" "+c.className:""));c.handleMouseEvents||d.setAttribute("cm-ignore-events","true"),Il(c,d,i,r),t.display.input.setUneditable(d),n&&c.above?o.insertBefore(d,i.gutter||i.text):o.appendChild(d),ge(c,"redraw")}}function Il(t,e,i,r){if(t.noHScroll){(i.alignable||(i.alignable=[])).push(e);var n=r.wrapperWidth;e.style.left=r.fixedPos+"px",t.coverGutter||(n-=r.gutterTotalWidth,e.style.paddingLeft=r.gutterTotalWidth+"px"),e.style.width=n+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-r.gutterTotalWidth+"px"))}function Yi(t){if(null!=t.height)return t.height;var e=t.doc.cm;if(!e)return 0;if(!W(document.body,t.node)){var i="position: relative;";t.coverGutter&&(i+="margin-left: -"+e.display.gutters.offsetWidth+"px;"),t.noHScroll&&(i+="width: "+e.display.wrapper.clientWidth+"px;"),Xt(e.display.measure,gt("div",[t.node],null,i))}return t.height=t.node.parentNode.offsetHeight}function wr(t,e){for(var i=Fe(e);i!=t.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==t.sizer&&i!=t.mover)return!0}function bn(t){return t.lineSpace.offsetTop}function Jn(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function Uo(t){if(t.cachedPaddingH)return t.cachedPaddingH;var e=Xt(t.measure,gt("pre","x","CodeMirror-line-like")),i=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,r={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return!isNaN(r.left)&&!isNaN(r.right)&&(t.cachedPaddingH=r),r}function ur(t){return 50-t.display.nativeBarWidth}function Qr(t){return t.display.scroller.clientWidth-ur(t)-t.display.barWidth}function jn(t){return t.display.scroller.clientHeight-ur(t)-t.display.barHeight}function Yo(t,e,i){if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};if(t.rest){for(var r=0;r<t.rest.length;r++)if(t.rest[r]==e)return{map:t.measure.maps[r],cache:t.measure.caches[r]};for(var n=0;n<t.rest.length;n++)if($t(t.rest[n])>i)return{map:t.measure.maps[n],cache:t.measure.caches[n],before:!0}}}function Xo(t,e,i,r){return fr(t,yi(t,e),i,r)}function Vn(t,e){if(e>=t.display.viewFrom&&e<t.display.viewTo)return t.display.view[Vr(t,e)];var i=t.display.externalMeasured;return i&&e>=i.lineN&&e<i.lineN+i.size?i:void 0}function yi(t,e){var i=$t(e),r=Vn(t,i);r&&!r.text?r=null:r&&r.changes&&(Po(t,r,i,ro(t)),t.curOp.forceUpdate=!0),r||(r=function Bl(t,e){var i=$t(e=Ye(e)),r=t.display.externalMeasured=new Ho(t.doc,e,i);r.lineN=i;var n=r.built=Wo(t,r);return r.text=n.pre,Xt(t.display.lineMeasure,n.pre),r}(t,e));var n=Yo(r,e,i);return{line:e,view:r,rect:null,map:n.map,cache:n.cache,before:n.before,hasHeights:!1}}function fr(t,e,i,r,n){e.before&&(i=-1);var a,o=i+(r||"");return e.cache.hasOwnProperty(o)?a=e.cache[o]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(function Wl(t,e,i){var r=t.options.lineWrapping,n=r&&Qr(t);if(!e.measure.heights||r&&e.measure.width!=n){var o=e.measure.heights=[];if(r){e.measure.width=n;for(var a=e.text.firstChild.getClientRects(),u=0;u<a.length-1;u++){var c=a[u],d=a[u+1];Math.abs(c.bottom-d.bottom)>2&&o.push((c.bottom+d.top)/2-i.top)}}o.push(i.bottom-i.top)}}(t,e.view,e.rect),e.hasHeights=!0),a=function Pl(t,e,i,r){var d,n=Zo(e.map,i,r),o=n.node,a=n.start,u=n.end,c=n.collapse;if(3==o.nodeType){for(var C=0;C<4;C++){for(;a&&je(e.line.text.charAt(n.coverStart+a));)--a;for(;n.coverStart+u<n.coverEnd&&je(e.line.text.charAt(n.coverStart+u));)++u;if((d=Nt&&Gt<9&&0==a&&u==n.coverEnd-n.coverStart?o.parentNode.getBoundingClientRect():Hl(x(o,a,u).getClientRects(),r)).left||d.right||0==a)break;u=a,a-=1,c="right"}Nt&&Gt<11&&(d=function El(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function mn(t){if(null!=Wi)return Wi;var e=Xt(t,gt("span","x")),i=e.getBoundingClientRect(),r=x(e,0,1).getBoundingClientRect();return Wi=Math.abs(i.left-r.left)>1}(t))return e;var i=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*i,right:e.right*i,top:e.top*r,bottom:e.bottom*r}}(t.display.measure,d))}else{var N;a>0&&(c=r="right"),d=t.options.lineWrapping&&(N=o.getClientRects()).length>1?N["right"==r?N.length-1:0]:o.getBoundingClientRect()}if(Nt&&Gt<9&&!a&&(!d||!d.left&&!d.right)){var B=o.parentNode.getClientRects()[0];d=B?{left:B.left,right:B.left+xi(t.display),top:B.top,bottom:B.bottom}:Ko}for(var I=d.top-e.rect.top,Y=d.bottom-e.rect.top,V=(I+Y)/2,st=e.view.measure.heights,ht=0;ht<st.length-1&&!(V<st[ht]);ht++);var wt={left:("right"==c?d.right:d.left)-e.rect.left,right:("left"==c?d.left:d.right)-e.rect.left,top:ht?st[ht-1]:0,bottom:st[ht]};return!d.left&&!d.right&&(wt.bogus=!0),t.options.singleCursorHeightPerLine||(wt.rtop=I,wt.rbottom=Y),wt}(t,e,i,r),a.bogus||(e.cache[o]=a)),{left:a.left,right:a.right,top:n?a.rtop:a.top,bottom:n?a.rbottom:a.bottom}}var Jr,Ko={left:0,right:0,top:0,bottom:0};function Zo(t,e,i){for(var r,n,o,a,u,c,d=0;d<t.length;d+=3)if(c=t[d+1],e<(u=t[d])?(n=0,o=1,a="left"):e<c?o=1+(n=e-u):(d==t.length-3||e==c&&t[d+3]>e)&&(n=(o=c-u)-1,e>=c&&(a="right")),null!=n){if(r=t[d+2],u==c&&i==(r.insertLeft?"left":"right")&&(a=i),"left"==i&&0==n)for(;d&&t[d-2]==t[d-3]&&t[d-1].insertLeft;)r=t[2+(d-=3)],a="left";if("right"==i&&n==c-u)for(;d<t.length-3&&t[d+3]==t[d+4]&&!t[d+5].insertLeft;)r=t[(d+=3)+2],a="right";break}return{node:r,start:n,end:o,collapse:a,coverStart:u,coverEnd:c}}function Hl(t,e){var i=Ko;if("left"==e)for(var r=0;r<t.length&&(i=t[r]).left==i.right;r++);else for(var n=t.length-1;n>=0&&(i=t[n]).left==i.right;n--);return i}function Qo(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;e<t.rest.length;e++)t.measure.caches[e]={}}function Jo(t){t.display.externalMeasure=null,ee(t.display.lineMeasure);for(var e=0;e<t.display.view.length;e++)Qo(t.display.view[e])}function Xi(t){Jo(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function jo(){return g&&R?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Vo(){return g&&R?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function qn(t){var i=Ye(t).widgets,r=0;if(i)for(var n=0;n<i.length;++n)i[n].above&&(r+=Yi(i[n]));return r}function Cn(t,e,i,r,n){if(!n){var o=qn(e);i.top+=o,i.bottom+=o}if("line"==r)return i;r||(r="local");var a=er(e);if("local"==r?a+=bn(t.display):a-=t.display.viewOffset,"page"==r||"window"==r){var u=t.display.lineSpace.getBoundingClientRect();a+=u.top+("window"==r?0:Vo());var c=u.left+("window"==r?0:jo());i.left+=c,i.right+=c}return i.top+=a,i.bottom+=a,i}function qo(t,e,i){if("div"==i)return e;var r=e.left,n=e.top;if("page"==i)r-=jo(),n-=Vo();else if("local"==i||!i){var o=t.display.sizer.getBoundingClientRect();r+=o.left,n+=o.top}var a=t.display.lineSpace.getBoundingClientRect();return{left:r-a.left,top:n-a.top}}function Sn(t,e,i,r,n){return r||(r=Lt(t.doc,e.line)),Cn(t,r,Xo(t,r,e.ch,n),i)}function rr(t,e,i,r,n,o){function a(Y,V){var st=fr(t,n,Y,V?"right":"left",o);return V?st.left=st.right:st.right=st.left,Cn(t,r,st,i)}r=r||Lt(t.doc,e.line),n||(n=yi(t,r));var u=be(r,t.doc.direction),c=e.ch,d=e.sticky;if(c>=r.text.length?(c=r.text.length,d="before"):c<=0&&(c=0,d="after"),!u)return a("before"==d?c-1:c,"before"==d);function C(Y,V,st){return a(st?Y-1:Y,1==u[V].level!=st)}var N=Qe(u,c,d),B=Le,I=C(c,N,"before"==d);return null!=B&&(I.other=C(c,B,"before"!=d)),I}function $o(t,e){var i=0;e=Dt(t.doc,e),t.options.lineWrapping||(i=xi(t.display)*e.ch);var r=Lt(t.doc,e.line),n=er(r)+bn(t.display);return{left:i,right:i,top:n,bottom:n+r.height}}function $n(t,e,i,r,n){var o=q(t,e,i);return o.xRel=n,r&&(o.outside=r),o}function to(t,e,i){var r=t.doc;if((i+=t.display.viewOffset)<0)return $n(r.first,0,null,-1,-1);var n=or(r,i),o=r.first+r.size-1;if(n>o)return $n(r.first+r.size-1,Lt(r,o).text.length,null,1,1);e<0&&(e=0);for(var a=Lt(r,n);;){var u=Rl(t,a,n,e,i),c=Or(a,u.ch+(u.xRel>0||u.outside>0?1:0));if(!c)return u;var d=c.find(1);if(d.line==n)return d;a=Lt(r,n=d.line)}}function ts(t,e,i,r){r-=qn(e);var n=e.text.length,o=Ve(function(a){return fr(t,i,a-1).bottom<=r},n,0);return{begin:o,end:n=Ve(function(a){return fr(t,i,a).top>r},o,n)}}function es(t,e,i,r){return i||(i=yi(t,e)),ts(t,e,i,Cn(t,e,fr(t,i,r),"line").top)}function eo(t,e,i,r){return!(t.bottom<=i)&&(t.top>i||(r?t.left:t.right)>e)}function Rl(t,e,i,r,n){n-=er(e);var o=yi(t,e),a=qn(e),u=0,c=e.text.length,d=!0,C=be(e,t.doc.direction);if(C){var N=(t.options.lineWrapping?zl:Gl)(t,e,i,o,C,r,n);u=(d=1!=N.level)?N.from:N.to-1,c=d?N.to:N.from-1}var V,st,B=null,I=null,Y=Ve(function(Ot){var kt=fr(t,o,Ot);return kt.top+=a,kt.bottom+=a,!!eo(kt,r,n,!1)&&(kt.top<=n&&kt.left<=r&&(B=Ot,I=kt),!0)},u,c),ht=!1;if(I){var yt=r-I.left<I.right-r,ct=yt==d;Y=B+(ct?0:1),st=ct?"after":"before",V=yt?I.left:I.right}else{!d&&(Y==c||Y==u)&&Y++,st=0==Y?"after":Y==e.text.length?"before":fr(t,o,Y-(d?1:0)).bottom+a<=n==d?"after":"before";var wt=rr(t,q(i,Y,st),"line",e,o);V=wt.left,ht=n<wt.top?-1:n>=wt.bottom?1:0}return $n(i,Y=Er(e.text,Y,1),st,ht,r-V)}function Gl(t,e,i,r,n,o,a){var u=Ve(function(N){var B=n[N],I=1!=B.level;return eo(rr(t,q(i,I?B.to:B.from,I?"before":"after"),"line",e,r),o,a,!0)},0,n.length-1),c=n[u];if(u>0){var d=1!=c.level,C=rr(t,q(i,d?c.from:c.to,d?"after":"before"),"line",e,r);eo(C,o,a,!0)&&C.top>a&&(c=n[u-1])}return c}function zl(t,e,i,r,n,o,a){var u=ts(t,e,r,a),c=u.begin,d=u.end;/\s/.test(e.text.charAt(d-1))&&d--;for(var C=null,N=null,B=0;B<n.length;B++){var I=n[B];if(!(I.from>=d||I.to<=c)){var V=fr(t,r,1!=I.level?Math.min(d,I.to)-1:Math.max(c,I.from)).right,st=V<o?o-V+1e9:V-o;(!C||N>st)&&(C=I,N=st)}}return C||(C=n[n.length-1]),C.from<c&&(C={from:c,to:C.to,level:C.level}),C.to>d&&(C={from:C.from,to:d,level:C.level}),C}function mi(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==Jr){Jr=gt("pre",null,"CodeMirror-line-like");for(var e=0;e<49;++e)Jr.appendChild(document.createTextNode("x")),Jr.appendChild(gt("br"));Jr.appendChild(document.createTextNode("x"))}Xt(t.measure,Jr);var i=Jr.offsetHeight/50;return i>3&&(t.cachedTextHeight=i),ee(t.measure),i||1}function xi(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=gt("span","xxxxxxxxxx"),i=gt("pre",[e],"CodeMirror-line-like");Xt(t.measure,i);var r=e.getBoundingClientRect(),n=(r.right-r.left)/10;return n>2&&(t.cachedCharWidth=n),n||10}function ro(t){for(var e=t.display,i={},r={},n=e.gutters.clientLeft,o=e.gutters.firstChild,a=0;o;o=o.nextSibling,++a){var u=t.display.gutterSpecs[a].className;i[u]=o.offsetLeft+o.clientLeft+n,r[u]=o.clientWidth}return{fixedPos:io(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:i,gutterWidth:r,wrapperWidth:e.wrapper.clientWidth}}function io(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function rs(t){var e=mi(t.display),i=t.options.lineWrapping,r=i&&Math.max(5,t.display.scroller.clientWidth/xi(t.display)-3);return function(n){if(tr(t.doc,n))return 0;var o=0;if(n.widgets)for(var a=0;a<n.widgets.length;a++)n.widgets[a].height&&(o+=n.widgets[a].height);return i?o+(Math.ceil(n.text.length/r)||1)*e:o+e}}function no(t){var e=t.doc,i=rs(t);e.iter(function(r){var n=i(r);n!=r.height&&Ue(r,n)})}function jr(t,e,i,r){var n=t.display;if(!i&&"true"==Fe(e).getAttribute("cm-not-content"))return null;var o,a,u=n.lineSpace.getBoundingClientRect();try{o=e.clientX-u.left,a=e.clientY-u.top}catch(N){return null}var d,c=to(t,o,a);if(r&&c.xRel>0&&(d=Lt(t.doc,c.line).text).length==c.ch){var C=H(d,d.length,t.options.tabSize)-d.length;c=q(c.line,Math.max(0,Math.round((o-Uo(t.display).left)/xi(t.display))-C))}return c}function Vr(t,e){if(e>=t.display.viewTo||(e-=t.display.viewFrom)<0)return null;for(var i=t.display.view,r=0;r<i.length;r++)if((e-=i[r].size)<0)return r}function We(t,e,i,r){null==e&&(e=t.doc.first),null==i&&(i=t.doc.first+t.doc.size),r||(r=0);var n=t.display;if(r&&i<n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>e)&&(n.updateLineNumbers=e),t.curOp.viewChanged=!0,e>=n.viewTo)z&&Ri(t.doc,e)<n.viewTo&&Dr(t);else if(i<=n.viewFrom)z&&Gi(t.doc,i+r)>n.viewFrom?Dr(t):(n.viewFrom+=r,n.viewTo+=r);else if(e<=n.viewFrom&&i>=n.viewTo)Dr(t);else if(e<=n.viewFrom){var o=Tn(t,i,i+r,1);o?(n.view=n.view.slice(o.index),n.viewFrom=o.lineN,n.viewTo+=r):Dr(t)}else if(i>=n.viewTo){var a=Tn(t,e,e,-1);a?(n.view=n.view.slice(0,a.index),n.viewTo=a.lineN):Dr(t)}else{var u=Tn(t,e,e,-1),c=Tn(t,i,i+r,1);u&&c?(n.view=n.view.slice(0,u.index).concat(wn(t,u.lineN,c.lineN)).concat(n.view.slice(c.index)),n.viewTo+=r):Dr(t)}var d=n.externalMeasured;d&&(i<d.lineN?d.lineN+=r:e<d.lineN+d.size&&(n.externalMeasured=null))}function Ar(t,e,i){t.curOp.viewChanged=!0;var r=t.display,n=t.display.externalMeasured;if(n&&e>=n.lineN&&e<n.lineN+n.size&&(r.externalMeasured=null),!(e<r.viewFrom||e>=r.viewTo)){var o=r.view[Vr(t,e)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==X(a,i)&&a.push(i)}}}function Dr(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function Tn(t,e,i,r){var o,n=Vr(t,e),a=t.display.view;if(!z||i==t.doc.first+t.doc.size)return{index:n,lineN:i};for(var u=t.display.viewFrom,c=0;c<n;c++)u+=a[c].size;if(u!=e){if(r>0){if(n==a.length-1)return null;o=u+a[n].size-e,n++}else o=u-e;e+=o,i+=o}for(;Ri(t.doc,i)!=i;){if(n==(r<0?0:a.length-1))return null;i+=r*a[n-(r<0?1:0)].size,n+=r}return{index:n,lineN:i}}function is(t){for(var e=t.display.view,i=0,r=0;r<e.length;r++){var n=e[r];!n.hidden&&(!n.node||n.changes)&&++i}return i}function Ki(t){t.display.input.showSelection(t.display.input.prepareSelection())}function ns(t,e){void 0===e&&(e=!0);var i=t.doc,r={},n=r.cursors=document.createDocumentFragment(),o=r.selection=document.createDocumentFragment(),a=t.options.$customCursor;a&&(e=!0);for(var u=0;u<i.sel.ranges.length;u++)if(e||u!=i.sel.primIndex){var c=i.sel.ranges[u];if(!(c.from().line>=t.display.viewTo||c.to().line<t.display.viewFrom)){var d=c.empty();if(a){var C=a(t,c);C&&oo(t,C,n)}else(d||t.options.showCursorWhenSelecting)&&oo(t,c.head,n);d||Yl(t,c,o)}}return r}function oo(t,e,i){var r=rr(t,e,"div",null,null,!t.options.singleCursorHeightPerLine),n=i.appendChild(gt("div","\xa0","CodeMirror-cursor"));if(n.style.left=r.left+"px",n.style.top=r.top+"px",n.style.height=Math.max(0,r.bottom-r.top)*t.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(t.getWrapperElement().className)){var o=Sn(t,e,"div",null,null),a=o.right-o.left;n.style.width=(a>0?a:t.defaultCharWidth())+"px"}if(r.other){var u=i.appendChild(gt("div","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"));u.style.display="",u.style.left=r.other.left+"px",u.style.top=r.other.top+"px",u.style.height=.85*(r.other.bottom-r.other.top)+"px"}}function Ln(t,e){return t.top-e.top||t.left-e.left}function Yl(t,e,i){var r=t.display,n=t.doc,o=document.createDocumentFragment(),a=Uo(t.display),u=a.left,c=Math.max(r.sizerWidth,Qr(t)-r.sizer.offsetLeft)-a.right,d="ltr"==n.direction;function C(ct,wt,Ot,kt){wt<0&&(wt=0),wt=Math.round(wt),kt=Math.round(kt),o.appendChild(gt("div",null,"CodeMirror-selected","position: absolute; left: "+ct+"px;\n                             top: "+wt+"px; width: "+(null==Ot?c-ct:Ot)+"px;\n                             height: "+(kt-wt)+"px"))}function N(ct,wt,Ot){var ie,xe,kt=Lt(n,ct),Yt=kt.text.length;function ae(ce,Pe){return Sn(t,q(ct,ce),"div",kt,Pe)}function Ke(ce,Pe,Te){var pe=es(t,kt,null,ce),de="ltr"==Pe==("after"==Te)?"left":"right";return ae("after"==Te?pe.begin:pe.end-(/\s/.test(kt.text.charAt(pe.end-1))?2:1),de)[de]}var He=be(kt,n.direction);return function Tr(t,e,i,r){if(!t)return r(e,i,"ltr",0);for(var n=!1,o=0;o<t.length;++o){var a=t[o];(a.from<i&&a.to>e||e==i&&a.to==e)&&(r(Math.max(a.from,e),Math.min(a.to,i),1==a.level?"rtl":"ltr",o),n=!0)}n||r(e,i,"ltr")}(He,wt||0,null==Ot?Yt:Ot,function(ce,Pe,Te,pe){var de="ltr"==Te,ue=ae(ce,de?"left":"right"),Ee=ae(Pe-1,de?"right":"left"),Di=null==wt&&0==ce,Pr=null==Ot&&Pe==Yt,Me=0==pe,hr=!He||pe==He.length-1;if(Ee.top-ue.top<=3){var Sr=(d?Di:Pr)&&Me?u:(de?ue:Ee).left;C(Sr,ue.top,((d?Pr:Di)&&hr?c:(de?Ee:ue).right)-Sr,ue.bottom)}else{var ii,De,Fi,Fo;de?(ii=d&&Di&&Me?u:ue.left,De=d?c:Ke(ce,Te,"before"),Fi=d?u:Ke(Pe,Te,"after"),Fo=d&&Pr&&hr?c:Ee.right):(ii=d?Ke(ce,Te,"before"):u,De=!d&&Di&&Me?c:ue.right,Fi=!d&&Pr&&hr?u:Ee.left,Fo=d?Ke(Pe,Te,"after"):c),C(ii,ue.top,De-ii,ue.bottom),ue.bottom<Ee.top&&C(u,ue.bottom,null,Ee.top),C(Fi,Ee.top,Fo-Fi,Ee.bottom)}(!ie||Ln(ue,ie)<0)&&(ie=ue),Ln(Ee,ie)<0&&(ie=Ee),(!xe||Ln(ue,xe)<0)&&(xe=ue),Ln(Ee,xe)<0&&(xe=Ee)}),{start:ie,end:xe}}var B=e.from(),I=e.to();if(B.line==I.line)N(B.line,B.ch,I.ch);else{var Y=Lt(n,B.line),V=Lt(n,I.line),st=Ye(Y)==Ye(V),ht=N(B.line,B.ch,st?Y.text.length+1:null).end,yt=N(I.line,st?0:null,I.ch).start;st&&(ht.top<yt.top-2?(C(ht.right,ht.top,null,ht.bottom),C(u,yt.top,yt.left,yt.bottom)):C(ht.right,ht.top,yt.left-ht.right,ht.bottom)),ht.bottom<yt.top&&C(u,ht.bottom,null,yt.top)}i.appendChild(o)}function so(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var i=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){t.hasFocus()||wi(t),e.cursorDiv.style.visibility=(i=!i)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}function os(t){t.hasFocus()||(t.display.input.focus(),t.state.focused||ao(t))}function lo(t){t.state.delayingBlurEvent=!0,setTimeout(function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,t.state.focused&&wi(t))},100)}function ao(t,e){t.state.delayingBlurEvent&&!t.state.draggingText&&(t.state.delayingBlurEvent=!1),"nocursor"!=t.options.readOnly&&(t.state.focused||(ne(t,"focus",t,e),t.state.focused=!0,U(t.display.wrapper,"CodeMirror-focused"),!t.curOp&&t.display.selForContextMenu!=t.doc.sel&&(t.display.input.reset(),zt&&setTimeout(function(){return t.display.input.reset(!0)},20)),t.display.input.receivedFocus()),so(t))}function wi(t,e){t.state.delayingBlurEvent||(t.state.focused&&(ne(t,"blur",t,e),t.state.focused=!1,xt(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150))}function kn(t){for(var e=t.display,i=e.lineDiv.offsetTop,r=Math.max(0,e.scroller.getBoundingClientRect().top),n=e.lineDiv.getBoundingClientRect().top,o=0,a=0;a<e.view.length;a++){var u=e.view[a],c=t.options.lineWrapping,d=void 0,C=0;if(!u.hidden){if(n+=u.line.height,Nt&&Gt<8){var N=u.node.offsetTop+u.node.offsetHeight;d=N-i,i=N}else{var B=u.node.getBoundingClientRect();d=B.bottom-B.top,!c&&u.text.firstChild&&(C=u.text.firstChild.getBoundingClientRect().right-B.left-1)}var I=u.line.height-d;if((I>.005||I<-.005)&&(n<r&&(o-=I),Ue(u.line,d),ss(u.line),u.rest))for(var Y=0;Y<u.rest.length;Y++)ss(u.rest[Y]);if(C>t.display.sizerWidth){var V=Math.ceil(C/xi(t.display));V>t.display.maxLineLength&&(t.display.maxLineLength=V,t.display.maxLine=u.line,t.display.maxLineChanged=!0)}}}Math.abs(o)>2&&(e.scroller.scrollTop+=o)}function ss(t){if(t.widgets)for(var e=0;e<t.widgets.length;++e){var i=t.widgets[e],r=i.node.parentNode;r&&(i.height=r.offsetHeight)}}function Nn(t,e,i){var r=i&&null!=i.top?Math.max(0,i.top):t.scroller.scrollTop;r=Math.floor(r-bn(t));var n=i&&null!=i.bottom?i.bottom:r+t.wrapper.clientHeight,o=or(e,r),a=or(e,n);if(i&&i.ensure){var u=i.ensure.from.line,c=i.ensure.to.line;u<o?(o=u,a=or(e,er(Lt(e,u))+t.wrapper.clientHeight)):Math.min(c,e.lastLine())>=a&&(o=or(e,er(Lt(e,c))-t.wrapper.clientHeight),a=c)}return{from:o,to:Math.max(a,o+1)}}function uo(t,e){var i=t.display,r=mi(t.display);e.top<0&&(e.top=0);var n=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:i.scroller.scrollTop,o=jn(t),a={};e.bottom-e.top>o&&(e.bottom=e.top+o);var u=t.doc.height+Jn(i),d=e.bottom>u-r;if(e.top<n)a.scrollTop=e.top<r?0:e.top;else if(e.bottom>n+o){var C=Math.min(e.top,(d?u:e.bottom)-o);C!=n&&(a.scrollTop=C)}var N=t.options.fixedGutter?0:i.gutters.offsetWidth,B=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:i.scroller.scrollLeft-N,I=Qr(t)-i.gutters.offsetWidth,Y=e.right-e.left>I;return Y&&(e.right=e.left+I),e.left<10?a.scrollLeft=0:e.left<B?a.scrollLeft=Math.max(0,e.left+N-(Y?0:10)):e.right>I+B-3&&(a.scrollLeft=e.right+(Y?0:10)-I),a}function fo(t,e){null!=e&&(Mn(t),t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+e)}function bi(t){Mn(t);var e=t.getCursor();t.curOp.scrollToPos={from:e,to:e,margin:t.options.cursorScrollMargin}}function Zi(t,e,i){(null!=e||null!=i)&&Mn(t),null!=e&&(t.curOp.scrollLeft=e),null!=i&&(t.curOp.scrollTop=i)}function Mn(t){var e=t.curOp.scrollToPos;e&&(t.curOp.scrollToPos=null,ls(t,$o(t,e.from),$o(t,e.to),e.margin))}function ls(t,e,i,r){var n=uo(t,{left:Math.min(e.left,i.left),top:Math.min(e.top,i.top)-r,right:Math.max(e.right,i.right),bottom:Math.max(e.bottom,i.bottom)+r});Zi(t,n.scrollLeft,n.scrollTop)}function Qi(t,e){Math.abs(t.doc.scrollTop-e)<2||(Ct||co(t,{top:e}),as(t,e,!0),Ct&&co(t),Vi(t,100))}function as(t,e,i){e=Math.max(0,Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,e)),(t.display.scroller.scrollTop!=e||i)&&(t.doc.scrollTop=e,t.display.scrollbars.setScrollTop(e),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e))}function qr(t,e,i,r){e=Math.max(0,Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth)),(!(i?e==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-e)<2)||r)&&(t.doc.scrollLeft=e,ds(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbars.setScrollLeft(e))}function Ji(t){var e=t.display,i=e.gutters.offsetWidth,r=Math.round(t.doc.height+Jn(t.display));return{clientHeight:e.scroller.clientHeight,viewHeight:e.wrapper.clientHeight,scrollWidth:e.scroller.scrollWidth,clientWidth:e.scroller.clientWidth,viewWidth:e.wrapper.clientWidth,barLeft:t.options.fixedGutter?i:0,docHeight:r,scrollHeight:r+ur(t)+e.barHeight,nativeBarWidth:e.nativeBarWidth,gutterWidth:i}}var $r=function(t,e,i){this.cm=i;var r=this.vert=gt("div",[gt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),n=this.horiz=gt("div",[gt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");r.tabIndex=n.tabIndex=-1,t(r),t(n),Mt(r,"scroll",function(){r.clientHeight&&e(r.scrollTop,"vertical")}),Mt(n,"scroll",function(){n.clientWidth&&e(n.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,Nt&&Gt<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};$r.prototype.update=function(t){var e=t.scrollWidth>t.clientWidth+1,i=t.scrollHeight>t.clientHeight+1,r=t.nativeBarWidth;return i?(this.vert.style.display="block",this.vert.style.bottom=e?r+"px":"0",this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+(t.viewHeight-(e?r:0)))+"px"):(this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0"),e?(this.horiz.style.display="block",this.horiz.style.right=i?r+"px":"0",this.horiz.style.left=t.barLeft+"px",this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+(t.viewWidth-t.barLeft-(i?r:0)))+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&t.clientHeight>0&&(0==r&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?r:0,bottom:e?r:0}},$r.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},$r.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},$r.prototype.zeroWidthHack=function(){this.horiz.style.height=this.vert.style.width=vt&&!A?"12px":"18px",this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new G,this.disableVert=new G},$r.prototype.enableZeroWidthBar=function(t,e,i){t.style.pointerEvents="auto",e.set(1e3,function r(){var n=t.getBoundingClientRect();("vert"==i?document.elementFromPoint(n.right-1,(n.top+n.bottom)/2):document.elementFromPoint((n.right+n.left)/2,n.bottom-1))!=t?t.style.pointerEvents="none":e.set(1e3,r)})},$r.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)};var ji=function(){};function Ci(t,e){e||(e=Ji(t));var i=t.display.barWidth,r=t.display.barHeight;us(t,e);for(var n=0;n<4&&i!=t.display.barWidth||r!=t.display.barHeight;n++)i!=t.display.barWidth&&t.options.lineWrapping&&kn(t),us(t,Ji(t)),i=t.display.barWidth,r=t.display.barHeight}function us(t,e){var i=t.display,r=i.scrollbars.update(e);i.sizer.style.paddingRight=(i.barWidth=r.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=r.bottom)+"px",i.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=r.bottom+"px",i.scrollbarFiller.style.width=r.right+"px"):i.scrollbarFiller.style.display="",r.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=r.bottom+"px",i.gutterFiller.style.width=e.gutterWidth+"px"):i.gutterFiller.style.display=""}ji.prototype.update=function(){return{bottom:0,right:0}},ji.prototype.setScrollLeft=function(){},ji.prototype.setScrollTop=function(){},ji.prototype.clear=function(){};var fs={native:$r,null:ji};function hs(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&xt(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new fs[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),Mt(e,"mousedown",function(){t.state.focused&&setTimeout(function(){return t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,i){"horizontal"==i?qr(t,e):Qi(t,e)},t),t.display.scrollbars.addClass&&U(t.display.wrapper,t.display.scrollbars.addClass)}var Jl=0;function ti(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Jl,markArrays:null},function kl(t){gi?gi.ops.push(t):t.ownsGroup=gi={ops:[t],delayedCallbacks:[]}}(t.curOp)}function ei(t){var e=t.curOp;e&&function Ml(t,e){var i=t.ownsGroup;if(i)try{!function Nl(t){var e=t.delayedCallbacks,i=0;do{for(;i<e.length;i++)e[i].call(null);for(var r=0;r<t.ops.length;r++){var n=t.ops[r];if(n.cursorActivityHandlers)for(;n.cursorActivityCalled<n.cursorActivityHandlers.length;)n.cursorActivityHandlers[n.cursorActivityCalled++].call(null,n.cm)}}while(i<e.length)}(i)}finally{gi=null,e(i)}}(e,function(i){for(var r=0;r<i.ops.length;r++)i.ops[r].cm.curOp=null;!function jl(t){for(var e=t.ops,i=0;i<e.length;i++)Vl(e[i]);for(var r=0;r<e.length;r++)ql(e[r]);for(var n=0;n<e.length;n++)$l(e[n]);for(var o=0;o<e.length;o++)ta(e[o]);for(var a=0;a<e.length;a++)ea(e[a])}(i)})}function Vl(t){var e=t.cm,i=e.display;(function ia(t){var e=t.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-e.scroller.clientWidth,e.heightForcer.style.height=ur(t)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=ur(t)+"px",e.scrollbarsClipped=!0)})(e),t.updateMaxLine&&Zn(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<i.viewFrom||t.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new On(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function ql(t){t.updatedDisplay=t.mustUpdate&&ho(t.cm,t.update)}function $l(t){var e=t.cm,i=e.display;t.updatedDisplay&&kn(e),t.barMeasure=Ji(e),i.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=Xo(e,i.maxLine,i.maxLine.text.length).left+3,e.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+t.adjustWidthTo+ur(e)+e.display.barWidth),t.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+t.adjustWidthTo-Qr(e))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=i.input.prepareSelection())}function ta(t){var e=t.cm;null!=t.adjustWidthTo&&(e.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<e.doc.scrollLeft&&qr(e,Math.min(e.display.scroller.scrollLeft,t.maxScrollLeft),!0),e.display.maxLineChanged=!1);var i=t.focus&&t.focus==P();t.preparedSelection&&e.display.input.showSelection(t.preparedSelection,i),(t.updatedDisplay||t.startHeight!=e.doc.height)&&Ci(e,t.barMeasure),t.updatedDisplay&&vo(e,t.barMeasure),t.selectionChanged&&so(e),e.state.focused&&t.updateInput&&e.display.input.reset(t.typing),i&&os(t.cm)}function ea(t){var e=t.cm,i=e.display,r=e.doc;if(t.updatedDisplay&&cs(e,t.update),null!=i.wheelStartX&&(null!=t.scrollTop||null!=t.scrollLeft||t.scrollToPos)&&(i.wheelStartX=i.wheelStartY=null),null!=t.scrollTop&&as(e,t.scrollTop,t.forceScroll),null!=t.scrollLeft&&qr(e,t.scrollLeft,!0,!0),t.scrollToPos){var n=function Kl(t,e,i,r){var n;null==r&&(r=0),!t.options.lineWrapping&&e==i&&(i="before"==e.sticky?q(e.line,e.ch+1,"before"):e,e=e.ch?q(e.line,"before"==e.sticky?e.ch-1:e.ch,"after"):e);for(var o=0;o<5;o++){var a=!1,u=rr(t,e),c=i&&i!=e?rr(t,i):u,d=uo(t,n={left:Math.min(u.left,c.left),top:Math.min(u.top,c.top)-r,right:Math.max(u.left,c.left),bottom:Math.max(u.bottom,c.bottom)+r}),C=t.doc.scrollTop,N=t.doc.scrollLeft;if(null!=d.scrollTop&&(Qi(t,d.scrollTop),Math.abs(t.doc.scrollTop-C)>1&&(a=!0)),null!=d.scrollLeft&&(qr(t,d.scrollLeft),Math.abs(t.doc.scrollLeft-N)>1&&(a=!0)),!a)break}return n}(e,Dt(r,t.scrollToPos.from),Dt(r,t.scrollToPos.to),t.scrollToPos.margin);!function Xl(t,e){if(!le(t,"scrollCursorIntoView")){var i=t.display,r=i.sizer.getBoundingClientRect(),n=null;if(e.top+r.top<0?n=!0:e.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(n=!1),null!=n&&!Z){var o=gt("div","\u200b",null,"position: absolute;\n                         top: "+(e.top-i.viewOffset-bn(t.display))+"px;\n                         height: "+(e.bottom-e.top+ur(t)+i.barHeight)+"px;\n                         left: "+e.left+"px; width: "+Math.max(2,e.right-e.left)+"px;");t.display.lineSpace.appendChild(o),o.scrollIntoView(n),t.display.lineSpace.removeChild(o)}}}(e,n)}var o=t.maybeHiddenMarkers,a=t.maybeUnhiddenMarkers;if(o)for(var u=0;u<o.length;++u)o[u].lines.length||ne(o[u],"hide");if(a)for(var c=0;c<a.length;++c)a[c].lines.length&&ne(a[c],"unhide");i.wrapper.offsetHeight&&(r.scrollTop=e.display.scroller.scrollTop),t.changeObjs&&ne(e,"changes",e,t.changeObjs),t.update&&t.update.finish()}function Xe(t,e){if(t.curOp)return e();ti(t);try{return e()}finally{ei(t)}}function ye(t,e){return function(){if(t.curOp)return e.apply(t,arguments);ti(t);try{return e.apply(t,arguments)}finally{ei(t)}}}function Ae(t){return function(){if(this.curOp)return t.apply(this,arguments);ti(this);try{return t.apply(this,arguments)}finally{ei(this)}}}function me(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);ti(e);try{return t.apply(this,arguments)}finally{ei(e)}}}function Vi(t,e){t.doc.highlightFrontier<t.display.viewTo&&t.state.highlight.set(e,O(ra,t))}function ra(t){var e=t.doc;if(!(e.highlightFrontier>=t.display.viewTo)){var i=+new Date+t.options.workTime,r=m(t,e.highlightFrontier),n=[];e.iter(r.line,Math.min(e.first+e.size,t.display.viewTo+500),function(o){if(r.line>=t.display.viewFrom){var a=o.styles,u=o.text.length>t.options.maxHighlightLength?_e(e.mode,r.state):null,c=v(t,o,r,!0);u&&(r.state=u),o.styles=c.styles;var d=o.styleClasses,C=c.classes;C?o.styleClasses=C:d&&(o.styleClasses=null);for(var N=!a||a.length!=o.styles.length||d!=C&&(!d||!C||d.bgClass!=C.bgClass||d.textClass!=C.textClass),B=0;!N&&B<a.length;++B)N=a[B]!=o.styles[B];N&&n.push(r.line),o.stateAfter=r.save(),r.nextLine()}else o.text.length<=t.options.maxHighlightLength&&S(t,o.text,r),o.stateAfter=r.line%5==0?r.save():null,r.nextLine();if(+new Date>i)return Vi(t,t.options.workDelay),!0}),e.highlightFrontier=r.line,e.modeFrontier=Math.max(e.modeFrontier,r.line),n.length&&Xe(t,function(){for(var o=0;o<n.length;o++)Ar(t,n[o],"text")})}}var On=function(t,e,i){var r=t.display;this.viewport=e,this.visible=Nn(r,t.doc,e),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=Qr(t),this.force=i,this.dims=ro(t),this.events=[]};function ho(t,e){var i=t.display,r=t.doc;if(e.editorIsHidden)return Dr(t),!1;if(!e.force&&e.visible.from>=i.viewFrom&&e.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&0==is(t))return!1;ps(t)&&(Dr(t),e.dims=ro(t));var n=r.first+r.size,o=Math.max(e.visible.from-t.options.viewportMargin,r.first),a=Math.min(n,e.visible.to+t.options.viewportMargin);i.viewFrom<o&&o-i.viewFrom<20&&(o=Math.max(r.first,i.viewFrom)),i.viewTo>a&&i.viewTo-a<20&&(a=Math.min(n,i.viewTo)),z&&(o=Ri(t.doc,o),a=Gi(t.doc,a));var u=o!=i.viewFrom||a!=i.viewTo||i.lastWrapHeight!=e.wrapperHeight||i.lastWrapWidth!=e.wrapperWidth;(function Ul(t,e,i){var r=t.display;0==r.view.length||e>=r.viewTo||i<=r.viewFrom?(r.view=wn(t,e,i),r.viewFrom=e):(r.viewFrom>e?r.view=wn(t,e,r.viewFrom).concat(r.view):r.viewFrom<e&&(r.view=r.view.slice(Vr(t,e))),r.viewFrom=e,r.viewTo<i?r.view=r.view.concat(wn(t,r.viewTo,i)):r.viewTo>i&&(r.view=r.view.slice(0,Vr(t,i)))),r.viewTo=i})(t,o,a),i.viewOffset=er(Lt(t.doc,i.viewFrom)),t.display.mover.style.top=i.viewOffset+"px";var c=is(t);if(!u&&0==c&&!e.force&&i.renderedView==i.view&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo))return!1;var d=function na(t){if(t.hasFocus())return null;var e=P();if(!e||!W(t.display.lineDiv,e))return null;var i={activeElt:e};if(window.getSelection){var r=window.getSelection();r.anchorNode&&r.extend&&W(t.display.lineDiv,r.anchorNode)&&(i.anchorNode=r.anchorNode,i.anchorOffset=r.anchorOffset,i.focusNode=r.focusNode,i.focusOffset=r.focusOffset)}return i}(t);return c>4&&(i.lineDiv.style.display="none"),function sa(t,e,i){var r=t.display,n=t.options.lineNumbers,o=r.lineDiv,a=o.firstChild;function u(Y){var V=Y.nextSibling;return zt&&vt&&t.display.currentWheelTarget==Y?Y.style.display="none":Y.parentNode.removeChild(Y),V}for(var c=r.view,d=r.viewFrom,C=0;C<c.length;C++){var N=c[C];if(!N.hidden)if(N.node&&N.node.parentNode==o){for(;a!=N.node;)a=u(a);var I=n&&null!=e&&e<=d&&N.lineNumber;N.changes&&(X(N.changes,"gutter")>-1&&(I=!1),Po(t,N,d,i)),I&&(ee(N.lineNumber),N.lineNumber.appendChild(document.createTextNode(Yr(t.options,d)))),a=N.node.nextSibling}else{var B=Fl(t,N,d,i);o.insertBefore(B,a)}d+=N.size}for(;a;)a=u(a)}(t,i.updateLineNumbers,e.dims),c>4&&(i.lineDiv.style.display=""),i.renderedView=i.view,function oa(t){if(t&&t.activeElt&&t.activeElt!=P()&&(t.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(t.activeElt.nodeName)&&t.anchorNode&&W(document.body,t.anchorNode)&&W(document.body,t.focusNode))){var e=window.getSelection(),i=document.createRange();i.setEnd(t.anchorNode,t.anchorOffset),i.collapse(!1),e.removeAllRanges(),e.addRange(i),e.extend(t.focusNode,t.focusOffset)}}(d),ee(i.cursorDiv),ee(i.selectionDiv),i.gutters.style.height=i.sizer.style.minHeight=0,u&&(i.lastWrapHeight=e.wrapperHeight,i.lastWrapWidth=e.wrapperWidth,Vi(t,400)),i.updateLineNumbers=null,!0}function cs(t,e){for(var i=e.viewport,r=!0;;r=!1){if(r&&t.options.lineWrapping&&e.oldDisplayWidth!=Qr(t))r&&(e.visible=Nn(t.display,t.doc,i));else if(i&&null!=i.top&&(i={top:Math.min(t.doc.height+Jn(t.display)-jn(t),i.top)}),e.visible=Nn(t.display,t.doc,i),e.visible.from>=t.display.viewFrom&&e.visible.to<=t.display.viewTo)break;if(!ho(t,e))break;kn(t);var n=Ji(t);Ki(t),Ci(t,n),vo(t,n),e.force=!1}e.signal(t,"update",t),(t.display.viewFrom!=t.display.reportedViewFrom||t.display.viewTo!=t.display.reportedViewTo)&&(e.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function co(t,e){var i=new On(t,e);if(ho(t,i)){kn(t),cs(t,i);var r=Ji(t);Ki(t),Ci(t,r),vo(t,r),i.finish()}}function po(t){t.sizer.style.marginLeft=t.gutters.offsetWidth+"px",ge(t,"gutterChanged",t)}function vo(t,e){t.display.sizer.style.minHeight=e.docHeight+"px",t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=e.docHeight+t.display.barHeight+ur(t)+"px"}function ds(t){var e=t.display,i=e.view;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var r=io(e)-e.scroller.scrollLeft+t.doc.scrollLeft,n=e.gutters.offsetWidth,o=r+"px",a=0;a<i.length;a++)if(!i[a].hidden){t.options.fixedGutter&&(i[a].gutter&&(i[a].gutter.style.left=o),i[a].gutterBackground&&(i[a].gutterBackground.style.left=o));var u=i[a].alignable;if(u)for(var c=0;c<u.length;c++)u[c].style.left=o}t.options.fixedGutter&&(e.gutters.style.left=r+n+"px")}}function ps(t){if(!t.options.lineNumbers)return!1;var e=t.doc,i=Yr(t.options,e.first+e.size-1),r=t.display;if(i.length!=r.lineNumChars){var n=r.measure.appendChild(gt("div",[gt("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=n.firstChild.offsetWidth,a=n.offsetWidth-o;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(o,r.lineGutter.offsetWidth-a)+1,r.lineNumWidth=r.lineNumInnerWidth+a,r.lineNumChars=r.lineNumInnerWidth?i.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",po(t.display),!0}return!1}function go(t,e){for(var i=[],r=!1,n=0;n<t.length;n++){var o=t[n],a=null;if("string"!=typeof o&&(a=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!e)continue;r=!0}i.push({className:o,style:a})}return e&&!r&&i.push({className:"CodeMirror-linenumbers",style:null}),i}function vs(t){var e=t.gutters,i=t.gutterSpecs;ee(e),t.lineGutter=null;for(var r=0;r<i.length;++r){var n=i[r],o=n.className,a=n.style,u=e.appendChild(gt("div",null,"CodeMirror-gutter "+o));a&&(u.style.cssText=a),"CodeMirror-linenumbers"==o&&(t.lineGutter=u,u.style.width=(t.lineNumWidth||1)+"px")}e.style.display=i.length?"":"none",po(t)}function qi(t){vs(t.display),We(t),ds(t)}function la(t,e,i,r){var n=this;this.input=i,n.scrollbarFiller=gt("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=gt("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=Rt("div",null,"CodeMirror-code"),n.selectionDiv=gt("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=gt("div",null,"CodeMirror-cursors"),n.measure=gt("div",null,"CodeMirror-measure"),n.lineMeasure=gt("div",null,"CodeMirror-measure"),n.lineSpace=Rt("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none");var o=Rt("div",[n.lineSpace],"CodeMirror-lines");n.mover=gt("div",[o],null,"position: relative"),n.sizer=gt("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=gt("div",null,null,"position: absolute; height: 50px; width: 1px;"),n.gutters=gt("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=gt("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=gt("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),n.wrapper.setAttribute("translate","no"),Nt&&Gt<8&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),!zt&&!(Ct&&dt)&&(n.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(n.wrapper):t(n.wrapper)),n.viewFrom=n.viewTo=e.first,n.reportedViewFrom=n.reportedViewTo=e.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,n.gutterSpecs=go(r.gutters,r.lineNumbers),vs(n),i.init(n)}On.prototype.signal=function(t,e){Ge(t,e)&&this.events.push(arguments)},On.prototype.finish=function(){for(var t=0;t<this.events.length;t++)ne.apply(null,this.events[t])};var _n=0,br=null;function gs(t){var e=t.wheelDeltaX,i=t.wheelDeltaY;return null==e&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(e=t.detail),null==i&&t.detail&&t.axis==t.VERTICAL_AXIS?i=t.detail:null==i&&(i=t.wheelDelta),{x:e,y:i}}function aa(t){var e=gs(t);return e.x*=br,e.y*=br,e}function ys(t,e){var i=gs(e),r=i.x,n=i.y,o=br;0===e.deltaMode&&(r=e.deltaX,n=e.deltaY,o=1);var a=t.display,u=a.scroller,d=u.scrollHeight>u.clientHeight;if(r&&u.scrollWidth>u.clientWidth||n&&d){if(n&&vt&&zt)t:for(var C=e.target,N=a.view;C!=u;C=C.parentNode)for(var B=0;B<N.length;B++)if(N[B].node==C){t.display.currentWheelTarget=C;break t}if(r&&!Ct&&!T&&null!=o)return n&&d&&Qi(t,Math.max(0,u.scrollTop+n*o)),qr(t,Math.max(0,u.scrollLeft+r*o)),(!n||n&&d)&&Se(e),void(a.wheelStartX=null);if(n&&null!=o){var I=n*o,Y=t.doc.scrollTop,V=Y+a.wrapper.clientHeight;I<0?Y=Math.max(0,Y+I-50):V=Math.min(t.doc.height,V+I+50),co(t,{top:Y,bottom:V})}_n<20&&0!==e.deltaMode&&(null==a.wheelStartX?(a.wheelStartX=u.scrollLeft,a.wheelStartY=u.scrollTop,a.wheelDX=r,a.wheelDY=n,setTimeout(function(){if(null!=a.wheelStartX){var st=u.scrollLeft-a.wheelStartX,ht=u.scrollTop-a.wheelStartY,yt=ht&&a.wheelDY&&ht/a.wheelDY||st&&a.wheelDX&&st/a.wheelDX;a.wheelStartX=a.wheelStartY=null,yt&&(br=(br*_n+yt)/(_n+1),++_n)}},200)):(a.wheelDX+=r,a.wheelDY+=n))}}Nt?br=-.53:Ct?br=15:g?br=-.7:_&&(br=-1/3);var Ze=function(t,e){this.ranges=t,this.primIndex=e};Ze.prototype.primary=function(){return this.ranges[this.primIndex]},Ze.prototype.equals=function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var e=0;e<this.ranges.length;e++){var i=this.ranges[e],r=t.ranges[e];if(!di(i.anchor,r.anchor)||!di(i.head,r.head))return!1}return!0},Ze.prototype.deepCopy=function(){for(var t=[],e=0;e<this.ranges.length;e++)t[e]=new te(Xr(this.ranges[e].anchor),Xr(this.ranges[e].head));return new Ze(t,this.primIndex)},Ze.prototype.somethingSelected=function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},Ze.prototype.contains=function(t,e){e||(e=t);for(var i=0;i<this.ranges.length;i++){var r=this.ranges[i];if(pt(e,r.from())>=0&&pt(t,r.to())<=0)return i}return-1};var te=function(t,e){this.anchor=t,this.head=e};function ir(t,e,i){var r=t&&t.options.selectionsMayTouch,n=e[i];e.sort(function(B,I){return pt(B.from(),I.from())}),i=X(e,n);for(var o=1;o<e.length;o++){var a=e[o],u=e[o-1],c=pt(u.to(),a.from());if(r&&!a.empty()?c>0:c>=0){var d=sr(u.from(),a.from()),C=Mr(u.to(),a.to()),N=u.empty()?a.from()==a.head:u.from()==u.head;o<=i&&--i,e.splice(--o,2,new te(N?C:d,N?d:C))}}return new Ze(e,i)}function Fr(t,e){return new Ze([new te(t,e||t)],0)}function Ir(t){return t.text?q(t.from.line+t.text.length-1,Tt(t.text).length+(1==t.text.length?t.from.ch:0)):t.to}function ms(t,e){if(pt(t,e.from)<0)return t;if(pt(t,e.to)<=0)return Ir(e);var i=t.line+e.text.length-(e.to.line-e.from.line)-1,r=t.ch;return t.line==e.to.line&&(r+=Ir(e).ch-e.to.ch),q(i,r)}function yo(t,e){for(var i=[],r=0;r<t.sel.ranges.length;r++){var n=t.sel.ranges[r];i.push(new te(ms(n.anchor,e),ms(n.head,e)))}return ir(t.cm,i,t.sel.primIndex)}function xs(t,e,i){return t.line==e.line?q(i.line,t.ch-e.ch+i.ch):q(i.line+(t.line-e.line),t.ch)}function mo(t){t.doc.mode=Bi(t.options,t.doc.modeOption),$i(t)}function $i(t){t.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),t.doc.modeFrontier=t.doc.highlightFrontier=t.doc.first,Vi(t,100),t.state.modeGen++,t.curOp&&We(t)}function ws(t,e){return 0==e.from.ch&&0==e.to.ch&&""==Tt(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function xo(t,e,i,r){function n(yt){return i?i[yt]:null}function o(yt,ct,wt){(function yl(t,e,i,r){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),yr(t),mr(t,i);var n=r?r(t):1;n!=t.height&&Ue(t,n)})(yt,ct,wt,r),ge(yt,"change",yt,e)}function a(yt,ct){for(var wt=[],Ot=yt;Ot<ct;++Ot)wt.push(new vi(d[Ot],n(Ot),r));return wt}var u=e.from,c=e.to,d=e.text,C=Lt(t,u.line),N=Lt(t,c.line),B=Tt(d),I=n(d.length-1),Y=c.line-u.line;if(e.full)t.insert(0,a(0,d.length)),t.remove(d.length,t.size-d.length);else if(ws(t,e)){var V=a(0,d.length-1);o(N,N.text,I),Y&&t.remove(u.line,Y),V.length&&t.insert(u.line,V)}else if(C==N)if(1==d.length)o(C,C.text.slice(0,u.ch)+B+C.text.slice(c.ch),I);else{var st=a(1,d.length-1);st.push(new vi(B+C.text.slice(c.ch),I,r)),o(C,C.text.slice(0,u.ch)+d[0],n(0)),t.insert(u.line+1,st)}else if(1==d.length)o(C,C.text.slice(0,u.ch)+d[0]+N.text.slice(c.ch),n(0)),t.remove(u.line+1,Y);else{o(C,C.text.slice(0,u.ch)+d[0],n(0)),o(N,B+N.text.slice(c.ch),I);var ht=a(1,d.length-1);Y>1&&t.remove(u.line+1,Y-1),t.insert(u.line+1,ht)}ge(t,"change",t,e)}function Wr(t,e,i){!function r(n,o,a){if(n.linked)for(var u=0;u<n.linked.length;++u){var c=n.linked[u];if(c.doc!=o){var d=a&&c.sharedHist;i&&!d||(e(c.doc,d),r(c.doc,n,d))}}}(t,null,!0)}function bs(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,no(t),mo(t),Cs(t),t.options.direction=e.direction,t.options.lineWrapping||Zn(t),t.options.mode=e.modeOption,We(t)}function Cs(t){("rtl"==t.doc.direction?U:xt)(t.display.lineDiv,"CodeMirror-rtl")}function An(t){this.done=[],this.undone=[],this.undoDepth=t?t.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t?t.maxGeneration:1}function wo(t,e){var i={from:Xr(e.from),to:Ir(e),text:ze(t,e.from,e.to)};return Ls(t,i,e.from.line,e.to.line+1),Wr(t,function(r){return Ls(r,i,e.from.line,e.to.line+1)},!0),i}function Ss(t){for(;t.length&&Tt(t).ranges;)t.pop()}function Ts(t,e,i,r){var n=t.history;n.undone.length=0;var a,u,o=+new Date;if((n.lastOp==r||n.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&n.lastModTime>o-(t.cm?t.cm.options.historyEventDelay:500)||"*"==e.origin.charAt(0)))&&(a=function ha(t,e){return e?(Ss(t.done),Tt(t.done)):t.done.length&&!Tt(t.done).ranges?Tt(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),Tt(t.done)):void 0}(n,n.lastOp==r)))u=Tt(a.changes),0==pt(e.from,e.to)&&0==pt(e.from,u.to)?u.to=Ir(e):a.changes.push(wo(t,e));else{var c=Tt(n.done);for((!c||!c.ranges)&&Dn(t.sel,n.done),a={changes:[wo(t,e)],generation:n.generation},n.done.push(a);n.done.length>n.undoDepth;)n.done.shift(),n.done[0].ranges||n.done.shift()}n.done.push(i),n.generation=++n.maxGeneration,n.lastModTime=n.lastSelTime=o,n.lastOp=n.lastSelOp=r,n.lastOrigin=n.lastSelOrigin=e.origin,u||ne(t,"historyAdded")}function Dn(t,e){var i=Tt(e);i&&i.ranges&&i.equals(t)||e.push(t)}function Ls(t,e,i,r){var n=e["spans_"+t.id],o=0;t.iter(Math.max(t.first,i),Math.min(t.first+t.size,r),function(a){a.markedSpans&&((n||(n=e["spans_"+t.id]={}))[o]=a.markedSpans),++o})}function pa(t){if(!t)return null;for(var e,i=0;i<t.length;++i)t[i].marker.explicitlyCleared?e||(e=t.slice(0,i)):e&&e.push(t[i]);return e?e.length?e:null:t}function ks(t,e){var i=function va(t,e){var i=e["spans_"+t.id];if(!i)return null;for(var r=[],n=0;n<e.text.length;++n)r.push(pa(i[n]));return r}(t,e),r=gr(t,e);if(!i)return r;if(!r)return i;for(var n=0;n<i.length;++n){var o=i[n],a=r[n];if(o&&a)t:for(var u=0;u<a.length;++u){for(var c=a[u],d=0;d<o.length;++d)if(o[d].marker==c.marker)continue t;o.push(c)}else a&&(i[n]=a)}return i}function Si(t,e,i){for(var r=[],n=0;n<t.length;++n){var o=t[n];if(o.ranges)r.push(i?Ze.prototype.deepCopy.call(o):o);else{var a=o.changes,u=[];r.push({changes:u});for(var c=0;c<a.length;++c){var d=a[c],C=void 0;if(u.push({from:d.from,to:d.to,text:d.text}),e)for(var N in d)(C=N.match(/^spans_(\d+)$/))&&X(e,Number(C[1]))>-1&&(Tt(u)[N]=d[N],delete d[N])}}}return r}function bo(t,e,i,r){if(r){var n=t.anchor;if(i){var o=pt(e,n)<0;o!=pt(i,n)<0?(n=e,e=i):o!=pt(e,i)<0&&(e=i)}return new te(n,e)}return new te(i||e,e)}function Fn(t,e,i,r,n){null==n&&(n=t.cm&&(t.cm.display.shift||t.extend)),Ne(t,new Ze([bo(t.sel.primary(),e,i,n)],0),r)}function Ns(t,e,i){for(var r=[],n=t.cm&&(t.cm.display.shift||t.extend),o=0;o<t.sel.ranges.length;o++)r[o]=bo(t.sel.ranges[o],e[o],null,n);Ne(t,ir(t.cm,r,t.sel.primIndex),i)}function Co(t,e,i,r){var n=t.sel.ranges.slice(0);n[e]=i,Ne(t,ir(t.cm,n,t.sel.primIndex),r)}function Ms(t,e,i,r){Ne(t,Fr(e,i),r)}function Os(t,e,i){var r=t.history.done,n=Tt(r);n&&n.ranges?(r[r.length-1]=e,In(t,e,i)):Ne(t,e,i)}function Ne(t,e,i){In(t,e,i),function da(t,e,i,r){var n=t.history,o=r&&r.origin;i==n.lastSelOp||o&&n.lastSelOrigin==o&&(n.lastModTime==n.lastSelTime&&n.lastOrigin==o||function ca(t,e,i,r){var n=e.charAt(0);return"*"==n||"+"==n&&i.ranges.length==r.ranges.length&&i.somethingSelected()==r.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}(t,o,Tt(n.done),e))?n.done[n.done.length-1]=e:Dn(e,n.done),n.lastSelTime=+new Date,n.lastSelOrigin=o,n.lastSelOp=i,r&&!1!==r.clearRedo&&Ss(n.undone)}(t,t.sel,t.cm?t.cm.curOp.id:NaN,i)}function In(t,e,i){(Ge(t,"beforeSelectionChange")||t.cm&&Ge(t.cm,"beforeSelectionChange"))&&(e=function ga(t,e,i){var r={ranges:e.ranges,update:function(n){this.ranges=[];for(var o=0;o<n.length;o++)this.ranges[o]=new te(Dt(t,n[o].anchor),Dt(t,n[o].head))},origin:i&&i.origin};return ne(t,"beforeSelectionChange",t,r),t.cm&&ne(t.cm,"beforeSelectionChange",t.cm,r),r.ranges!=e.ranges?ir(t.cm,r.ranges,r.ranges.length-1):e}(t,e,i));var r=i&&i.bias||(pt(e.primary().head,t.sel.primary().head)<0?-1:1);_s(t,Ds(t,e,r,!0)),(!i||!1!==i.scroll)&&t.cm&&"nocursor"!=t.cm.getOption("readOnly")&&bi(t.cm)}function _s(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,pn(t.cm)),ge(t,"cursorActivity",t))}function As(t){_s(t,Ds(t,t.sel,null,!1))}function Ds(t,e,i,r){for(var n,o=0;o<e.ranges.length;o++){var a=e.ranges[o],u=e.ranges.length==t.sel.ranges.length&&t.sel.ranges[o],c=Wn(t,a.anchor,u&&u.anchor,i,r),d=Wn(t,a.head,u&&u.head,i,r);(n||c!=a.anchor||d!=a.head)&&(n||(n=e.ranges.slice(0,o)),n[o]=new te(c,d))}return n?ir(t.cm,n,e.primIndex):e}function Ti(t,e,i,r,n){var o=Lt(t,e.line);if(o.markedSpans)for(var a=0;a<o.markedSpans.length;++a){var u=o.markedSpans[a],c=u.marker,d="selectLeft"in c?!c.selectLeft:c.inclusiveLeft,C="selectRight"in c?!c.selectRight:c.inclusiveRight;if((null==u.from||(d?u.from<=e.ch:u.from<e.ch))&&(null==u.to||(C?u.to>=e.ch:u.to>e.ch))){if(n&&(ne(c,"beforeCursorEnter"),c.explicitlyCleared)){if(o.markedSpans){--a;continue}break}if(!c.atomic)continue;if(i){var N=c.find(r<0?1:-1),B=void 0;if((r<0?C:d)&&(N=Fs(t,N,-r,N&&N.line==e.line?o:null)),N&&N.line==e.line&&(B=pt(N,i))&&(r<0?B<0:B>0))return Ti(t,N,e,r,n)}var I=c.find(r<0?-1:1);return(r<0?d:C)&&(I=Fs(t,I,r,I.line==e.line?o:null)),I?Ti(t,I,e,r,n):null}}return e}function Wn(t,e,i,r,n){var o=r||1;return Ti(t,e,i,o,n)||!n&&Ti(t,e,i,o,!0)||Ti(t,e,i,-o,n)||!n&&Ti(t,e,i,-o,!0)||(t.cantEdit=!0,q(t.first,0))}function Fs(t,e,i,r){return i<0&&0==e.ch?e.line>t.first?Dt(t,q(e.line-1)):null:i>0&&e.ch==(r||Lt(t,e.line)).text.length?e.line<t.first+t.size-1?q(e.line+1,0):null:new q(e.line,e.ch+i)}function Is(t){t.setSelection(q(t.firstLine(),0),q(t.lastLine()),lt)}function Ws(t,e,i){var r={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return r.canceled=!0}};return i&&(r.update=function(n,o,a,u){n&&(r.from=Dt(t,n)),o&&(r.to=Dt(t,o)),a&&(r.text=a),void 0!==u&&(r.origin=u)}),ne(t,"beforeChange",t,r),t.cm&&ne(t.cm,"beforeChange",t.cm,r),r.canceled?(t.cm&&(t.cm.curOp.updateInput=2),null):{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Li(t,e,i){if(t.cm){if(!t.cm.curOp)return ye(t.cm,Li)(t,e,i);if(t.cm.state.suppressEdits)return}if(!(Ge(t,"beforeChange")||t.cm&&Ge(t.cm,"beforeChange"))||(e=Ws(t,e,!0))){var r=rt&&!i&&function Je(t,e,i){var r=null;if(t.iter(e.line,i.line+1,function(I){if(I.markedSpans)for(var Y=0;Y<I.markedSpans.length;++Y){var V=I.markedSpans[Y].marker;V.readOnly&&(!r||-1==X(r,V))&&(r||(r=[])).push(V)}}),!r)return null;for(var n=[{from:e,to:i}],o=0;o<r.length;++o)for(var a=r[o],u=a.find(0),c=0;c<n.length;++c){var d=n[c];if(!(pt(d.to,u.from)<0||pt(d.from,u.to)>0)){var C=[c,1],N=pt(d.from,u.from),B=pt(d.to,u.to);(N<0||!a.inclusiveLeft&&!N)&&C.push({from:d.from,to:u.from}),(B>0||!a.inclusiveRight&&!B)&&C.push({from:u.to,to:d.to}),n.splice.apply(n,C),c+=C.length-3}}return n}(t,e.from,e.to);if(r)for(var n=r.length-1;n>=0;--n)Bs(t,{from:r[n].from,to:r[n].to,text:n?[""]:e.text,origin:e.origin});else Bs(t,e)}}function Bs(t,e){if(1!=e.text.length||""!=e.text[0]||0!=pt(e.from,e.to)){var i=yo(t,e);Ts(t,e,i,t.cm?t.cm.curOp.id:NaN),tn(t,e,i,gr(t,e));var r=[];Wr(t,function(n,o){!o&&-1==X(r,n.history)&&(Rs(n.history,e),r.push(n.history)),tn(n,e,null,gr(n,e))})}}function Bn(t,e,i){var r=t.cm&&t.cm.state.suppressEdits;if(!r||i){for(var o,n=t.history,a=t.sel,u="undo"==e?n.done:n.undone,c="undo"==e?n.undone:n.done,d=0;d<u.length&&(o=u[d],!(i?o.ranges&&!o.equals(t.sel):!o.ranges));d++);if(d!=u.length){for(n.lastOrigin=n.lastSelOrigin=null;;){if(!(o=u.pop()).ranges){if(r)return void u.push(o);break}if(Dn(o,c),i&&!o.equals(t.sel))return void Ne(t,o,{clearRedo:!1});a=o}var C=[];Dn(a,c),c.push({changes:C,generation:n.generation}),n.generation=o.generation||++n.maxGeneration;for(var N=Ge(t,"beforeChange")||t.cm&&Ge(t.cm,"beforeChange"),B=function(V){var st=o.changes[V];if(st.origin=e,N&&!Ws(t,st,!1))return u.length=0,{};C.push(wo(t,st));var ht=V?yo(t,st):Tt(u);tn(t,st,ht,ks(t,st)),!V&&t.cm&&t.cm.scrollIntoView({from:st.from,to:Ir(st)});var yt=[];Wr(t,function(ct,wt){!wt&&-1==X(yt,ct.history)&&(Rs(ct.history,st),yt.push(ct.history)),tn(ct,st,null,ks(ct,st))})},I=o.changes.length-1;I>=0;--I){var Y=B(I);if(Y)return Y.v}}}}function Hs(t,e){if(0!=e&&(t.first+=e,t.sel=new Ze(jt(t.sel.ranges,function(n){return new te(q(n.anchor.line+e,n.anchor.ch),q(n.head.line+e,n.head.ch))}),t.sel.primIndex),t.cm)){We(t.cm,t.first,t.first-e,e);for(var i=t.cm.display,r=i.viewFrom;r<i.viewTo;r++)Ar(t.cm,r,"gutter")}}function tn(t,e,i,r){if(t.cm&&!t.cm.curOp)return ye(t.cm,tn)(t,e,i,r);if(e.to.line<t.first)Hs(t,e.text.length-1-(e.to.line-e.from.line));else if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var n=e.text.length-1-(t.first-e.from.line);Hs(t,n),e={from:q(t.first,0),to:q(e.to.line+n,e.to.ch),text:[Tt(e.text)],origin:e.origin}}var o=t.lastLine();e.to.line>o&&(e={from:e.from,to:q(o,Lt(t,o).text.length),text:[e.text[0]],origin:e.origin}),e.removed=ze(t,e.from,e.to),i||(i=yo(t,e)),t.cm?function ya(t,e,i){var r=t.doc,n=t.display,o=e.from,a=e.to,u=!1,c=o.line;t.options.lineWrapping||(c=$t(Ye(Lt(r,o.line))),r.iter(c,a.line+1,function(I){if(I==n.maxLine)return u=!0,!0})),r.sel.contains(e.from,e.to)>-1&&pn(t),xo(r,e,i,rs(t)),t.options.lineWrapping||(r.iter(c,o.line+e.text.length,function(I){var Y=pi(I);Y>n.maxLineLength&&(n.maxLine=I,n.maxLineLength=Y,n.maxLineChanged=!0,u=!1)}),u&&(t.curOp.updateMaxLine=!0)),function et(t,e){if(t.modeFrontier=Math.min(t.modeFrontier,e),!(t.highlightFrontier<e-10)){for(var i=t.first,r=e-1;r>i;r--){var n=Lt(t,r).stateAfter;if(n&&(!(n instanceof f)||r+n.lookAhead<e)){i=r+1;break}}t.highlightFrontier=Math.min(t.highlightFrontier,i)}}(r,o.line),Vi(t,400);var d=e.text.length-(a.line-o.line)-1;e.full?We(t):o.line!=a.line||1!=e.text.length||ws(t.doc,e)?We(t,o.line,a.line+1,d):Ar(t,o.line,"text");var C=Ge(t,"changes"),N=Ge(t,"change");if(N||C){var B={from:o,to:a,text:e.text,removed:e.removed,origin:e.origin};N&&ge(t,"change",t,B),C&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(B)}t.display.selForContextMenu=null}(t.cm,e,r):xo(t,e,r),In(t,i,lt),t.cantEdit&&Wn(t,q(t.firstLine(),0))&&(t.cantEdit=!1)}}function ki(t,e,i,r,n){var o;r||(r=i),pt(r,i)<0&&(i=(o=[r,i])[0],r=o[1]),"string"==typeof e&&(e=t.splitLines(e)),Li(t,{from:i,to:r,text:e,origin:n})}function Ps(t,e,i,r){i<t.line?t.line+=r:e<t.line&&(t.line=e,t.ch=0)}function Es(t,e,i,r){for(var n=0;n<t.length;++n){var o=t[n],a=!0;if(o.ranges){o.copied||((o=t[n]=o.deepCopy()).copied=!0);for(var u=0;u<o.ranges.length;u++)Ps(o.ranges[u].anchor,e,i,r),Ps(o.ranges[u].head,e,i,r)}else{for(var c=0;c<o.changes.length;++c){var d=o.changes[c];if(i<d.from.line)d.from=q(d.from.line+r,d.from.ch),d.to=q(d.to.line+r,d.to.ch);else if(e<=d.to.line){a=!1;break}}a||(t.splice(0,n+1),n=0)}}}function Rs(t,e){var i=e.from.line,r=e.to.line,n=e.text.length-(r-i)-1;Es(t.done,i,r,n),Es(t.undone,i,r,n)}function en(t,e,i,r){var n=e,o=e;return"number"==typeof e?o=Lt(t,ve(t,e)):n=$t(e),null==n?null:(r(o,n)&&t.cm&&Ar(t.cm,n,i),o)}function rn(t){this.lines=t,this.parent=null;for(var e=0,i=0;i<t.length;++i)t[i].parent=this,e+=t[i].height;this.height=e}function nn(t){this.children=t;for(var e=0,i=0,r=0;r<t.length;++r){var n=t[r];e+=n.chunkSize(),i+=n.height,n.parent=this}this.size=e,this.height=i,this.parent=null}te.prototype.from=function(){return sr(this.anchor,this.head)},te.prototype.to=function(){return Mr(this.anchor,this.head)},te.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},rn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var i=t,r=t+e;i<r;++i){var n=this.lines[i];this.height-=n.height,ml(n),ge(n,"delete")}this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,i){this.height+=i,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var r=0;r<e.length;++r)e[r].parent=this},iterN:function(t,e,i){for(var r=t+e;t<r;++t)if(i(this.lines[t]))return!0}},nn.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var i=0;i<this.children.length;++i){var r=this.children[i],n=r.chunkSize();if(t<n){var o=Math.min(e,n-t),a=r.height;if(r.removeInner(t,o),this.height-=a-r.height,n==o&&(this.children.splice(i--,1),r.parent=null),0==(e-=o))break;t=0}else t-=n}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof rn))){var u=[];this.collapse(u),this.children=[new rn(u)],this.children[0].parent=this}},collapse:function(t){for(var e=0;e<this.children.length;++e)this.children[e].collapse(t)},insertInner:function(t,e,i){this.size+=e.length,this.height+=i;for(var r=0;r<this.children.length;++r){var n=this.children[r],o=n.chunkSize();if(t<=o){if(n.insertInner(t,e,i),n.lines&&n.lines.length>50){for(var a=n.lines.length%25+25,u=a;u<n.lines.length;){var c=new rn(n.lines.slice(u,u+=25));n.height-=c.height,this.children.splice(++r,0,c),c.parent=this}n.lines=n.lines.slice(0,a),this.maybeSpill()}break}t-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var i=new nn(t.children.splice(t.children.length-5,5));if(t.parent){t.size-=i.size,t.height-=i.height;var n=X(t.parent.children,t);t.parent.children.splice(n+1,0,i)}else{var r=new nn(t.children);r.parent=t,t.children=[r,i],t=r}i.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,i){for(var r=0;r<this.children.length;++r){var n=this.children[r],o=n.chunkSize();if(t<o){var a=Math.min(e,o-t);if(n.iterN(t,a,i))return!0;if(0==(e-=a))break;t=0}else t-=o}}};var on=function(t,e,i){if(i)for(var r in i)i.hasOwnProperty(r)&&(this[r]=i[r]);this.doc=t,this.node=e};function Gs(t,e,i){er(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&fo(t,i)}on.prototype.clear=function(){var t=this.doc.cm,e=this.line.widgets,i=this.line,r=$t(i);if(null!=r&&e){for(var n=0;n<e.length;++n)e[n]==this&&e.splice(n--,1);e.length||(i.widgets=null);var o=Yi(this);Ue(i,Math.max(0,i.height-o)),t&&(Xe(t,function(){Gs(t,i,-o),Ar(t,r,"widget")}),ge(t,"lineWidgetCleared",t,this,r))}},on.prototype.changed=function(){var t=this,e=this.height,i=this.doc.cm,r=this.line;this.height=null;var n=Yi(this)-e;!n||(tr(this.doc,r)||Ue(r,r.height+n),i&&Xe(i,function(){i.curOp.forceUpdate=!0,Gs(i,r,n),ge(i,"lineWidgetChanged",i,t,$t(r))}))},dr(on);var zs=0,Br=function(t,e){this.lines=[],this.type=e,this.doc=t,this.id=++zs};function Ni(t,e,i,r,n){if(r&&r.shared)return function xa(t,e,i,r,n){(r=D(r)).shared=!1;var o=[Ni(t,e,i,r,n)],a=o[0],u=r.widgetNode;return Wr(t,function(c){u&&(r.widgetNode=u.cloneNode(!0)),o.push(Ni(c,Dt(c,e),Dt(c,i),r,n));for(var d=0;d<c.linked.length;++d)if(c.linked[d].isParent)return;a=Tt(o)}),new sn(o,a)}(t,e,i,r,n);if(t.cm&&!t.cm.curOp)return ye(t.cm,Ni)(t,e,i,r,n);var o=new Br(t,n),a=pt(e,i);if(r&&D(r,o,!1),a>0||0==a&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=Rt("span",[o.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(Ei(t,e.line,e,i,o)||e.line!=i.line&&Ei(t,i.line,e,i,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");!function tt(){z=!0}()}o.addToHistory&&Ts(t,{from:e,to:i,origin:"markText"},t.sel,NaN);var d,u=e.line,c=t.cm;if(t.iter(u,i.line+1,function(N){c&&o.collapsed&&!c.options.lineWrapping&&Ye(N)==c.display.maxLine&&(d=!0),o.collapsed&&u!=e.line&&Ue(N,0),function Ft(t,e,i){var r=i&&window.WeakSet&&(i.markedSpans||(i.markedSpans=new WeakSet));r&&t.markedSpans&&r.has(t.markedSpans)?t.markedSpans.push(e):(t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],r&&r.add(t.markedSpans)),e.marker.attachLine(t)}(N,new ut(o,u==e.line?e.ch:null,u==i.line?i.ch:null),t.cm&&t.cm.curOp),++u}),o.collapsed&&t.iter(e.line,i.line+1,function(N){tr(t,N)&&Ue(N,0)}),o.clearOnEnter&&Mt(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(function bt(){rt=!0}(),(t.history.done.length||t.history.undone.length)&&t.clearHistory()),o.collapsed&&(o.id=++zs,o.atomic=!0),c){if(d&&(c.curOp.updateMaxLine=!0),o.collapsed)We(c,e.line,i.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var C=e.line;C<=i.line;C++)Ar(c,C,"text");o.atomic&&As(c.doc),ge(c,"markerAdded",c,o)}return o}Br.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,e=t&&!t.curOp;if(e&&ti(t),Ge(this,"clear")){var i=this.find();i&&ge(this,"clear",i.from,i.to)}for(var r=null,n=null,o=0;o<this.lines.length;++o){var a=this.lines[o],u=it(a.markedSpans,this);t&&!this.collapsed?Ar(t,$t(a),"text"):t&&(null!=u.to&&(n=$t(a)),null!=u.from&&(r=$t(a))),a.markedSpans=Ht(a.markedSpans,u),null==u.from&&this.collapsed&&!tr(this.doc,a)&&t&&Ue(a,mi(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var c=0;c<this.lines.length;++c){var d=Ye(this.lines[c]),C=pi(d);C>t.display.maxLineLength&&(t.display.maxLine=d,t.display.maxLineLength=C,t.display.maxLineChanged=!0)}null!=r&&t&&this.collapsed&&We(t,r,n+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&As(t.doc)),t&&ge(t,"markerCleared",t,this,r,n),e&&ei(t),this.parent&&this.parent.clear()}},Br.prototype.find=function(t,e){null==t&&"bookmark"==this.type&&(t=1);for(var i,r,n=0;n<this.lines.length;++n){var o=this.lines[n],a=it(o.markedSpans,this);if(null!=a.from&&(i=q(e?o:$t(o),a.from),-1==t))return i;if(null!=a.to&&(r=q(e?o:$t(o),a.to),1==t))return r}return i&&{from:i,to:r}},Br.prototype.changed=function(){var t=this,e=this.find(-1,!0),i=this,r=this.doc.cm;!e||!r||Xe(r,function(){var n=e.line,o=$t(e.line),a=Vn(r,o);if(a&&(Qo(a),r.curOp.selectionChanged=r.curOp.forceUpdate=!0),r.curOp.updateMaxLine=!0,!tr(i.doc,n)&&null!=i.height){var u=i.height;i.height=null;var c=Yi(i)-u;c&&Ue(n,n.height+c)}ge(r,"markerChanged",r,t)})},Br.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(!e.maybeHiddenMarkers||-1==X(e.maybeHiddenMarkers,this))&&(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},Br.prototype.detachLine=function(t){if(this.lines.splice(X(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}},dr(Br);var sn=function(t,e){this.markers=t,this.primary=e;for(var i=0;i<t.length;++i)t[i].parent=this};function Us(t){return t.findMarks(q(t.first,0),t.clipPos(q(t.lastLine())),function(e){return e.parent})}function ba(t){for(var e=function(r){var n=t[r],o=[n.primary.doc];Wr(n.primary.doc,function(c){return o.push(c)});for(var a=0;a<n.markers.length;a++){var u=n.markers[a];-1==X(o,u.doc)&&(u.parent=null,n.markers.splice(a--,1))}},i=0;i<t.length;i++)e(i)}sn.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();ge(this,"clear")}},sn.prototype.find=function(t,e){return this.primary.find(t,e)},dr(sn);var Ca=0,Be=function(t,e,i,r,n){if(!(this instanceof Be))return new Be(t,e,i,r,n);null==i&&(i=0),nn.call(this,[new rn([new vi("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=i;var o=q(i,0);this.sel=Fr(o),this.history=new An(null),this.id=++Ca,this.modeOption=e,this.lineSep=r,this.direction="rtl"==n?"rtl":"ltr",this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),xo(this,{from:o,to:o,text:t}),Ne(this,Fr(o),lt)};Be.prototype=fe(nn.prototype,{constructor:Be,iter:function(t,e,i){i?this.iterN(t-this.first,e-t,i):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var i=0,r=0;r<e.length;++r)i+=e[r].height;this.insertInner(t-this.first,e,i)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=Hi(this,this.first,this.first+this.size);return!1===t?e:e.join(t||this.lineSeparator())},setValue:me(function(t){var e=q(this.first,0),i=this.first+this.size-1;Li(this,{from:e,to:q(i,Lt(this,i).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&Zi(this.cm,0,0),Ne(this,Fr(e),lt)}),replaceRange:function(t,e,i,r){ki(this,t,e=Dt(this,e),i=i?Dt(this,i):e,r)},getRange:function(t,e,i){var r=ze(this,Dt(this,t),Dt(this,e));return!1===i?r:r.join(""===i?"":i||this.lineSeparator())},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){if(Nr(this,t))return Lt(this,t)},getLineNumber:function(t){return $t(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=Lt(this,t)),Ye(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return Dt(this,t)},getCursor:function(t){var e=this.sel.primary();return null==t||"head"==t?e.head:"anchor"==t?e.anchor:"end"==t||"to"==t||!1===t?e.to():e.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:me(function(t,e,i){Ms(this,Dt(this,"number"==typeof t?q(t,e||0):t),null,i)}),setSelection:me(function(t,e,i){Ms(this,Dt(this,t),Dt(this,e||t),i)}),extendSelection:me(function(t,e,i){Fn(this,Dt(this,t),e&&Dt(this,e),i)}),extendSelections:me(function(t,e){Ns(this,l(this,t),e)}),extendSelectionsBy:me(function(t,e){Ns(this,l(this,jt(this.sel.ranges,t)),e)}),setSelections:me(function(t,e,i){if(t.length){for(var r=[],n=0;n<t.length;n++)r[n]=new te(Dt(this,t[n].anchor),Dt(this,t[n].head||t[n].anchor));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),Ne(this,ir(this.cm,r,e),i)}}),addSelection:me(function(t,e,i){var r=this.sel.ranges.slice(0);r.push(new te(Dt(this,t),Dt(this,e||t))),Ne(this,ir(this.cm,r,r.length-1),i)}),getSelection:function(t){for(var i,e=this.sel.ranges,r=0;r<e.length;r++){var n=ze(this,e[r].from(),e[r].to());i=i?i.concat(n):n}return!1===t?i:i.join(t||this.lineSeparator())},getSelections:function(t){for(var e=[],i=this.sel.ranges,r=0;r<i.length;r++){var n=ze(this,i[r].from(),i[r].to());!1!==t&&(n=n.join(t||this.lineSeparator())),e[r]=n}return e},replaceSelection:function(t,e,i){for(var r=[],n=0;n<this.sel.ranges.length;n++)r[n]=t;this.replaceSelections(r,e,i||"+input")},replaceSelections:me(function(t,e,i){for(var r=[],n=this.sel,o=0;o<n.ranges.length;o++){var a=n.ranges[o];r[o]={from:a.from(),to:a.to(),text:this.splitLines(t[o]),origin:i}}for(var u=e&&"end"!=e&&function ua(t,e,i){for(var r=[],n=q(t.first,0),o=n,a=0;a<e.length;a++){var u=e[a],c=xs(u.from,n,o),d=xs(Ir(u),n,o);if(n=u.to,o=d,"around"==i){var C=t.sel.ranges[a],N=pt(C.head,C.anchor)<0;r[a]=new te(N?d:c,N?c:d)}else r[a]=new te(c,c)}return new Ze(r,t.sel.primIndex)}(this,r,e),c=r.length-1;c>=0;c--)Li(this,r[c]);u?Os(this,u):this.cm&&bi(this.cm)}),undo:me(function(){Bn(this,"undo")}),redo:me(function(){Bn(this,"redo")}),undoSelection:me(function(){Bn(this,"undo",!0)}),redoSelection:me(function(){Bn(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,e=0,i=0,r=0;r<t.done.length;r++)t.done[r].ranges||++e;for(var n=0;n<t.undone.length;n++)t.undone[n].ranges||++i;return{undo:e,redo:i}},clearHistory:function(){var t=this;this.history=new An(this.history),Wr(this,function(e){return e.history=t.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:Si(this.history.done),undone:Si(this.history.undone)}},setHistory:function(t){var e=this.history=new An(this.history);e.done=Si(t.done.slice(0),null,!0),e.undone=Si(t.undone.slice(0),null,!0)},setGutterMarker:me(function(t,e,i){return en(this,t,"gutter",function(r){var n=r.gutterMarkers||(r.gutterMarkers={});return n[e]=i,!i&&cr(n)&&(r.gutterMarkers=null),!0})}),clearGutter:me(function(t){var e=this;this.iter(function(i){i.gutterMarkers&&i.gutterMarkers[t]&&en(e,i,"gutter",function(){return i.gutterMarkers[t]=null,cr(i.gutterMarkers)&&(i.gutterMarkers=null),!0})})}),lineInfo:function(t){var e;if("number"==typeof t){if(!(Nr(this,t)&&(e=t,t=Lt(this,t))))return null}else if(null==(e=$t(t)))return null;return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:me(function(t,e,i){return en(this,t,"gutter"==e?"gutter":"class",function(r){var n="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass";if(r[n]){if(Wt(i).test(r[n]))return!1;r[n]+=" "+i}else r[n]=i;return!0})}),removeLineClass:me(function(t,e,i){return en(this,t,"gutter"==e?"gutter":"class",function(r){var n="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass",o=r[n];if(!o)return!1;if(null==i)r[n]=null;else{var a=o.match(Wt(i));if(!a)return!1;var u=a.index+a[0].length;r[n]=o.slice(0,a.index)+(a.index&&u!=o.length?" ":"")+o.slice(u)||null}return!0})}),addLineWidget:me(function(t,e,i){return function ma(t,e,i,r){var n=new on(t,i,r),o=t.cm;return o&&n.noHScroll&&(o.display.alignWidgets=!0),en(t,e,"widget",function(a){var u=a.widgets||(a.widgets=[]);if(null==n.insertAt?u.push(n):u.splice(Math.min(u.length,Math.max(0,n.insertAt)),0,n),n.line=a,o&&!tr(t,a)){var c=er(a)<t.scrollTop;Ue(a,a.height+Yi(n)),c&&fo(o,n.height),o.curOp.forceUpdate=!0}return!0}),o&&ge(o,"lineWidgetAdded",o,n,"number"==typeof e?e:$t(e)),n}(this,t,e,i)}),removeLineWidget:function(t){t.clear()},markText:function(t,e,i){return Ni(this,Dt(this,t),Dt(this,e),i,i&&i.type||"range")},setBookmark:function(t,e){var i={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared,handleMouseEvents:e&&e.handleMouseEvents};return Ni(this,t=Dt(this,t),t,i,"bookmark")},findMarksAt:function(t){var e=[],i=Lt(this,(t=Dt(this,t)).line).markedSpans;if(i)for(var r=0;r<i.length;++r){var n=i[r];(null==n.from||n.from<=t.ch)&&(null==n.to||n.to>=t.ch)&&e.push(n.marker.parent||n.marker)}return e},findMarks:function(t,e,i){t=Dt(this,t),e=Dt(this,e);var r=[],n=t.line;return this.iter(t.line,e.line+1,function(o){var a=o.markedSpans;if(a)for(var u=0;u<a.length;u++){var c=a[u];!(null!=c.to&&n==t.line&&t.ch>=c.to||null==c.from&&n!=t.line||null!=c.from&&n==e.line&&c.from>=e.ch)&&(!i||i(c.marker))&&r.push(c.marker.parent||c.marker)}++n}),r},getAllMarks:function(){var t=[];return this.iter(function(e){var i=e.markedSpans;if(i)for(var r=0;r<i.length;++r)null!=i[r].from&&t.push(i[r].marker)}),t},posFromIndex:function(t){var e,i=this.first,r=this.lineSeparator().length;return this.iter(function(n){var o=n.text.length+r;if(o>t)return e=t,!0;t-=o,++i}),Dt(this,q(i,e))},indexFromPos:function(t){var e=(t=Dt(this,t)).ch;if(t.line<this.first||t.ch<0)return 0;var i=this.lineSeparator().length;return this.iter(this.first,t.line,function(r){e+=r.text.length+i}),e},copy:function(t){var e=new Be(Hi(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,i=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<i&&(i=t.to);var r=new Be(Hi(this,e,i),t.mode||this.modeOption,e,this.lineSep,this.direction);return t.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:t.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],function wa(t,e){for(var i=0;i<e.length;i++){var r=e[i],n=r.find(),o=t.clipPos(n.from),a=t.clipPos(n.to);if(pt(o,a)){var u=Ni(t,o,a,r.primary,r.primary.type);r.markers.push(u),u.parent=r}}}(r,Us(this)),r},unlinkDoc:function(t){if(t instanceof oe&&(t=t.doc),this.linked)for(var e=0;e<this.linked.length;++e)if(this.linked[e].doc==t){this.linked.splice(e,1),t.unlinkDoc(this),ba(Us(this));break}if(t.history==this.history){var r=[t.id];Wr(t,function(n){return r.push(n.id)},!0),t.history=new An(null),t.history.done=Si(this.history.done,r),t.history.undone=Si(this.history.undone,r)}},iterLinkedDocs:function(t){Wr(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):ai(t)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:me(function(t){"rtl"!=t&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter(function(e){return e.order=null}),this.cm&&function fa(t){Xe(t,function(){Cs(t),We(t)})}(this.cm))})}),Be.prototype.eachLine=Be.prototype.iter;var Ys=0;function Sa(t){var e=this;if(Xs(e),!le(e,t)&&!wr(e.display,t)){Se(t),Nt&&(Ys=+new Date);var i=jr(e,t,!0),r=t.dataTransfer.files;if(i&&!e.isReadOnly())if(r&&r.length&&window.FileReader&&window.File)for(var n=r.length,o=Array(n),a=0,u=function(){++a==n&&ye(e,function(){var I={from:i=Dt(e.doc,i),to:i,text:e.doc.splitLines(o.filter(function(Y){return null!=Y}).join(e.doc.lineSeparator())),origin:"paste"};Li(e.doc,I),Os(e.doc,Fr(Dt(e.doc,i),Dt(e.doc,Ir(I))))})()},c=function(I,Y){if(e.options.allowDropFileTypes&&-1==X(e.options.allowDropFileTypes,I.type))u();else{var V=new FileReader;V.onerror=function(){return u()},V.onload=function(){var st=V.result;/[\x00-\x08\x0e-\x1f]{2}/.test(st)||(o[Y]=st),u()},V.readAsText(I)}},d=0;d<r.length;d++)c(r[d],d);else{if(e.state.draggingText&&e.doc.sel.contains(i)>-1)return e.state.draggingText(t),void setTimeout(function(){return e.display.input.focus()},20);try{var C=t.dataTransfer.getData("Text");if(C){var N;if(e.state.draggingText&&!e.state.draggingText.copy&&(N=e.listSelections()),In(e.doc,Fr(i,i)),N)for(var B=0;B<N.length;++B)ki(e.doc,"",N[B].anchor,N[B].head,"drag");e.replaceSelection(C,"around","paste"),e.display.input.focus()}}catch(I){}}}}function Xs(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function Ks(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),i=[],r=0;r<e.length;r++){var n=e[r].CodeMirror;n&&i.push(n)}i.length&&i[0].operation(function(){for(var o=0;o<i.length;o++)t(i[o])})}}var Zs=!1;function Ma(t){var e=t.display;e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,e.scrollbarsClipped=!1,t.setSize()}for(var Hr={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},ln=0;ln<10;ln++)Hr[ln+48]=Hr[ln+96]=String(ln);for(var Hn=65;Hn<=90;Hn++)Hr[Hn]=String.fromCharCode(Hn);for(var an=1;an<=12;an++)Hr[an+111]=Hr[an+63235]="F"+an;var Cr={};function Oa(t){var e=t.split(/-(?!$)/);t=e[e.length-1];for(var i,r,n,o,a=0;a<e.length-1;a++){var u=e[a];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))r=!0;else{if(!/^s(hift)?$/i.test(u))throw new Error("Unrecognized modifier name: "+u);n=!0}}return i&&(t="Alt-"+t),r&&(t="Ctrl-"+t),o&&(t="Cmd-"+t),n&&(t="Shift-"+t),t}function _a(t){var e={};for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];if(/^(name|fallthrough|(de|at)tach)$/.test(i))continue;if("..."==r){delete t[i];continue}for(var n=jt(i.split(" "),Oa),o=0;o<n.length;o++){var a=void 0,u=void 0;o==n.length-1?(u=n.join(" "),a=r):(u=n.slice(0,o+1).join(" "),a="...");var c=e[u];if(c){if(c!=a)throw new Error("Inconsistent bindings for "+u)}else e[u]=a}delete t[i]}for(var d in e)t[d]=e[d];return t}function Mi(t,e,i,r){var n=(e=Pn(e)).call?e.call(t,r):e[t];if(!1===n)return"nothing";if("..."===n)return"multi";if(null!=n&&i(n))return"handled";if(e.fallthrough){if("[object Array]"!=Object.prototype.toString.call(e.fallthrough))return Mi(t,e.fallthrough,i,r);for(var o=0;o<e.fallthrough.length;o++){var a=Mi(t,e.fallthrough[o],i,r);if(a)return a}}}function Qs(t){var e="string"==typeof t?t:Hr[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Js(t,e,i){var r=t;return e.altKey&&"Alt"!=r&&(t="Alt-"+t),(It?e.metaKey:e.ctrlKey)&&"Ctrl"!=r&&(t="Ctrl-"+t),(It?e.ctrlKey:e.metaKey)&&"Mod"!=r&&(t="Cmd-"+t),!i&&e.shiftKey&&"Shift"!=r&&(t="Shift-"+t),t}function js(t,e){if(T&&34==t.keyCode&&t.char)return!1;var i=Hr[t.keyCode];return null!=i&&!t.altGraphKey&&(3==t.keyCode&&t.code&&(i=t.code),Js(i,t,e))}function Pn(t){return"string"==typeof t?Cr[t]:t}function Oi(t,e){for(var i=t.doc.sel.ranges,r=[],n=0;n<i.length;n++){for(var o=e(i[n]);r.length&&pt(o.from,Tt(r).to)<=0;){var a=r.pop();if(pt(a.from,o.from)<0){o.from=a.from;break}}r.push(o)}Xe(t,function(){for(var u=r.length-1;u>=0;u--)ki(t.doc,"",r[u].from,r[u].to,"+delete");bi(t)})}function So(t,e,i){var r=Er(t.text,e+i,i);return r<0||r>t.text.length?null:r}function To(t,e,i){var r=So(t,e.ch,i);return null==r?null:new q(e.line,r,i<0?"after":"before")}function Lo(t,e,i,r,n){if(t){"rtl"==e.doc.direction&&(n=-n);var o=be(i,e.doc.direction);if(o){var d,a=n<0?Tt(o):o[0],c=n<0==(1==a.level)?"after":"before";if(a.level>0||"rtl"==e.doc.direction){var C=yi(e,i),N=fr(e,C,d=n<0?i.text.length-1:0).top;d=Ve(function(B){return fr(e,C,B).top==N},n<0==(1==a.level)?a.from:a.to-1,d),"before"==c&&(d=So(i,d,1))}else d=n<0?a.to:a.from;return new q(r,d,c)}}return new q(r,n<0?i.text.length:0,n<0?"before":"after")}Cr.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Cr.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Cr.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Cr.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Cr.default=vt?Cr.macDefault:Cr.pcDefault;var un={selectAll:Is,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),lt)},killLine:function(t){return Oi(t,function(e){if(e.empty()){var i=Lt(t.doc,e.head.line).text.length;return e.head.ch==i&&e.head.line<t.lastLine()?{from:e.head,to:q(e.head.line+1,0)}:{from:e.head,to:q(e.head.line,i)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){return Oi(t,function(e){return{from:q(e.from().line,0),to:Dt(t.doc,q(e.to().line+1,0))}})},delLineLeft:function(t){return Oi(t,function(e){return{from:q(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(t){return Oi(t,function(e){var i=t.charCoords(e.head,"div").top+5;return{from:t.coordsChar({left:0,top:i},"div"),to:e.from()}})},delWrappedLineRight:function(t){return Oi(t,function(e){var i=t.charCoords(e.head,"div").top+5,r=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:i},"div");return{from:e.from(),to:r}})},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(q(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(q(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return Vs(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return qs(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return function Da(t,e){var i=Lt(t.doc,e),r=function xn(t){for(var e;e=Zr(t);)t=e.find(1,!0).line;return t}(i);return r!=i&&(e=$t(r)),Lo(!0,t,i,e,-1)}(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){var i=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:i},"div")},Ut)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){var i=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:i},"div")},Ut)},goLineLeftSmart:function(t){return t.extendSelectionsBy(function(e){var i=t.cursorCoords(e.head,"div").top+5,r=t.coordsChar({left:0,top:i},"div");return r.ch<t.getLine(r.line).search(/\S/)?qs(t,e.head):r},Ut)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"codepoint")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("\t")},insertSoftTab:function(t){for(var e=[],i=t.listSelections(),r=t.options.tabSize,n=0;n<i.length;n++){var o=i[n].from(),a=H(t.getLine(o.line),o.ch,r);e.push(Kt(r-a%r))}t.replaceSelections(e)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return Xe(t,function(){for(var e=t.listSelections(),i=[],r=0;r<e.length;r++)if(e[r].empty()){var n=e[r].head,o=Lt(t.doc,n.line).text;if(o)if(n.ch==o.length&&(n=new q(n.line,n.ch-1)),n.ch>0)n=new q(n.line,n.ch+1),t.replaceRange(o.charAt(n.ch-1)+o.charAt(n.ch-2),q(n.line,n.ch-2),n,"+transpose");else if(n.line>t.doc.first){var a=Lt(t.doc,n.line-1).text;a&&(n=new q(n.line,1),t.replaceRange(o.charAt(0)+t.doc.lineSeparator()+a.charAt(a.length-1),q(n.line-1,a.length-1),n,"+transpose"))}i.push(new te(n,n))}t.setSelections(i)})},newlineAndIndent:function(t){return Xe(t,function(){for(var e=t.listSelections(),i=e.length-1;i>=0;i--)t.replaceRange(t.doc.lineSeparator(),e[i].anchor,e[i].head,"+input");e=t.listSelections();for(var r=0;r<e.length;r++)t.indentLine(e[r].from().line,null,!0);bi(t)})},openLine:function(t){return t.replaceSelection("\n","start")},toggleOverwrite:function(t){return t.toggleOverwrite()}};function Vs(t,e){var i=Lt(t.doc,e),r=Ye(i);return r!=i&&(e=$t(r)),Lo(!0,t,r,e,1)}function qs(t,e){var i=Vs(t,e.line),r=Lt(t.doc,i.line),n=be(r,t.doc.direction);if(!n||0==n[0].level){var o=Math.max(i.ch,r.text.search(/\S/));return q(i.line,e.line==i.line&&e.ch<=o&&e.ch?0:o,i.sticky)}return i}function En(t,e,i){if("string"==typeof e&&!(e=un[e]))return!1;t.display.input.ensurePolled();var r=t.display.shift,n=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),i&&(t.display.shift=!1),n=e(t)!=ot}finally{t.display.shift=r,t.state.suppressEdits=!1}return n}var Ia=new G;function fn(t,e,i,r){var n=t.state.keySeq;if(n){if(Qs(e))return"handled";if(/\'$/.test(e)?t.state.keySeq=null:Ia.set(50,function(){t.state.keySeq==n&&(t.state.keySeq=null,t.display.input.reset())}),$s(t,n+" "+e,i,r))return!0}return $s(t,e,i,r)}function $s(t,e,i,r){var n=function Fa(t,e,i){for(var r=0;r<t.state.keyMaps.length;r++){var n=Mi(e,t.state.keyMaps[r],i,t);if(n)return n}return t.options.extraKeys&&Mi(e,t.options.extraKeys,i,t)||Mi(e,t.options.keyMap,i,t)}(t,e,r);return"multi"==n&&(t.state.keySeq=e),"handled"==n&&ge(t,"keyHandled",t,e,i),("handled"==n||"multi"==n)&&(Se(i),so(t)),!!n}function tl(t,e){var i=js(e,!0);return!!i&&(e.shiftKey&&!t.state.keySeq?fn(t,"Shift-"+i,e,function(r){return En(t,r,!0)})||fn(t,i,e,function(r){if("string"==typeof r?/^go[A-Z]/.test(r):r.motion)return En(t,r)}):fn(t,i,e,function(r){return En(t,r)}))}var ko=null;function el(t){var e=this;if(!(t.target&&t.target!=e.display.input.getField()||(e.curOp.focus=P(),le(e,t)))){Nt&&Gt<11&&27==t.keyCode&&(t.returnValue=!1);var i=t.keyCode;e.display.shift=16==i||t.shiftKey;var r=tl(e,t);T&&(ko=r?i:null,!r&&88==i&&!ui&&(vt?t.metaKey:t.ctrlKey)&&e.replaceSelection("",null,"cut")),Ct&&!vt&&!r&&46==i&&t.shiftKey&&!t.ctrlKey&&document.execCommand&&document.execCommand("cut"),18==i&&!/\bCodeMirror-crosshair\b/.test(e.display.lineDiv.className)&&function Ba(t){var e=t.display.lineDiv;function i(r){(18==r.keyCode||!r.altKey)&&(xt(e,"CodeMirror-crosshair"),Ce(document,"keyup",i),Ce(document,"mouseover",i))}U(e,"CodeMirror-crosshair"),Mt(document,"keyup",i),Mt(document,"mouseover",i)}(e)}}function rl(t){16==t.keyCode&&(this.doc.sel.shift=!1),le(this,t)}function il(t){var e=this;if(!(t.target&&t.target!=e.display.input.getField()||wr(e.display,t)||le(e,t)||t.ctrlKey&&!t.altKey||vt&&t.metaKey)){var i=t.keyCode,r=t.charCode;if(T&&i==ko)return ko=null,void Se(t);if(!T||t.which&&!(t.which<10)||!tl(e,t)){var n=String.fromCharCode(null==r?i:r);"\b"!=n&&(function Wa(t,e,i){return fn(t,"'"+i+"'",e,function(r){return En(t,r,!0)})}(e,t,n)||e.display.input.onKeyPress(t))}}}var hn,cn,No=function(t,e,i){this.time=t,this.pos=e,this.button=i};function nl(t){var e=this,i=e.display;if(!(le(e,t)||i.activeTouch&&i.input.supportsTouch())){if(i.input.ensurePolled(),i.shift=t.shiftKey,wr(i,t))return void(zt||(i.scroller.draggable=!1,setTimeout(function(){return i.scroller.draggable=!0},100)));if(!Mo(e,t)){var r=jr(e,t),n=vn(t),o=r?function Pa(t,e){var i=+new Date;return cn&&cn.compare(i,t,e)?(hn=cn=null,"triple"):hn&&hn.compare(i,t,e)?(cn=new No(i,t,e),hn=null,"double"):(hn=new No(i,t,e),cn=null,"single")}(r,n):"single";window.focus(),1==n&&e.state.selectingText&&e.state.selectingText(t),(!r||!function Ea(t,e,i,r,n){var o="Click";return"double"==r?o="Double"+o:"triple"==r&&(o="Triple"+o),fn(t,Js(o=(1==e?"Left":2==e?"Middle":"Right")+o,n),n,function(a){if("string"==typeof a&&(a=un[a]),!a)return!1;var u=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),u=a(t,i)!=ot}finally{t.state.suppressEdits=!1}return u})}(e,n,r,o,t))&&(1==n?r?function Ga(t,e,i,r){Nt?setTimeout(O(os,t),0):t.curOp.focus=P();var a,n=function Ra(t,e,i){var r=t.getOption("configureMouse"),n=r?r(t,e,i):{};return null==n.unit&&(n.unit=(mt?i.shiftKey&&i.metaKey:i.altKey)?"rectangle":"single"==e?"char":"double"==e?"word":"line"),(null==n.extend||t.doc.extend)&&(n.extend=t.doc.extend||i.shiftKey),null==n.addNew&&(n.addNew=vt?i.metaKey:i.ctrlKey),null==n.moveOnDrag&&(n.moveOnDrag=!(vt?i.altKey:i.ctrlKey)),n}(t,i,r),o=t.doc.sel;t.options.dragDrop&&gn&&!t.isReadOnly()&&"single"==i&&(a=o.contains(e))>-1&&(pt((a=o.ranges[a]).from(),e)<0||e.xRel>0)&&(pt(a.to(),e)>0||e.xRel<0)?function za(t,e,i,r){var n=t.display,o=!1,a=ye(t,function(d){zt&&(n.scroller.draggable=!1),t.state.draggingText=!1,t.state.delayingBlurEvent&&(t.hasFocus()?t.state.delayingBlurEvent=!1:lo(t)),Ce(n.wrapper.ownerDocument,"mouseup",a),Ce(n.wrapper.ownerDocument,"mousemove",u),Ce(n.scroller,"dragstart",c),Ce(n.scroller,"drop",a),o||(Se(d),r.addNew||Fn(t.doc,i,null,null,r.extend),zt&&!_||Nt&&9==Gt?setTimeout(function(){n.wrapper.ownerDocument.body.focus({preventScroll:!0}),n.input.focus()},20):n.input.focus())}),u=function(d){o=o||Math.abs(e.clientX-d.clientX)+Math.abs(e.clientY-d.clientY)>=10},c=function(){return o=!0};zt&&(n.scroller.draggable=!0),t.state.draggingText=a,a.copy=!r.moveOnDrag,Mt(n.wrapper.ownerDocument,"mouseup",a),Mt(n.wrapper.ownerDocument,"mousemove",u),Mt(n.scroller,"dragstart",c),Mt(n.scroller,"drop",a),t.state.delayingBlurEvent=!0,setTimeout(function(){return n.input.focus()},20),n.scroller.dragDrop&&n.scroller.dragDrop()}(t,r,e,n):function Ua(t,e,i,r){Nt&&lo(t);var n=t.display,o=t.doc;Se(e);var a,u,c=o.sel,d=c.ranges;if(r.addNew&&!r.extend?a=(u=o.sel.contains(i))>-1?d[u]:new te(i,i):(a=o.sel.primary(),u=o.sel.primIndex),"rectangle"==r.unit)r.addNew||(a=new te(i,i)),i=jr(t,e,!0,!0),u=-1;else{var C=ol(t,i,r.unit);a=r.extend?bo(a,C.anchor,C.head,r.extend):C}r.addNew?-1==u?(u=d.length,Ne(o,ir(t,d.concat([a]),u),{scroll:!1,origin:"*mouse"})):d.length>1&&d[u].empty()&&"char"==r.unit&&!r.extend?(Ne(o,ir(t,d.slice(0,u).concat(d.slice(u+1)),0),{scroll:!1,origin:"*mouse"}),c=o.sel):Co(o,u,a,St):(u=0,Ne(o,new Ze([a],0),St),c=o.sel);var N=i;var I=n.wrapper.getBoundingClientRect(),Y=0;function V(ct){var wt=++Y,Ot=jr(t,ct,!0,"rectangle"==r.unit);if(Ot)if(0!=pt(Ot,N)){t.curOp.focus=P(),function B(ct){if(0!=pt(N,ct))if(N=ct,"rectangle"==r.unit){for(var wt=[],Ot=t.options.tabSize,kt=H(Lt(o,i.line).text,i.ch,Ot),Yt=H(Lt(o,ct.line).text,ct.ch,Ot),ie=Math.min(kt,Yt),xe=Math.max(kt,Yt),ae=Math.min(i.line,ct.line),Ke=Math.min(t.lastLine(),Math.max(i.line,ct.line));ae<=Ke;ae++){var He=Lt(o,ae).text,ce=_t(He,ie,Ot);ie==xe?wt.push(new te(q(ae,ce),q(ae,ce))):He.length>ce&&wt.push(new te(q(ae,ce),q(ae,_t(He,xe,Ot))))}wt.length||wt.push(new te(i,i)),Ne(o,ir(t,c.ranges.slice(0,u).concat(wt),u),{origin:"*mouse",scroll:!1}),t.scrollIntoView(ct)}else{var de,Pe=a,Te=ol(t,ct,r.unit),pe=Pe.anchor;pt(Te.anchor,pe)>0?(de=Te.head,pe=sr(Pe.from(),Te.anchor)):(de=Te.anchor,pe=Mr(Pe.to(),Te.head));var ue=c.ranges.slice(0);ue[u]=function Ya(t,e){var i=e.anchor,r=e.head,n=Lt(t.doc,i.line);if(0==pt(i,r)&&i.sticky==r.sticky)return e;var o=be(n);if(!o)return e;var a=Qe(o,i.ch,i.sticky),u=o[a];if(u.from!=i.ch&&u.to!=i.ch)return e;var d,c=a+(u.from==i.ch==(1!=u.level)?0:1);if(0==c||c==o.length)return e;if(r.line!=i.line)d=(r.line-i.line)*("ltr"==t.doc.direction?1:-1)>0;else{var C=Qe(o,r.ch,r.sticky),N=C-a||(r.ch-i.ch)*(1==u.level?-1:1);d=C==c-1||C==c?N<0:N>0}var B=o[c+(d?-1:0)],I=d==(1==B.level),Y=I?B.from:B.to,V=I?"after":"before";return i.ch==Y&&i.sticky==V?e:new te(new q(i.line,Y,V),r)}(t,new te(Dt(o,pe),de)),Ne(o,ir(t,ue,u),St)}}(Ot);var kt=Nn(n,o);(Ot.line>=kt.to||Ot.line<kt.from)&&setTimeout(ye(t,function(){Y==wt&&V(ct)}),150)}else{var Yt=ct.clientY<I.top?-20:ct.clientY>I.bottom?20:0;Yt&&setTimeout(ye(t,function(){Y==wt&&(n.scroller.scrollTop+=Yt,V(ct))}),50)}}function st(ct){t.state.selectingText=!1,Y=1/0,ct&&(Se(ct),n.input.focus()),Ce(n.wrapper.ownerDocument,"mousemove",ht),Ce(n.wrapper.ownerDocument,"mouseup",yt),o.history.lastSelOrigin=null}var ht=ye(t,function(ct){0!==ct.buttons&&vn(ct)?V(ct):st(ct)}),yt=ye(t,st);t.state.selectingText=yt,Mt(n.wrapper.ownerDocument,"mousemove",ht),Mt(n.wrapper.ownerDocument,"mouseup",yt)}(t,r,e,n)}(e,r,o,t):Fe(t)==i.scroller&&Se(t):2==n?(r&&Fn(e.doc,r),setTimeout(function(){return i.input.focus()},20)):3==n&&(qt?e.display.input.onContextMenu(t):lo(e)))}}}function ol(t,e,i){if("char"==i)return new te(e,e);if("word"==i)return t.findWordAt(e);if("line"==i)return new te(q(e.line,0),Dt(t.doc,q(e.line+1,0)));var r=i(t,e);return new te(r.from,r.to)}function sl(t,e,i,r){var n,o;if(e.touches)n=e.touches[0].clientX,o=e.touches[0].clientY;else try{n=e.clientX,o=e.clientY}catch(B){return!1}if(n>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;r&&Se(e);var a=t.display,u=a.lineDiv.getBoundingClientRect();if(o>u.bottom||!Ge(t,i))return qe(e);o-=u.top-a.viewOffset;for(var c=0;c<t.display.gutterSpecs.length;++c){var d=a.gutters.childNodes[c];if(d&&d.getBoundingClientRect().right>=n)return ne(t,i,t,or(t.doc,o),t.display.gutterSpecs[c].className,e),qe(e)}}function Mo(t,e){return sl(t,e,"gutterClick",!0)}function ll(t,e){wr(t.display,e)||function Xa(t,e){return!!Ge(t,"gutterContextMenu")&&sl(t,e,"gutterContextMenu",!1)}(t,e)||le(t,e,"contextmenu")||qt||t.display.input.onContextMenu(e)}function al(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Xi(t)}No.prototype.compare=function(t,e,i){return this.time+400>t&&0==pt(e,this.pos)&&i==this.button};var _i={toString:function(){return"CodeMirror.Init"}},ul={},Rn={};function Za(t,e,i){if(!e!=!(i&&i!=_i)){var n=t.display.dragFunctions,o=e?Mt:Ce;o(t.display.scroller,"dragstart",n.start),o(t.display.scroller,"dragenter",n.enter),o(t.display.scroller,"dragover",n.over),o(t.display.scroller,"dragleave",n.leave),o(t.display.scroller,"drop",n.drop)}}function Qa(t){t.options.lineWrapping?(U(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(xt(t.display.wrapper,"CodeMirror-wrap"),Zn(t)),no(t),We(t),Xi(t),setTimeout(function(){return Ci(t)},100)}function oe(t,e){var i=this;if(!(this instanceof oe))return new oe(t,e);this.options=e=e?D(e):{},D(ul,e,!1);var r=e.value;"string"==typeof r?r=new Be(r,e.mode,null,e.lineSeparator,e.direction):e.mode&&(r.modeOption=e.mode),this.doc=r;var n=new oe.inputStyles[e.inputStyle](this),o=this.display=new la(t,r,n,e);for(var a in o.wrapper.CodeMirror=this,al(this),e.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),hs(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new G,keySeq:null,specialChars:null},e.autofocus&&!dt&&o.input.focus(),Nt&&Gt<11&&setTimeout(function(){return i.display.input.reset(!0)},20),function Ja(t){var e=t.display;Mt(e.scroller,"mousedown",ye(t,nl)),Mt(e.scroller,"dblclick",Nt&&Gt<11?ye(t,function(c){if(!le(t,c)){var d=jr(t,c);if(d&&!Mo(t,c)&&!wr(t.display,c)){Se(c);var C=t.findWordAt(d);Fn(t.doc,C.anchor,C.head)}}}):function(c){return le(t,c)||Se(c)}),Mt(e.scroller,"contextmenu",function(c){return ll(t,c)}),Mt(e.input.getField(),"contextmenu",function(c){e.scroller.contains(c.target)||ll(t,c)});var i,r={end:0};function n(){e.activeTouch&&(i=setTimeout(function(){return e.activeTouch=null},1e3),(r=e.activeTouch).end=+new Date)}function a(c,d){if(null==d.left)return!0;var C=d.left-c.left,N=d.top-c.top;return C*C+N*N>400}Mt(e.scroller,"touchstart",function(c){if(!le(t,c)&&!function o(c){if(1!=c.touches.length)return!1;var d=c.touches[0];return d.radiusX<=1&&d.radiusY<=1}(c)&&!Mo(t,c)){e.input.ensurePolled(),clearTimeout(i);var d=+new Date;e.activeTouch={start:d,moved:!1,prev:d-r.end<=300?r:null},1==c.touches.length&&(e.activeTouch.left=c.touches[0].pageX,e.activeTouch.top=c.touches[0].pageY)}}),Mt(e.scroller,"touchmove",function(){e.activeTouch&&(e.activeTouch.moved=!0)}),Mt(e.scroller,"touchend",function(c){var d=e.activeTouch;if(d&&!wr(e,c)&&null!=d.left&&!d.moved&&new Date-d.start<300){var N,C=t.coordsChar(e.activeTouch,"page");N=!d.prev||a(d,d.prev)?new te(C,C):!d.prev.prev||a(d,d.prev.prev)?t.findWordAt(C):new te(q(C.line,0),Dt(t.doc,q(C.line+1,0))),t.setSelection(N.anchor,N.head),t.focus(),Se(c)}n()}),Mt(e.scroller,"touchcancel",n),Mt(e.scroller,"scroll",function(){e.scroller.clientHeight&&(Qi(t,e.scroller.scrollTop),qr(t,e.scroller.scrollLeft,!0),ne(t,"scroll",t))}),Mt(e.scroller,"mousewheel",function(c){return ys(t,c)}),Mt(e.scroller,"DOMMouseScroll",function(c){return ys(t,c)}),Mt(e.wrapper,"scroll",function(){return e.wrapper.scrollTop=e.wrapper.scrollLeft=0}),e.dragFunctions={enter:function(c){le(t,c)||pr(c)},over:function(c){le(t,c)||(function La(t,e){var i=jr(t,e);if(i){var r=document.createDocumentFragment();oo(t,i,r),t.display.dragCursor||(t.display.dragCursor=gt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),Xt(t.display.dragCursor,r)}}(t,c),pr(c))},start:function(c){return function Ta(t,e){if(Nt&&(!t.state.draggingText||+new Date-Ys<100))pr(e);else if(!le(t,e)&&!wr(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!_)){var i=gt("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",T&&(i.width=i.height=1,t.display.wrapper.appendChild(i),i._top=i.offsetTop),e.dataTransfer.setDragImage(i,0,0),T&&i.parentNode.removeChild(i)}}(t,c)},drop:ye(t,Sa),leave:function(c){le(t,c)||Xs(t)}};var u=e.input.getField();Mt(u,"keyup",function(c){return rl.call(t,c)}),Mt(u,"keydown",ye(t,el)),Mt(u,"keypress",ye(t,il)),Mt(u,"focus",function(c){return ao(t,c)}),Mt(u,"blur",function(c){return wi(t,c)})}(this),function ka(){Zs||(function Na(){var t;Mt(window,"resize",function(){null==t&&(t=setTimeout(function(){t=null,Ks(Ma)},100))}),Mt(window,"blur",function(){return Ks(wi)})}(),Zs=!0)}(),ti(this),this.curOp.forceUpdate=!0,bs(this,r),e.autofocus&&!dt||this.hasFocus()?setTimeout(function(){i.hasFocus()&&!i.state.focused&&ao(i)},20):wi(this),Rn)Rn.hasOwnProperty(a)&&Rn[a](this,e[a],_i);ps(this),e.finishInit&&e.finishInit(this);for(var u=0;u<Oo.length;++u)Oo[u](this);ei(this),zt&&e.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}oe.defaults=ul,oe.optionHandlers=Rn;var Oo=[];function dn(t,e,i,r){var o,n=t.doc;null==i&&(i="add"),"smart"==i&&(n.mode.indent?o=m(t,e).state:i="prev");var a=t.options.tabSize,u=Lt(n,e),c=H(u.text,null,a);u.stateAfter&&(u.stateAfter=null);var C,d=u.text.match(/^\s*/)[0];if(r||/\S/.test(u.text)){if("smart"==i&&((C=n.mode.indent(o,u.text.slice(d.length),u.text))==ot||C>150)){if(!r)return;i="prev"}}else C=0,i="not";"prev"==i?C=e>n.first?H(Lt(n,e-1).text,null,a):0:"add"==i?C=c+t.options.indentUnit:"subtract"==i?C=c-t.options.indentUnit:"number"==typeof i&&(C=c+i),C=Math.max(0,C);var N="",B=0;if(t.options.indentWithTabs)for(var I=Math.floor(C/a);I;--I)B+=a,N+="\t";if(B<C&&(N+=Kt(C-B)),N!=d)return ki(n,N,q(e,0),q(e,d.length),"+input"),u.stateAfter=null,!0;for(var Y=0;Y<n.sel.ranges.length;Y++){var V=n.sel.ranges[Y];if(V.head.line==e&&V.head.ch<d.length){var st=q(e,d.length);Co(n,Y,new te(st,st));break}}}oe.defineInitHook=function(t){return Oo.push(t)};var nr=null;function Gn(t){nr=t}function _o(t,e,i,r,n){var o=t.doc;t.display.shift=!1,r||(r=o.sel);var a=+new Date-200,u="paste"==n||t.state.pasteIncoming>a,c=ai(e),d=null;if(u&&r.ranges.length>1)if(nr&&nr.text.join("\n")==e){if(r.ranges.length%nr.text.length==0){d=[];for(var C=0;C<nr.text.length;C++)d.push(o.splitLines(nr.text[C]))}}else c.length==r.ranges.length&&t.options.pasteLinesPerSelection&&(d=jt(c,function(ht){return[ht]}));for(var N=t.curOp.updateInput,B=r.ranges.length-1;B>=0;B--){var I=r.ranges[B],Y=I.from(),V=I.to();I.empty()&&(i&&i>0?Y=q(Y.line,Y.ch-i):t.state.overwrite&&!u?V=q(V.line,Math.min(Lt(o,V.line).text.length,V.ch+Tt(c).length)):u&&nr&&nr.lineWise&&nr.text.join("\n")==c.join("\n")&&(Y=V=q(Y.line,0)));var st={from:Y,to:V,text:d?d[B%d.length]:c,origin:n||(u?"paste":t.state.cutIncoming>a?"cut":"+input")};Li(t.doc,st),ge(t,"inputRead",t,st)}e&&!u&&hl(t,e),bi(t),t.curOp.updateInput<2&&(t.curOp.updateInput=N),t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=-1}function fl(t,e){var i=t.clipboardData&&t.clipboardData.getData("Text");if(i)return t.preventDefault(),!e.isReadOnly()&&!e.options.disableInput&&Xe(e,function(){return _o(e,i,0,null,"paste")}),!0}function hl(t,e){if(t.options.electricChars&&t.options.smartIndent)for(var i=t.doc.sel,r=i.ranges.length-1;r>=0;r--){var n=i.ranges[r];if(!(n.head.ch>100||r&&i.ranges[r-1].head.line==n.head.line)){var o=t.getModeAt(n.head),a=!1;if(o.electricChars){for(var u=0;u<o.electricChars.length;u++)if(e.indexOf(o.electricChars.charAt(u))>-1){a=dn(t,n.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(Lt(t.doc,n.head.line).text.slice(0,n.head.ch))&&(a=dn(t,n.head.line,"smart"));a&&ge(t,"electricInput",t,n.head.line)}}}function cl(t){for(var e=[],i=[],r=0;r<t.doc.sel.ranges.length;r++){var n=t.doc.sel.ranges[r].head.line,o={anchor:q(n,0),head:q(n+1,0)};i.push(o),e.push(t.getRange(o.anchor,o.head))}return{text:e,ranges:i}}function dl(t,e,i,r){t.setAttribute("autocorrect",i?"":"off"),t.setAttribute("autocapitalize",r?"":"off"),t.setAttribute("spellcheck",!!e)}function pl(){var t=gt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),e=gt("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return zt?t.style.width="1000px":t.setAttribute("wrap","off"),$&&(t.style.border="1px solid black"),dl(t),e}function Ao(t,e,i,r,n){var o=e,a=i,u=Lt(t,e.line),c=n&&"rtl"==t.direction?-i:i;function C(yt){var ct;if("codepoint"==r){var wt=u.text.charCodeAt(e.ch+(i>0?0:-1));ct=isNaN(wt)?null:new q(e.line,Math.max(0,Math.min(u.text.length,e.ch+i*((i>0?wt>=55296&&wt<56320:wt>=56320&&wt<57343)?2:1))),-i)}else ct=n?function Aa(t,e,i,r){var n=be(e,t.doc.direction);if(!n)return To(e,i,r);i.ch>=e.text.length?(i.ch=e.text.length,i.sticky="before"):i.ch<=0&&(i.ch=0,i.sticky="after");var o=Qe(n,i.ch,i.sticky),a=n[o];if("ltr"==t.doc.direction&&a.level%2==0&&(r>0?a.to>i.ch:a.from<i.ch))return To(e,i,r);var c,u=function(ht,yt){return So(e,ht instanceof q?ht.ch:ht,yt)},d=function(ht){return t.options.lineWrapping?(c=c||yi(t,e),es(t,e,c,ht)):{begin:0,end:e.text.length}},C=d("before"==i.sticky?u(i,-1):i.ch);if("rtl"==t.doc.direction||1==a.level){var N=1==a.level==r<0,B=u(i,N?1:-1);if(null!=B&&(N?B<=a.to&&B<=C.end:B>=a.from&&B>=C.begin))return new q(i.line,B,N?"before":"after")}var Y=function(ht,yt,ct){for(;ht>=0&&ht<n.length;ht+=yt){var Ot=n[ht],kt=yt>0==(1!=Ot.level),Yt=kt?ct.begin:u(ct.end,-1);if(Ot.from<=Yt&&Yt<Ot.to||(Yt=kt?Ot.from:u(Ot.to,-1),ct.begin<=Yt&&Yt<ct.end))return ie=Yt,kt?new q(i.line,u(ie,1),"before"):new q(i.line,ie,"after")}var ie},V=Y(o+r,r,C);if(V)return V;var st=r>0?C.end:u(C.begin,-1);return null==st||r>0&&st==e.text.length||!(V=Y(r>0?0:n.length-1,r,d(st)))?null:V}(t.cm,u,e,i):To(u,e,i);if(null==ct){if(yt||!function d(){var yt=e.line+c;return!(yt<t.first||yt>=t.first+t.size)&&(e=new q(yt,e.ch,e.sticky),u=Lt(t,yt))}())return!1;e=Lo(n,t.cm,u,e.line,c)}else e=ct;return!0}if("char"==r||"codepoint"==r)C();else if("column"==r)C(!0);else if("word"==r||"group"==r)for(var N=null,B="group"==r,I=t.cm&&t.cm.getHelper(e,"wordChars"),Y=!0;!(i<0)||C(!Y);Y=!1){var V=u.text.charAt(e.ch)||"\n",st=se(V,I)?"w":B&&"\n"==V?"n":!B||/\s/.test(V)?null:"p";if(B&&!Y&&!st&&(st="s"),N&&N!=st){i<0&&(i=1,C(),e.sticky="after");break}if(st&&(N=st),i>0&&!C(!Y))break}var ht=Wn(t,e,o,a,!0);return di(o,ht)&&(ht.hitSide=!0),ht}function vl(t,e,i,r){var a,d,n=t.doc,o=e.left;if("page"==r){var u=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),c=Math.max(u-.5*mi(t.display),3);a=(i>0?e.bottom:e.top)+i*c}else"line"==r&&(a=i>0?e.bottom+3:e.top-3);for(;(d=to(t,o,a)).outside;){if(i<0?a<=0:a>=n.height){d.hitSide=!0;break}a+=5*i}return d}var re=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new G,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function gl(t,e){var i=Vn(t,e.line);if(!i||i.hidden)return null;var r=Lt(t.doc,e.line),n=Yo(i,r,e.line),o=be(r,t.doc.direction),a="left";o&&(a=Qe(o,e.ch)%2?"right":"left");var c=Zo(n.map,e.ch,a);return c.offset="right"==c.collapse?c.end:c.start,c}function Ai(t,e){return e&&(t.bad=!0),t}function zn(t,e,i){var r;if(e==t.display.lineDiv){if(!(r=t.display.lineDiv.childNodes[i]))return Ai(t.clipPos(q(t.display.viewTo-1)),!0);e=null,i=0}else for(r=e;;r=r.parentNode){if(!r||r==t.display.lineDiv)return null;if(r.parentNode&&r.parentNode==t.display.lineDiv)break}for(var n=0;n<t.display.view.length;n++){var o=t.display.view[n];if(o.node==r)return $a(o,e,i)}}function $a(t,e,i){var r=t.text.firstChild,n=!1;if(!e||!W(r,e))return Ai(q($t(t.line),0),!0);if(e==r&&(n=!0,e=r.childNodes[i],i=0,!e)){var o=t.rest?Tt(t.rest):t.line;return Ai(q($t(o),o.text.length),n)}var a=3==e.nodeType?e:null,u=e;for(!a&&1==e.childNodes.length&&3==e.firstChild.nodeType&&(a=e.firstChild,i&&(i=a.nodeValue.length));u.parentNode!=r;)u=u.parentNode;var c=t.measure,d=c.maps;function C(st,ht,yt){for(var ct=-1;ct<(d?d.length:0);ct++)for(var wt=ct<0?c.map:d[ct],Ot=0;Ot<wt.length;Ot+=3){var kt=wt[Ot+2];if(kt==st||kt==ht){var Yt=$t(ct<0?t.line:t.rest[ct]),ie=wt[Ot]+yt;return(yt<0||kt!=st)&&(ie=wt[Ot+(yt?1:0)]),q(Yt,ie)}}}var N=C(a,u,i);if(N)return Ai(N,n);for(var B=u.nextSibling,I=a?a.nodeValue.length-i:0;B;B=B.nextSibling){if(N=C(B,B.firstChild,0))return Ai(q(N.line,N.ch-I),n);I+=B.textContent.length}for(var Y=u.previousSibling,V=i;Y;Y=Y.previousSibling){if(N=C(Y,Y.firstChild,-1))return Ai(q(N.line,N.ch+V),n);V+=Y.textContent.length}}re.prototype.init=function(t){var e=this,i=this,r=i.cm,n=i.div=t.lineDiv;function o(u){for(var c=u.target;c;c=c.parentNode){if(c==n)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(c.className))break}return!1}function a(u){if(o(u)&&!le(r,u)){if(r.somethingSelected())Gn({lineWise:!1,text:r.getSelections()}),"cut"==u.type&&r.replaceSelection("",null,"cut");else{if(!r.options.lineWiseCopyCut)return;var c=cl(r);Gn({lineWise:!0,text:c.text}),"cut"==u.type&&r.operation(function(){r.setSelections(c.ranges,0,lt),r.replaceSelection("",null,"cut")})}if(u.clipboardData){u.clipboardData.clearData();var d=nr.text.join("\n");if(u.clipboardData.setData("Text",d),u.clipboardData.getData("Text")==d)return void u.preventDefault()}var C=pl(),N=C.firstChild;r.display.lineSpace.insertBefore(C,r.display.lineSpace.firstChild),N.value=nr.text.join("\n");var B=P();y(N),setTimeout(function(){r.display.lineSpace.removeChild(C),B.focus(),B==n&&i.showPrimarySelection()},50)}}n.contentEditable=!0,dl(n,r.options.spellcheck,r.options.autocorrect,r.options.autocapitalize),Mt(n,"paste",function(u){!o(u)||le(r,u)||fl(u,r)||Gt<=11&&setTimeout(ye(r,function(){return e.updateFromDOM()}),20)}),Mt(n,"compositionstart",function(u){e.composing={data:u.data,done:!1}}),Mt(n,"compositionupdate",function(u){e.composing||(e.composing={data:u.data,done:!1})}),Mt(n,"compositionend",function(u){e.composing&&(u.data!=e.composing.data&&e.readFromDOMSoon(),e.composing.done=!0)}),Mt(n,"touchstart",function(){return i.forceCompositionEnd()}),Mt(n,"input",function(){e.composing||e.readFromDOMSoon()}),Mt(n,"copy",a),Mt(n,"cut",a)},re.prototype.screenReaderLabelChanged=function(t){t?this.div.setAttribute("aria-label",t):this.div.removeAttribute("aria-label")},re.prototype.prepareSelection=function(){var t=ns(this.cm,!1);return t.focus=P()==this.div,t},re.prototype.showSelection=function(t,e){!t||!this.cm.display.view.length||((t.focus||e)&&this.showPrimarySelection(),this.showMultipleSelections(t))},re.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},re.prototype.showPrimarySelection=function(){var t=this.getSelection(),e=this.cm,i=e.doc.sel.primary(),r=i.from(),n=i.to();if(e.display.viewTo==e.display.viewFrom||r.line>=e.display.viewTo||n.line<e.display.viewFrom)t.removeAllRanges();else{var o=zn(e,t.anchorNode,t.anchorOffset),a=zn(e,t.focusNode,t.focusOffset);if(!o||o.bad||!a||a.bad||0!=pt(sr(o,a),r)||0!=pt(Mr(o,a),n)){var u=e.display.view,c=r.line>=e.display.viewFrom&&gl(e,r)||{node:u[0].measure.map[2],offset:0},d=n.line<e.display.viewTo&&gl(e,n);if(!d){var C=u[u.length-1].measure,N=C.maps?C.maps[C.maps.length-1]:C.map;d={node:N[N.length-1],offset:N[N.length-2]-N[N.length-3]}}if(!c||!d)return void t.removeAllRanges();var I,B=t.rangeCount&&t.getRangeAt(0);try{I=x(c.node,c.offset,d.offset,d.node)}catch(Y){}I&&(!Ct&&e.state.focused?(t.collapse(c.node,c.offset),I.collapsed||(t.removeAllRanges(),t.addRange(I))):(t.removeAllRanges(),t.addRange(I)),B&&null==t.anchorNode?t.addRange(B):Ct&&this.startGracePeriod()),this.rememberSelection()}}},re.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation(function(){return t.cm.curOp.selectionChanged=!0})},20)},re.prototype.showMultipleSelections=function(t){Xt(this.cm.display.cursorDiv,t.cursors),Xt(this.cm.display.selectionDiv,t.selection)},re.prototype.rememberSelection=function(){var t=this.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},re.prototype.selectionInEditor=function(){var t=this.getSelection();if(!t.rangeCount)return!1;var e=t.getRangeAt(0).commonAncestorContainer;return W(this.div,e)},re.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&((!this.selectionInEditor()||P()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},re.prototype.blur=function(){this.div.blur()},re.prototype.getField=function(){return this.div},re.prototype.supportsTouch=function(){return!0},re.prototype.receivedFocus=function(){var t=this,e=this;this.selectionInEditor()?setTimeout(function(){return t.pollSelection()},20):Xe(this.cm,function(){return e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function i(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,i))})},re.prototype.selectionChanged=function(){var t=this.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},re.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var t=this.getSelection(),e=this.cm;if(R&&g&&this.cm.display.gutterSpecs.length&&function Va(t){for(var e=t;e;e=e.parentNode)if(/CodeMirror-gutter-wrapper/.test(e.className))return!0;return!1}(t.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var i=zn(e,t.anchorNode,t.anchorOffset),r=zn(e,t.focusNode,t.focusOffset);i&&r&&Xe(e,function(){Ne(e.doc,Fr(i,r),lt),(i.bad||r.bad)&&(e.curOp.selectionChanged=!0)})}}},re.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var o,a,u,t=this.cm,e=t.display,i=t.doc.sel.primary(),r=i.from(),n=i.to();if(0==r.ch&&r.line>t.firstLine()&&(r=q(r.line-1,Lt(t.doc,r.line-1).length)),n.ch==Lt(t.doc,n.line).text.length&&n.line<t.lastLine()&&(n=q(n.line+1,0)),r.line<e.viewFrom||n.line>e.viewTo-1)return!1;r.line==e.viewFrom||0==(o=Vr(t,r.line))?(a=$t(e.view[0].line),u=e.view[0].node):(a=$t(e.view[o].line),u=e.view[o-1].node.nextSibling);var d,C,c=Vr(t,n.line);if(c==e.view.length-1?(d=e.viewTo-1,C=e.lineDiv.lastChild):(d=$t(e.view[c+1].line)-1,C=e.view[c+1].node.previousSibling),!u)return!1;for(var N=t.doc.splitLines(function qa(t,e,i,r,n){var o="",a=!1,u=t.doc.lineSeparator(),c=!1;function C(){a&&(o+=u,c&&(o+=u),a=c=!1)}function N(I){I&&(C(),o+=I)}function B(I){if(1==I.nodeType){var Y=I.getAttribute("cm-text");if(Y)return void N(Y);var st,V=I.getAttribute("cm-marker");if(V){var ht=t.findMarks(q(r,0),q(n+1,0),function d(I){return function(Y){return Y.id==I}}(+V));return void(ht.length&&(st=ht[0].find(0))&&N(ze(t.doc,st.from,st.to).join(u)))}if("false"==I.getAttribute("contenteditable"))return;var yt=/^(pre|div|p|li|table|br)$/i.test(I.nodeName);if(!/^br$/i.test(I.nodeName)&&0==I.textContent.length)return;yt&&C();for(var ct=0;ct<I.childNodes.length;ct++)B(I.childNodes[ct]);/^(pre|p)$/i.test(I.nodeName)&&(c=!0),yt&&(a=!0)}else 3==I.nodeType&&N(I.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;B(e),e!=i;)e=e.nextSibling,c=!1;return o}(t,u,C,a,d)),B=ze(t.doc,q(a,0),q(d,Lt(t.doc,d).text.length));N.length>1&&B.length>1;)if(Tt(N)==Tt(B))N.pop(),B.pop(),d--;else{if(N[0]!=B[0])break;N.shift(),B.shift(),a++}for(var I=0,Y=0,V=N[0],st=B[0],ht=Math.min(V.length,st.length);I<ht&&V.charCodeAt(I)==st.charCodeAt(I);)++I;for(var yt=Tt(N),ct=Tt(B),wt=Math.min(yt.length-(1==N.length?I:0),ct.length-(1==B.length?I:0));Y<wt&&yt.charCodeAt(yt.length-Y-1)==ct.charCodeAt(ct.length-Y-1);)++Y;if(1==N.length&&1==B.length&&a==r.line)for(;I&&I>r.ch&&yt.charCodeAt(yt.length-Y-1)==ct.charCodeAt(ct.length-Y-1);)I--,Y++;N[N.length-1]=yt.slice(0,yt.length-Y).replace(/^\u200b+/,""),N[0]=N[0].slice(I).replace(/\u200b+$/,"");var Ot=q(a,I),kt=q(d,B.length?Tt(B).length-Y:0);return N.length>1||N[0]||pt(Ot,kt)?(ki(t.doc,N,Ot,kt,"+input"),!0):void 0},re.prototype.ensurePolled=function(){this.forceCompositionEnd()},re.prototype.reset=function(){this.forceCompositionEnd()},re.prototype.forceCompositionEnd=function(){!this.composing||(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},re.prototype.readFromDOMSoon=function(){var t=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(t.readDOMTimeout=null,t.composing){if(!t.composing.done)return;t.composing=null}t.updateFromDOM()},80))},re.prototype.updateFromDOM=function(){var t=this;(this.cm.isReadOnly()||!this.pollContent())&&Xe(this.cm,function(){return We(t.cm)})},re.prototype.setUneditable=function(t){t.contentEditable="false"},re.prototype.onKeyPress=function(t){0==t.charCode||this.composing||(t.preventDefault(),this.cm.isReadOnly()||ye(this.cm,_o)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0))},re.prototype.readOnlyChanged=function(t){this.div.contentEditable=String("nocursor"!=t)},re.prototype.onContextMenu=function(){},re.prototype.resetPosition=function(){},re.prototype.needsContentAttribute=!0;var he=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new G,this.hasSelection=!1,this.composing=null};he.prototype.init=function(t){var e=this,i=this,r=this.cm;this.createField(t);var n=this.textarea;function o(a){if(!le(r,a)){if(r.somethingSelected())Gn({lineWise:!1,text:r.getSelections()});else{if(!r.options.lineWiseCopyCut)return;var u=cl(r);Gn({lineWise:!0,text:u.text}),"cut"==a.type?r.setSelections(u.ranges,null,lt):(i.prevInput="",n.value=u.text.join("\n"),y(n))}"cut"==a.type&&(r.state.cutIncoming=+new Date)}}t.wrapper.insertBefore(this.wrapper,t.wrapper.firstChild),$&&(n.style.width="0px"),Mt(n,"input",function(){Nt&&Gt>=9&&e.hasSelection&&(e.hasSelection=null),i.poll()}),Mt(n,"paste",function(a){le(r,a)||fl(a,r)||(r.state.pasteIncoming=+new Date,i.fastPoll())}),Mt(n,"cut",o),Mt(n,"copy",o),Mt(t.scroller,"paste",function(a){if(!wr(t,a)&&!le(r,a)){if(!n.dispatchEvent)return r.state.pasteIncoming=+new Date,void i.focus();var u=new Event("paste");u.clipboardData=a.clipboardData,n.dispatchEvent(u)}}),Mt(t.lineSpace,"selectstart",function(a){wr(t,a)||Se(a)}),Mt(n,"compositionstart",function(){var a=r.getCursor("from");i.composing&&i.composing.range.clear(),i.composing={start:a,range:r.markText(a,r.getCursor("to"),{className:"CodeMirror-composing"})}}),Mt(n,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})},he.prototype.createField=function(t){this.wrapper=pl(),this.textarea=this.wrapper.firstChild},he.prototype.screenReaderLabelChanged=function(t){t?this.textarea.setAttribute("aria-label",t):this.textarea.removeAttribute("aria-label")},he.prototype.prepareSelection=function(){var t=this.cm,e=t.display,i=t.doc,r=ns(t);if(t.options.moveInputWithCursor){var n=rr(t,i.sel.primary().head,"div"),o=e.wrapper.getBoundingClientRect(),a=e.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(e.wrapper.clientHeight-10,n.top+a.top-o.top)),r.teLeft=Math.max(0,Math.min(e.wrapper.clientWidth-10,n.left+a.left-o.left))}return r},he.prototype.showSelection=function(t){var i=this.cm.display;Xt(i.cursorDiv,t.cursors),Xt(i.selectionDiv,t.selection),null!=t.teTop&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},he.prototype.reset=function(t){if(!this.contextMenuPending&&!this.composing){var e=this.cm;if(e.somethingSelected()){this.prevInput="";var i=e.getSelection();this.textarea.value=i,e.state.focused&&y(this.textarea),Nt&&Gt>=9&&(this.hasSelection=i)}else t||(this.prevInput=this.textarea.value="",Nt&&Gt>=9&&(this.hasSelection=null))}},he.prototype.getField=function(){return this.textarea},he.prototype.supportsTouch=function(){return!1},he.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!dt||P()!=this.textarea))try{this.textarea.focus()}catch(t){}},he.prototype.blur=function(){this.textarea.blur()},he.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},he.prototype.receivedFocus=function(){this.slowPoll()},he.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){t.poll(),t.cm.state.focused&&t.slowPoll()})},he.prototype.fastPoll=function(){var t=!1,e=this;e.pollingFast=!0,e.polling.set(20,function i(){e.poll()||t?(e.pollingFast=!1,e.slowPoll()):(t=!0,e.polling.set(60,i))})},he.prototype.poll=function(){var t=this,e=this.cm,i=this.textarea,r=this.prevInput;if(this.contextMenuPending||!e.state.focused||zr(i)&&!r&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var n=i.value;if(n==r&&!e.somethingSelected())return!1;if(Nt&&Gt>=9&&this.hasSelection===n||vt&&/[\uf700-\uf7ff]/.test(n))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var o=n.charCodeAt(0);if(8203==o&&!r&&(r="\u200b"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var a=0,u=Math.min(r.length,n.length);a<u&&r.charCodeAt(a)==n.charCodeAt(a);)++a;return Xe(e,function(){_o(e,n.slice(a),r.length-a,null,t.composing?"*compose":null),n.length>1e3||n.indexOf("\n")>-1?i.value=t.prevInput="":t.prevInput=n,t.composing&&(t.composing.range.clear(),t.composing.range=e.markText(t.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},he.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},he.prototype.onKeyPress=function(){Nt&&Gt>=9&&(this.hasSelection=null),this.fastPoll()},he.prototype.onContextMenu=function(t){var e=this,i=e.cm,r=i.display,n=e.textarea;e.contextMenuPending&&e.contextMenuPending();var o=jr(i,t),a=r.scroller.scrollTop;if(o&&!T){i.options.resetSelectionOnContextMenu&&-1==i.doc.sel.contains(o)&&ye(i,Ne)(i.doc,Fr(o),lt);var N,c=n.style.cssText,d=e.wrapper.style.cssText,C=e.wrapper.offsetParent.getBoundingClientRect();if(e.wrapper.style.cssText="position: static",n.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(t.clientY-C.top-5)+"px; left: "+(t.clientX-C.left-5)+"px;\n      z-index: 1000; background: "+(Nt?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",zt&&(N=window.scrollY),r.input.focus(),zt&&window.scrollTo(null,N),r.input.reset(),i.somethingSelected()||(n.value=e.prevInput=" "),e.contextMenuPending=I,r.selForContextMenu=i.doc.sel,clearTimeout(r.detectingSelectAll),Nt&&Gt>=9&&B(),qt){pr(t);var Y=function(){Ce(window,"mouseup",Y),setTimeout(I,20)};Mt(window,"mouseup",Y)}else setTimeout(I,50)}function B(){if(null!=n.selectionStart){var V=i.somethingSelected(),st="\u200b"+(V?n.value:"");n.value="\u21da",n.value=st,e.prevInput=V?"":"\u200b",n.selectionStart=1,n.selectionEnd=st.length,r.selForContextMenu=i.doc.sel}}function I(){if(e.contextMenuPending==I&&(e.contextMenuPending=!1,e.wrapper.style.cssText=d,n.style.cssText=c,Nt&&Gt<9&&r.scrollbars.setScrollTop(r.scroller.scrollTop=a),null!=n.selectionStart)){(!Nt||Nt&&Gt<9)&&B();var V=0,st=function(){r.selForContextMenu==i.doc.sel&&0==n.selectionStart&&n.selectionEnd>0&&"\u200b"==e.prevInput?ye(i,Is)(i):V++<10?r.detectingSelectAll=setTimeout(st,500):(r.selForContextMenu=null,r.input.reset())};r.detectingSelectAll=setTimeout(st,200)}}},he.prototype.readOnlyChanged=function(t){t||this.reset(),this.textarea.disabled="nocursor"==t,this.textarea.readOnly=!!t},he.prototype.setUneditable=function(){},he.prototype.needsContentAttribute=!1,function Ka(t){var e=t.optionHandlers;function i(r,n,o,a){t.defaults[r]=n,o&&(e[r]=a?function(u,c,d){d!=_i&&o(u,c,d)}:o)}t.defineOption=i,t.Init=_i,i("value","",function(r,n){return r.setValue(n)},!0),i("mode",null,function(r,n){r.doc.modeOption=n,mo(r)},!0),i("indentUnit",2,mo,!0),i("indentWithTabs",!1),i("smartIndent",!0),i("tabSize",4,function(r){$i(r),Xi(r),We(r)},!0),i("lineSeparator",null,function(r,n){if(r.doc.lineSep=n,n){var o=[],a=r.doc.first;r.doc.iter(function(c){for(var d=0;;){var C=c.text.indexOf(n,d);if(-1==C)break;d=C+n.length,o.push(q(a,C))}a++});for(var u=o.length-1;u>=0;u--)ki(r.doc,n,o[u],q(o[u].line,o[u].ch+n.length))}}),i("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(r,n,o){r.state.specialChars=new RegExp(n.source+(n.test("\t")?"":"|\t"),"g"),o!=_i&&r.refresh()}),i("specialCharPlaceholder",bl,function(r){return r.refresh()},!0),i("electricChars",!0),i("inputStyle",dt?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),i("spellcheck",!1,function(r,n){return r.getInputField().spellcheck=n},!0),i("autocorrect",!1,function(r,n){return r.getInputField().autocorrect=n},!0),i("autocapitalize",!1,function(r,n){return r.getInputField().autocapitalize=n},!0),i("rtlMoveVisually",!at),i("wholeLineUpdateBefore",!0),i("theme","default",function(r){al(r),qi(r)},!0),i("keyMap","default",function(r,n,o){var a=Pn(n),u=o!=_i&&Pn(o);u&&u.detach&&u.detach(r,a),a.attach&&a.attach(r,u||null)}),i("extraKeys",null),i("configureMouse",null),i("lineWrapping",!1,Qa,!0),i("gutters",[],function(r,n){r.display.gutterSpecs=go(n,r.options.lineNumbers),qi(r)},!0),i("fixedGutter",!0,function(r,n){r.display.gutters.style.left=n?io(r.display)+"px":"0",r.refresh()},!0),i("coverGutterNextToScrollbar",!1,function(r){return Ci(r)},!0),i("scrollbarStyle","native",function(r){hs(r),Ci(r),r.display.scrollbars.setScrollTop(r.doc.scrollTop),r.display.scrollbars.setScrollLeft(r.doc.scrollLeft)},!0),i("lineNumbers",!1,function(r,n){r.display.gutterSpecs=go(r.options.gutters,n),qi(r)},!0),i("firstLineNumber",1,qi,!0),i("lineNumberFormatter",function(r){return r},qi,!0),i("showCursorWhenSelecting",!1,Ki,!0),i("resetSelectionOnContextMenu",!0),i("lineWiseCopyCut",!0),i("pasteLinesPerSelection",!0),i("selectionsMayTouch",!1),i("readOnly",!1,function(r,n){"nocursor"==n&&(wi(r),r.display.input.blur()),r.display.input.readOnlyChanged(n)}),i("screenReaderLabel",null,function(r,n){r.display.input.screenReaderLabelChanged(n=""===n?null:n)}),i("disableInput",!1,function(r,n){n||r.display.input.reset()},!0),i("dragDrop",!0,Za),i("allowDropFileTypes",null),i("cursorBlinkRate",530),i("cursorScrollMargin",0),i("cursorHeight",1,Ki,!0),i("singleCursorHeightPerLine",!0,Ki,!0),i("workTime",100),i("workDelay",100),i("flattenSpans",!0,$i,!0),i("addModeClass",!1,$i,!0),i("pollInterval",100),i("undoDepth",200,function(r,n){return r.doc.history.undoDepth=n}),i("historyEventDelay",1250),i("viewportMargin",10,function(r){return r.refresh()},!0),i("maxHighlightLength",1e4,$i,!0),i("moveInputWithCursor",!0,function(r,n){n||r.display.input.resetPosition()}),i("tabindex",null,function(r,n){return r.display.input.getField().tabIndex=n||""}),i("autofocus",null),i("direction","ltr",function(r,n){return r.doc.setDirection(n)},!0),i("phrases",null)}(oe),function ja(t){var e=t.optionHandlers,i=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(r,n){var o=this.options,a=o[r];o[r]==n&&"mode"!=r||(o[r]=n,e.hasOwnProperty(r)&&ye(this,e[r])(this,n,a),ne(this,"optionChange",this,r))},getOption:function(r){return this.options[r]},getDoc:function(){return this.doc},addKeyMap:function(r,n){this.state.keyMaps[n?"push":"unshift"](Pn(r))},removeKeyMap:function(r){for(var n=this.state.keyMaps,o=0;o<n.length;++o)if(n[o]==r||n[o].name==r)return n.splice(o,1),!0},addOverlay:Ae(function(r,n){var o=r.token?r:t.getMode(this.options,r);if(o.startState)throw new Error("Overlays may not be stateful.");(function Zt(t,e,i){for(var r=0,n=i(e);r<t.length&&i(t[r])<=n;)r++;t.splice(r,0,e)})(this.state.overlays,{mode:o,modeSpec:r,opaque:n&&n.opaque,priority:n&&n.priority||0},function(a){return a.priority}),this.state.modeGen++,We(this)}),removeOverlay:Ae(function(r){for(var n=this.state.overlays,o=0;o<n.length;++o){var a=n[o].modeSpec;if(a==r||"string"==typeof r&&a.name==r)return n.splice(o,1),this.state.modeGen++,void We(this)}}),indentLine:Ae(function(r,n,o){"string"!=typeof n&&"number"!=typeof n&&(n=null==n?this.options.smartIndent?"smart":"prev":n?"add":"subtract"),Nr(this.doc,r)&&dn(this,r,n,o)}),indentSelection:Ae(function(r){for(var n=this.doc.sel.ranges,o=-1,a=0;a<n.length;a++){var u=n[a];if(u.empty())u.head.line>o&&(dn(this,u.head.line,r,!0),o=u.head.line,a==this.doc.sel.primIndex&&bi(this));else{var c=u.from(),d=u.to(),C=Math.max(o,c.line);o=Math.min(this.lastLine(),d.line-(d.ch?0:1))+1;for(var N=C;N<o;++N)dn(this,N,r);var B=this.doc.sel.ranges;0==c.ch&&n.length==B.length&&B[a].from().ch>0&&Co(this.doc,a,new te(c,B[a].to()),lt)}}}),getTokenAt:function(r,n){return nt(this,r,n)},getLineTokens:function(r,n){return nt(this,q(r),n,!0)},getTokenTypeAt:function(r){r=Dt(this.doc,r);var c,n=w(this,Lt(this.doc,r.line)),o=0,a=(n.length-1)/2,u=r.ch;if(0==u)c=n[2];else for(;;){var d=o+a>>1;if((d?n[2*d-1]:0)>=u)a=d;else{if(!(n[2*d+1]<u)){c=n[2*d+2];break}o=d+1}}var C=c?c.indexOf("overlay "):-1;return C<0?c:0==C?null:c.slice(0,C-1)},getModeAt:function(r){var n=this.doc.mode;return n.innerMode?t.innerMode(n,this.getTokenAt(r).state).mode:n},getHelper:function(r,n){return this.getHelpers(r,n)[0]},getHelpers:function(r,n){var o=[];if(!i.hasOwnProperty(n))return o;var a=i[n],u=this.getModeAt(r);if("string"==typeof u[n])a[u[n]]&&o.push(a[u[n]]);else if(u[n])for(var c=0;c<u[n].length;c++){var d=a[u[n][c]];d&&o.push(d)}else u.helperType&&a[u.helperType]?o.push(a[u.helperType]):a[u.name]&&o.push(a[u.name]);for(var C=0;C<a._global.length;C++){var N=a._global[C];N.pred(u,this)&&-1==X(o,N.val)&&o.push(N.val)}return o},getStateAfter:function(r,n){var o=this.doc;return m(this,(r=ve(o,null==r?o.first+o.size-1:r))+1,n).state},cursorCoords:function(r,n){var a=this.doc.sel.primary();return rr(this,null==r?a.head:"object"==typeof r?Dt(this.doc,r):r?a.from():a.to(),n||"page")},charCoords:function(r,n){return Sn(this,Dt(this.doc,r),n||"page")},coordsChar:function(r,n){return to(this,(r=qo(this,r,n||"page")).left,r.top)},lineAtHeight:function(r,n){return r=qo(this,{top:r,left:0},n||"page").top,or(this.doc,r+this.display.viewOffset)},heightAtLine:function(r,n,o){var u,a=!1;if("number"==typeof r){var c=this.doc.first+this.doc.size-1;r<this.doc.first?r=this.doc.first:r>c&&(r=c,a=!0),u=Lt(this.doc,r)}else u=r;return Cn(this,u,{top:0,left:0},n||"page",o||a).top+(a?this.doc.height-er(u):0)},defaultTextHeight:function(){return mi(this.display)},defaultCharWidth:function(){return xi(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(r,n,o,a,u){var c=this.display,d=(r=rr(this,Dt(this.doc,r))).bottom,C=r.left;if(n.style.position="absolute",n.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(n),c.sizer.appendChild(n),"over"==a)d=r.top;else if("above"==a||"near"==a){var N=Math.max(c.wrapper.clientHeight,this.doc.height),B=Math.max(c.sizer.clientWidth,c.lineSpace.clientWidth);("above"==a||r.bottom+n.offsetHeight>N)&&r.top>n.offsetHeight?d=r.top-n.offsetHeight:r.bottom+n.offsetHeight<=N&&(d=r.bottom),C+n.offsetWidth>B&&(C=B-n.offsetWidth)}n.style.top=d+"px",n.style.left=n.style.right="","right"==u?(C=c.sizer.clientWidth-n.offsetWidth,n.style.right="0px"):("left"==u?C=0:"middle"==u&&(C=(c.sizer.clientWidth-n.offsetWidth)/2),n.style.left=C+"px"),o&&function Zl(t,e){var i=uo(t,e);null!=i.scrollTop&&Qi(t,i.scrollTop),null!=i.scrollLeft&&qr(t,i.scrollLeft)}(this,{left:C,top:d,right:C+n.offsetWidth,bottom:d+n.offsetHeight})},triggerOnKeyDown:Ae(el),triggerOnKeyPress:Ae(il),triggerOnKeyUp:rl,triggerOnMouseDown:Ae(nl),execCommand:function(r){if(un.hasOwnProperty(r))return un[r].call(null,this)},triggerElectric:Ae(function(r){hl(this,r)}),findPosH:function(r,n,o,a){var u=1;n<0&&(u=-1,n=-n);for(var c=Dt(this.doc,r),d=0;d<n&&!(c=Ao(this.doc,c,u,o,a)).hitSide;++d);return c},moveH:Ae(function(r,n){var o=this;this.extendSelectionsBy(function(a){return o.display.shift||o.doc.extend||a.empty()?Ao(o.doc,a.head,r,n,o.options.rtlMoveVisually):r<0?a.from():a.to()},Ut)}),deleteH:Ae(function(r,n){var a=this.doc;this.doc.sel.somethingSelected()?a.replaceSelection("",null,"+delete"):Oi(this,function(u){var c=Ao(a,u.head,r,n,!1);return r<0?{from:c,to:u.head}:{from:u.head,to:c}})}),findPosV:function(r,n,o,a){var u=1,c=a;n<0&&(u=-1,n=-n);for(var d=Dt(this.doc,r),C=0;C<n;++C){var N=rr(this,d,"div");if(null==c?c=N.left:N.left=c,(d=vl(this,N,u,o)).hitSide)break}return d},moveV:Ae(function(r,n){var o=this,a=this.doc,u=[],c=!this.display.shift&&!a.extend&&a.sel.somethingSelected();if(a.extendSelectionsBy(function(C){if(c)return r<0?C.from():C.to();var N=rr(o,C.head,"div");null!=C.goalColumn&&(N.left=C.goalColumn),u.push(N.left);var B=vl(o,N,r,n);return"page"==n&&C==a.sel.primary()&&fo(o,Sn(o,B,"div").top-N.top),B},Ut),u.length)for(var d=0;d<a.sel.ranges.length;d++)a.sel.ranges[d].goalColumn=u[d]}),findWordAt:function(r){var o=Lt(this.doc,r.line).text,a=r.ch,u=r.ch;if(o){var c=this.getHelper(r,"wordChars");"before"!=r.sticky&&u!=o.length||!a?++u:--a;for(var d=o.charAt(a),C=se(d,c)?function(N){return se(N,c)}:/\s/.test(d)?function(N){return/\s/.test(N)}:function(N){return!/\s/.test(N)&&!se(N)};a>0&&C(o.charAt(a-1));)--a;for(;u<o.length&&C(o.charAt(u));)++u}return new te(q(r.line,a),q(r.line,u))},toggleOverwrite:function(r){null!=r&&r==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?U(this.display.cursorDiv,"CodeMirror-overwrite"):xt(this.display.cursorDiv,"CodeMirror-overwrite"),ne(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==P()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Ae(function(r,n){Zi(this,r,n)}),getScrollInfo:function(){var r=this.display.scroller;return{left:r.scrollLeft,top:r.scrollTop,height:r.scrollHeight-ur(this)-this.display.barHeight,width:r.scrollWidth-ur(this)-this.display.barWidth,clientHeight:jn(this),clientWidth:Qr(this)}},scrollIntoView:Ae(function(r,n){null==r?(r={from:this.doc.sel.primary().head,to:null},null==n&&(n=this.options.cursorScrollMargin)):"number"==typeof r?r={from:q(r,0),to:null}:null==r.from&&(r={from:r,to:null}),r.to||(r.to=r.from),r.margin=n||0,null!=r.from.line?function Ql(t,e){Mn(t),t.curOp.scrollToPos=e}(this,r):ls(this,r.from,r.to,r.margin)}),setSize:Ae(function(r,n){var o=this,a=function(c){return"number"==typeof c||/^\d+$/.test(String(c))?c+"px":c};null!=r&&(this.display.wrapper.style.width=a(r)),null!=n&&(this.display.wrapper.style.height=a(n)),this.options.lineWrapping&&Jo(this);var u=this.display.viewFrom;this.doc.iter(u,this.display.viewTo,function(c){if(c.widgets)for(var d=0;d<c.widgets.length;d++)if(c.widgets[d].noHScroll){Ar(o,u,"widget");break}++u}),this.curOp.forceUpdate=!0,ne(this,"refresh",this)}),operation:function(r){return Xe(this,r)},startOperation:function(){return ti(this)},endOperation:function(){return ei(this)},refresh:Ae(function(){var r=this.display.cachedTextHeight;We(this),this.curOp.forceUpdate=!0,Xi(this),Zi(this,this.doc.scrollLeft,this.doc.scrollTop),po(this.display),(null==r||Math.abs(r-mi(this.display))>.5||this.options.lineWrapping)&&no(this),ne(this,"refresh",this)}),swapDoc:Ae(function(r){var n=this.doc;return n.cm=null,this.state.selectingText&&this.state.selectingText(),bs(this,r),Xi(this),this.display.input.reset(),Zi(this,r.scrollLeft,r.scrollTop),this.curOp.forceScroll=!0,ge(this,"swapDoc",this,n),n}),phrase:function(r){var n=this.options.phrases;return n&&Object.prototype.hasOwnProperty.call(n,r)?n[r]:r},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},dr(t),t.registerHelper=function(r,n,o){i.hasOwnProperty(r)||(i[r]=t[r]={_global:[]}),i[r][n]=o},t.registerGlobalHelper=function(r,n,o,a){t.registerHelper(r,n,a),i[r]._global.push({pred:o,val:a})}}(oe);var ru="iter insert remove copy getEditor constructor".split(" ");for(var Un in Be.prototype)Be.prototype.hasOwnProperty(Un)&&X(ru,Un)<0&&(oe.prototype[Un]=function(t){return function(){return t.apply(this.doc,arguments)}}(Be.prototype[Un]));return dr(Be),oe.inputStyles={textarea:he,contenteditable:re},oe.defineMode=function(t){!oe.defaults.mode&&"null"!=t&&(oe.defaults.mode=t),Yn.apply(this,arguments)},oe.defineMIME=function Xn(t,e){kr[t]=e},oe.defineMode("null",function(){return{token:function(t){return t.skipToEnd()}}}),oe.defineMIME("text/plain","null"),oe.defineExtension=function(t,e){oe.prototype[t]=e},oe.defineDocExtension=function(t,e){Be.prototype[t]=e},oe.fromTextArea=function tu(t,e){if((e=e?D(e):{}).value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus){var i=P();e.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}function r(){t.value=u.getValue()}var n;if(t.form&&(Mt(t.form,"submit",r),!e.leaveSubmitMethodAlone)){var o=t.form;n=o.submit;try{var a=o.submit=function(){r(),o.submit=n,o.submit(),o.submit=a}}catch(c){}}e.finishInit=function(c){c.save=r,c.getTextArea=function(){return t},c.toTextArea=function(){c.toTextArea=isNaN,r(),t.parentNode.removeChild(c.getWrapperElement()),t.style.display="",t.form&&(Ce(t.form,"submit",r),!e.leaveSubmitMethodAlone&&"function"==typeof t.form.submit&&(t.form.submit=n))}},t.style.display="none";var u=oe(function(c){return t.parentNode.insertBefore(c,t.nextSibling)},e);return u},function eu(t){t.off=Ce,t.on=Mt,t.wheelEventPixels=aa,t.Doc=Be,t.splitLines=ai,t.countColumn=H,t.findColumn=_t,t.isWordChar=Re,t.Pass=ot,t.signal=ne,t.Line=vi,t.changeEnd=Ir,t.scrollbarModel=fs,t.Pos=q,t.cmpPos=pt,t.modes=fi,t.mimeModes=kr,t.resolveMode=hi,t.getMode=Bi,t.modeExtensions=vr,t.extendMode=Kn,t.copyState=_e,t.startState=ci,t.innerMode=Ur,t.commands=un,t.keyMap=Cr,t.keyName=js,t.isModifierKey=Qs,t.lookupKey=Mi,t.normalizeKeyMap=_a,t.StringStream=At,t.SharedTextMarker=sn,t.TextMarker=Br,t.LineWidget=on,t.e_preventDefault=Se,t.e_stopPropagation=Ii,t.e_stop=pr,t.addClass=U,t.contains=W,t.rmClass=xt,t.keyNames=Hr}(oe),oe.version="5.65.3",oe}),function(k){"object"==typeof exports&&"object"==typeof module?k(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],k):k(CodeMirror)}(function(k){"use strict";function b(g,T){if(!g.hasOwnProperty(T))throw new Error("Undefined state "+T+" in simple mode")}function Ct(g,T){if(!g)return/(?:)/;var _="";return g instanceof RegExp?(g.ignoreCase&&(_="i"),g.unicode&&(_+="u"),g=g.source):g=String(g),new RegExp((!1===T?"":"^")+"(?:"+g+")",_)}function Vt(g,T){(g.next||g.push)&&b(T,g.next||g.push),this.regex=Ct(g.regex),this.token=function Et(g){if(!g)return null;if(g.apply)return g;if("string"==typeof g)return g.replace(/\./g," ");for(var T=[],_=0;_<g.length;_++)T.push(g[_]&&g[_].replace(/\./g," "));return T}(g.token),this.data=g}function Jt(g,T){return function(_,A){if(A.pending){var Z=A.pending.shift();return 0==A.pending.length&&(A.pending=null),_.pos+=Z.text.length,Z.token}if(A.local){if(A.local.end&&_.match(A.local.end)){var $=A.local.endToken||null;return A.local=A.localState=null,$}var R;return $=A.local.mode.token(_,A.localState),A.local.endScan&&(R=A.local.endScan.exec(_.current()))&&(_.pos=_.start+R.index),$}for(var dt=g[A.state],vt=0;vt<dt.length;vt++){var mt=dt[vt],at=(!mt.data.sol||_.sol())&&_.match(mt.regex);if(at){mt.data.next?A.state=mt.data.next:mt.data.push?((A.stack||(A.stack=[])).push(A.state),A.state=mt.data.push):mt.data.pop&&A.stack&&A.stack.length&&(A.state=A.stack.pop()),mt.data.mode&&Gt(T,A,mt.data.mode,mt.token),mt.data.indent&&A.indent.push(_.indentation()+T.indentUnit),mt.data.dedent&&A.indent.pop();var ft=mt.token;if(ft&&ft.apply&&(ft=ft(at)),at.length>2&&mt.token&&"string"!=typeof mt.token){for(var It=2;It<at.length;It++)at[It]&&(A.pending||(A.pending=[])).push({text:at[It],token:mt.token[It-1]});return _.backUp(at[0].length-(at[1]?at[1].length:0)),ft[0]}return ft&&ft.join?ft[0]:ft}}return _.next(),null}}function Nt(g,T){if(g===T)return!0;if(!g||"object"!=typeof g||!T||"object"!=typeof T)return!1;var _=0;for(var A in g)if(g.hasOwnProperty(A)){if(!T.hasOwnProperty(A)||!Nt(g[A],T[A]))return!1;_++}for(var A in T)T.hasOwnProperty(A)&&_--;return 0==_}function Gt(g,T,_,A){var Z;if(_.persistent)for(var $=T.persistentStates;$&&!Z;$=$.next)(_.spec?Nt(_.spec,$.spec):_.mode==$.mode)&&(Z=$);var R=Z?Z.mode:_.mode||k.getMode(g,_.spec),dt=Z?Z.state:k.startState(R);_.persistent&&!Z&&(T.persistentStates={mode:R,spec:_.spec,state:dt,next:T.persistentStates}),T.localState=dt,T.local={mode:R,end:_.end&&Ct(_.end),endScan:_.end&&!1!==_.forceEnd&&Ct(_.end,!1),endToken:A&&A.join?A[A.length-1]:A}}function p(g,T){return function(_,A,Z){if(_.local&&_.local.mode.indent)return _.local.mode.indent(_.localState,A,Z);if(null==_.indent||_.local||T.dontIndentStates&&function zt(g,T){for(var _=0;_<T.length;_++)if(T[_]===g)return!0}(_.state,T.dontIndentStates)>-1)return k.Pass;var $=_.indent.length-1,R=g[_.state];t:for(;;){for(var dt=0;dt<R.length;dt++){var vt=R[dt];if(vt.data.dedent&&!1!==vt.data.dedentIfLineStart){var mt=vt.regex.exec(A);if(mt&&mt[0]){$--,(vt.next||vt.push)&&(R=g[vt.next||vt.push]),A=A.slice(mt[0].length);continue t}}}break}return $<0?0:_.indent[$]}}k.defineSimpleMode=function(g,T){k.defineMode(g,function(_){return k.simpleMode(_,T)})},k.simpleMode=function(g,T){b(T,"start");var _={},A=T.meta||{},Z=!1;for(var $ in T)if($!=A&&T.hasOwnProperty($))for(var R=_[$]=[],dt=T[$],vt=0;vt<dt.length;vt++){var mt=dt[vt];R.push(new Vt(mt,T)),(mt.indent||mt.dedent)&&(Z=!0)}var at={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:Z?[]:null}},copyState:function(It){var qt={state:It.state,pending:It.pending,local:It.local,localState:null,indent:It.indent&&It.indent.slice(0)};It.localState&&(qt.localState=k.copyState(It.local.mode,It.localState)),It.stack&&(qt.stack=It.stack.slice(0));for(var Wt=It.persistentStates;Wt;Wt=Wt.next)qt.persistentStates={mode:Wt.mode,spec:Wt.spec,state:Wt.state==It.localState?qt.localState:k.copyState(Wt.mode,Wt.state),next:qt.persistentStates};return qt},token:Jt(_,g),innerMode:function(It){return It.local&&{mode:It.local.mode,state:It.localState}},indent:p(_,A)};if(A)for(var ft in A)A.hasOwnProperty(ft)&&(at[ft]=A[ft]);return at}});